!function(l,y){for(var v in y)l[v]=y[v]}(this,function(l){var y={};function n(v){if(y[v])return y[v].exports;var m=y[v]={i:v,l:!1,exports:{}};return l[v].call(m.exports,m,m.exports,n),m.l=!0,m.exports}return n.m=l,n.c=y,n.d=function(l,y,v){n.o(l,y)||Object.defineProperty(l,y,{enumerable:!0,get:v})},n.r=function(l){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(l,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(l,"__esModule",{value:!0})},n.t=function(l,y){if(1&y&&(l=n(l)),8&y)return l;if(4&y&&"object"==typeof l&&l&&l.__esModule)return l;var v=Object.create(null);if(n.r(v),Object.defineProperty(v,"default",{enumerable:!0,value:l}),2&y&&"string"!=typeof l)for(var m in l)n.d(v,m,function(y){return l[y]}.bind(null,m));return v},n.n=function(l){var y=l&&l.__esModule?function(){return l.default}:function(){return l};return n.d(y,"a",y),y},n.o=function(l,y){return Object.prototype.hasOwnProperty.call(l,y)},n.p="",n(n.s=31)}([function(l,y,v){"use strict";var m=this&&this.__assign||function(){return(m=Object.assign||function(l){for(var y,v=1,m=arguments.length;v<m;v++)for(var g in y=arguments[v])Object.prototype.hasOwnProperty.call(y,g)&&(l[g]=y[g]);return l}).apply(this,arguments)},g=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C},b=this&&this.__read||function(l,y){var v="function"==typeof Symbol&&l[Symbol.iterator];if(!v)return l;var m,g,b=v.call(l),C=[];try{for(;(void 0===y||y-- >0)&&!(m=b.next()).done;)C.push(m.value)}catch(l){g={error:l}}finally{try{m&&!m.done&&(v=b.return)&&v.call(b)}finally{if(g)throw g.error}}return C},C=this&&this.__spread||function(){for(var l=[],y=0;y<arguments.length;y++)l=l.concat(b(arguments[y]));return l};Object.defineProperty(y,"__esModule",{value:!0}),y.isDisposableComponent=y.ObservableComponent=y.getComponentId=y.getComponentClassId=y.getComponentName=y.DisposableComponent=y.Component=y.DisposableComponentUpdated=y.DisposableComponentRemoved=y.DisposableComponentCreated=void 0;var w=v(1),O=v(8),x=v(20),A=g([O.EventConstructor()],(function(l,y,v){this.componentId=l,this.componentName=y,this.classId=v}));y.DisposableComponentCreated=A;var S=g([O.EventConstructor()],(function(l){this.componentId=l}));y.DisposableComponentRemoved=S;var E=g([O.EventConstructor()],(function(l,y){this.componentId=l,this.component=y}));function d(l,y){return function(v){if(v.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+v.originalClassName+" with: "+l);if("number"!=typeof y||isNaN(y))throw new Error("classId: "+y+" is an invalid integer");var m=v,r=function(){if(!d.engine)throw new Error("You need to set a DisposableComponent.engine before creating disposable components");var v=Array.prototype.slice.call(arguments),g=new(m.bind.apply(m,C([void 0],v))),b=w.newId("C");return Object.defineProperty(g,"__name__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:l}),Object.defineProperty(g,"__component__id_",{enumerable:!1,writable:!1,configurable:!1,value:b}),void 0!==y&&Object.defineProperty(g,"__classId__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:y}),d.engine&&d.engine.registerComponent(g),g};return void 0!==y&&(r.__classId__symbol_=y),r.__name__symbol_=l,r.isComponent=!0,r.isDisposableComponent=!0,r.originalClassName=l,(r.prototype=v.prototype).constructor=v,r}}function f(l){if(!l)throw new TypeError(l+" is not a component.");if(l.__component__id_)return l.__component__id_;throw new TypeError(l+" is not a registered disposable component.")}y.DisposableComponentUpdated=E,y.Component=function(l,y){return function(v){if(v.isComponent)throw new TypeError("You cannot extend a component. Trying to extend "+v.originalClassName+" with: "+l);var m=v,r=function(){var v=Array.prototype.slice.call(arguments),g=new(m.bind.apply(m,C([void 0],v)));return Object.defineProperty(g,"__name__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:l}),void 0!==y&&Object.defineProperty(g,"__classId__symbol_",{enumerable:!1,writable:!1,configurable:!1,value:y}),g};return void 0!==y&&(r.__classId__symbol_=y),r.__name__symbol_=l,r.isComponent=!0,r.originalClassName=l,(r.prototype=v.prototype).constructor=v,r}},y.DisposableComponent=d,function(l){l.engine=null}(d=y.DisposableComponent||(y.DisposableComponent={})),y.getComponentName=function(l){if(!l)throw new TypeError(l+" is not a component.");if(l.__name__symbol_)return l.__name__symbol_;throw new TypeError(l+" is not a registered component.")},y.getComponentClassId=function(l){if(!l)throw new TypeError(l+" is not a component.");if(l.__classId__symbol_)return l.__classId__symbol_;if(!l.__name__symbol_)throw new TypeError(l+" is not a registered component.");return null},y.getComponentId=f;var T=function(){function t(){this.dirty=!1,this.data={},this.subscriptions=[]}return t.component=function(l,y){if(delete l[y]){var v=y+"_"+Math.random();l[v]=void 0,Object.defineProperty(l,v,m(m({},Object.getOwnPropertyDescriptor(l,v)),{enumerable:!1})),Object.defineProperty(l,y.toString(),{get:function(){return this[v]},set:function(l){var m=this[v];if(this.data[y]=l?f(l):null,this[v]=l,l!==m){this.dirty=!0;for(var g=0;g<this.subscriptions.length;g++)this.subscriptions[g](y,l,m)}},enumerable:!0})}},t.field=function(l,y){delete l[y]&&Object.defineProperty(l,y.toString(),{get:function(){return this.data[y]},set:function(l){var v=this.data[y];if(this.data[y]=l,l!==v){this.dirty=!0;for(var m=0;m<this.subscriptions.length;m++)this.subscriptions[m](y,l,v)}},enumerable:!0})},t.uiValue=function(l,y){delete l[y]&&Object.defineProperty(l,y.toString(),{get:function(){return this.data[y].toString()},set:function(l){var v=this.data[y],m=new x.UIValue(l);if(this.data[y]=m,m!==v){this.dirty=!0;for(var g=0;g<this.subscriptions.length;g++)this.subscriptions[g](y,m,v)}},enumerable:!0})},t.readonly=function(l,y){delete l[y]&&Object.defineProperty(l,y.toString(),{get:function(){if(y in this.data==0)throw new Error("The field "+y+" is uninitialized");return this.data[y]},set:function(l){if(y in this.data)throw new Error("The field "+y+" is readonly");this.data[y]=l,this.dirty=!0},enumerable:!0,configurable:!1})},t.prototype.onChange=function(l){return this.subscriptions.push(l),this},t.prototype.toJSON=function(){return this.data},t}();y.ObservableComponent=T,y.isDisposableComponent=function(l){return"__component__id_"in l}},function(l,y,v){"use strict";var m=this&&this.__read||function(l,y){var v="function"==typeof Symbol&&l[Symbol.iterator];if(!v)return l;var m,g,b=v.call(l),C=[];try{for(;(void 0===y||y-- >0)&&!(m=b.next()).done;)C.push(m.value)}catch(l){g={error:l}}finally{try{m&&!m.done&&(v=b.return)&&v.call(b)}finally{if(g)throw g.error}}return C},g=this&&this.__spread||function(){for(var l=[],y=0;y<arguments.length;y++)l=l.concat(m(arguments[y]));return l};Object.defineProperty(y,"__esModule",{value:!0}),y.openNFTDialog=y.openExternalURL=y.buildArray=y.uuid=y.newId=y.error=y.log=void 0;var b=0;y.log=function(){for(var l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];"undefined"!=typeof dcl?dcl.log.apply(dcl,g(l)):console.log.apply(console,g(["DEBUG:"],l))},y.error=function(l,y){"undefined"!=typeof dcl?dcl.error(l,y):console.error("ERROR:",l,y)},y.newId=function(l){if(b++,0===l.length)throw new Error("newId(type: string): type cannot be empty");return l+b.toString(36)},y.uuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(l){var y=16*Math.random()|0;return("x"===l?y:3&y|8).toString(16)}))},y.buildArray=function(l,y){for(var v=[],m=0;m<l;++m)v.push(y());return v},y.openExternalURL=function(l){"undefined"!=typeof dcl?dcl.openExternalUrl(l):console.error("ERROR: openExternalURL dcl is undefined")},y.openNFTDialog=function(l,y){if(void 0===y&&(y=null),"undefined"!=typeof dcl){var v=l.match(/ethereum:\/\/(.+)\/(.+)/);if(!v||v.length<3)return;dcl.openNFTDialog(v[1],v[2],y)}else console.error("ERROR: openNFTDialog dcl is undefined")}},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.RAD2DEG=y.DEG2RAD=y.Epsilon=y.ToLinearSpace=y.ToGammaSpace=y.Space=y.Orientation=void 0,function(l){l[l.CW=0]="CW",l[l.CCW=1]="CCW"}(y.Orientation||(y.Orientation={})),function(l){l[l.LOCAL=0]="LOCAL",l[l.WORLD=1]="WORLD",l[l.BONE=2]="BONE"}(y.Space||(y.Space={})),y.ToGammaSpace=1/2.2,y.ToLinearSpace=2.2,y.Epsilon=1e-6,y.DEG2RAD=Math.PI/180,y.RAD2DEG=360/(2*Math.PI)},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Vector3=void 0;var m=v(9),g=v(2),b=v(12),C=v(4),w=function(){function t(l,y,v){void 0===l&&(l=0),void 0===y&&(y=0),void 0===v&&(v=0),this.x=l,this.y=y,this.z=v}return Object.defineProperty(t.prototype,"isNonUniform",{get:function(){var l=Math.abs(this.x),y=Math.abs(this.y);if(l!==y)return!0;var v=Math.abs(this.z);return l!==v||y!==v},enumerable:!1,configurable:!0}),t.Add=function(l,y){return new t(l.x,l.y,l.z).addInPlace(y)},t.GetClipFactor=function(l,y,v,m){var g=t.Dot(l,v)-m;return g/(g-(t.Dot(y,v)-m))},t.GetAngleBetweenVectors=function(l,y,v){var g=l.normalizeToRef(m.MathTmp.Vector3[1]),b=y.normalizeToRef(m.MathTmp.Vector3[2]),C=t.Dot(g,b),w=m.MathTmp.Vector3[3];return t.CrossToRef(g,b,w),t.Dot(w,v)>0?Math.acos(C):-Math.acos(C)},t.FromArray=function(l,y){return void 0===y&&(y=0),new t(l[y],l[y+1],l[y+2])},t.FromFloatArray=function(l,y){return t.FromArray(l,y)},t.FromArrayToRef=function(l,y,v){v.x=l[y],v.y=l[y+1],v.z=l[y+2]},t.FromFloatArrayToRef=function(l,y,v){return t.FromArrayToRef(l,y,v)},t.FromFloatsToRef=function(l,y,v,m){m.copyFromFloats(l,y,v)},t.Zero=function(){return new t(0,0,0)},t.One=function(){return new t(1,1,1)},t.Up=function(){return new t(0,1,0)},t.Down=function(){return new t(0,-1,0)},t.Forward=function(){return new t(0,0,1)},t.Backward=function(){return new t(0,0,-1)},t.Right=function(){return new t(1,0,0)},t.Left=function(){return new t(-1,0,0)},t.TransformCoordinates=function(l,y){var v=t.Zero();return t.TransformCoordinatesToRef(l,y,v),v},t.TransformCoordinatesToRef=function(l,y,v){return t.TransformCoordinatesFromFloatsToRef(l.x,l.y,l.z,y,v)},t.TransformCoordinatesFromFloatsToRef=function(l,y,v,m,g){var b=m.m,C=l*b[0]+y*b[4]+v*b[8]+b[12],w=l*b[1]+y*b[5]+v*b[9]+b[13],O=l*b[2]+y*b[6]+v*b[10]+b[14],x=1/(l*b[3]+y*b[7]+v*b[11]+b[15]);g.x=C*x,g.y=w*x,g.z=O*x},t.TransformNormal=function(l,y){var v=t.Zero();return t.TransformNormalToRef(l,y,v),v},t.TransformNormalToRef=function(l,y,v){this.TransformNormalFromFloatsToRef(l.x,l.y,l.z,y,v)},t.TransformNormalFromFloatsToRef=function(l,y,v,m,g){var b=m.m;g.x=l*b[0]+y*b[4]+v*b[8],g.y=l*b[1]+y*b[5]+v*b[9],g.z=l*b[2]+y*b[6]+v*b[10]},t.CatmullRom=function(l,y,v,m,g){var b=g*g,C=g*b;return new t(.5*(2*y.x+(-l.x+v.x)*g+(2*l.x-5*y.x+4*v.x-m.x)*b+(-l.x+3*y.x-3*v.x+m.x)*C),.5*(2*y.y+(-l.y+v.y)*g+(2*l.y-5*y.y+4*v.y-m.y)*b+(-l.y+3*y.y-3*v.y+m.y)*C),.5*(2*y.z+(-l.z+v.z)*g+(2*l.z-5*y.z+4*v.z-m.z)*b+(-l.z+3*y.z-3*v.z+m.z)*C))},t.Clamp=function(l,y,v){var m=new t;return t.ClampToRef(l,y,v,m),m},t.ClampToRef=function(l,y,v,m){var g=l.x;g=(g=g>v.x?v.x:g)<y.x?y.x:g;var b=l.y;b=(b=b>v.y?v.y:b)<y.y?y.y:b;var C=l.z;C=(C=C>v.z?v.z:C)<y.z?y.z:C,m.copyFromFloats(g,b,C)},t.Hermite=function(l,y,v,m,g){var b=g*g,C=g*b,w=2*C-3*b+1,O=-2*C+3*b,x=C-2*b+g,A=C-b;return new t(l.x*w+v.x*O+y.x*x+m.x*A,l.y*w+v.y*O+y.y*x+m.y*A,l.z*w+v.z*O+y.z*x+m.z*A)},t.Lerp=function(l,y,v){var m=new t(0,0,0);return t.LerpToRef(l,y,v,m),m},t.LerpToRef=function(l,y,v,m){m.x=l.x+(y.x-l.x)*v,m.y=l.y+(y.y-l.y)*v,m.z=l.z+(y.z-l.z)*v},t.Dot=function(l,y){return l.x*y.x+l.y*y.y+l.z*y.z},t.Cross=function(l,y){var v=t.Zero();return t.CrossToRef(l,y,v),v},t.CrossToRef=function(l,y,v){var m=l.y*y.z-l.z*y.y,g=l.z*y.x-l.x*y.z,b=l.x*y.y-l.y*y.x;v.copyFromFloats(m,g,b)},t.Normalize=function(l){var y=t.Zero();return t.NormalizeToRef(l,y),y},t.NormalizeToRef=function(l,y){l.normalizeToRef(y)},t.Minimize=function(l,y){var v=new t(l.x,l.y,l.z);return v.minimizeInPlace(y),v},t.Maximize=function(l,y){var v=new t(l.x,l.y,l.z);return v.maximizeInPlace(y),v},t.Distance=function(l,y){return Math.sqrt(t.DistanceSquared(l,y))},t.DistanceSquared=function(l,y){var v=l.x-y.x,m=l.y-y.y,g=l.z-y.z;return v*v+m*m+g*g},t.Center=function(l,y){var v=t.Add(l,y);return v.scaleInPlace(.5),v},t.RotationFromAxis=function(l,y,v){var m=t.Zero();return t.RotationFromAxisToRef(l,y,v,m),m},t.RotationFromAxisToRef=function(l,y,v,g){var C=m.MathTmp.Quaternion[0];b.Quaternion.RotationQuaternionFromAxisToRef(l,y,v,C),g.copyFrom(C.eulerAngles)},t.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"},t.prototype.getClassName=function(){return"Vector3"},t.prototype.getHashCode=function(){var l=this.x||0;return 397*(l=397*l^(this.y||0))^(this.z||0)},t.prototype.asArray=function(){var l=[];return this.toArray(l,0),l},t.prototype.toArray=function(l,y){return void 0===y&&(y=0),l[y]=this.x,l[y+1]=this.y,l[y+2]=this.z,this},t.prototype.toQuaternion=function(){return b.Quaternion.Identity.setEuler(this.y,this.x,this.z)},t.prototype.addInPlace=function(l){return this.addInPlaceFromFloats(l.x,l.y,l.z)},t.prototype.addInPlaceFromFloats=function(l,y,v){return this.x+=l,this.y+=y,this.z+=v,this},t.prototype.add=function(l){return new t(this.x+l.x,this.y+l.y,this.z+l.z)},t.prototype.addToRef=function(l,y){return y.copyFromFloats(this.x+l.x,this.y+l.y,this.z+l.z)},t.prototype.subtractInPlace=function(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this},t.prototype.subtract=function(l){return new t(this.x-l.x,this.y-l.y,this.z-l.z)},t.prototype.subtractToRef=function(l,y){return this.subtractFromFloatsToRef(l.x,l.y,l.z,y)},t.prototype.subtractFromFloats=function(l,y,v){return new t(this.x-l,this.y-y,this.z-v)},t.prototype.subtractFromFloatsToRef=function(l,y,v,m){return m.copyFromFloats(this.x-l,this.y-y,this.z-v)},t.prototype.applyMatrix4=function(l){this.applyMatrix4ToRef(l,this)},t.prototype.applyMatrix4ToRef=function(l,y){var v=this.x,m=this.y,g=this.z,b=l.m,C=1/(b[3]*v+b[7]*m+b[11]*g+b[15]);return y.x=(b[0]*v+b[4]*m+b[8]*g+b[12])*C,y.y=(b[1]*v+b[5]*m+b[9]*g+b[13])*C,y.z=(b[2]*v+b[6]*m+b[10]*g+b[14])*C,y},t.prototype.rotate=function(l){return this.rotateToRef(l,this)},t.prototype.rotateToRef=function(l,y){var v=this.x,m=this.y,g=this.z,b=l.x,C=l.y,w=l.z,O=l.w,x=O*v+C*g-w*m,A=O*m+w*v-b*g,S=O*g+b*m-C*v,E=-b*v-C*m-w*g;return y.x=x*O+E*-b+A*-w-S*-C,y.y=A*O+E*-C+S*-b-x*-w,y.z=S*O+E*-w+x*-C-A*-b,y},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.scaleInPlace=function(l){return this.x*=l,this.y*=l,this.z*=l,this},t.prototype.scale=function(l){return new t(this.x*l,this.y*l,this.z*l)},t.prototype.scaleToRef=function(l,y){return y.copyFromFloats(this.x*l,this.y*l,this.z*l)},t.prototype.scaleAndAddToRef=function(l,y){return y.addInPlaceFromFloats(this.x*l,this.y*l,this.z*l)},t.prototype.equals=function(l){return l&&this.x===l.x&&this.y===l.y&&this.z===l.z},t.prototype.equalsWithEpsilon=function(l,y){return void 0===y&&(y=g.Epsilon),l&&C.Scalar.WithinEpsilon(this.x,l.x,y)&&C.Scalar.WithinEpsilon(this.y,l.y,y)&&C.Scalar.WithinEpsilon(this.z,l.z,y)},t.prototype.equalsToFloats=function(l,y,v){return this.x===l&&this.y===y&&this.z===v},t.prototype.multiplyInPlace=function(l){return this.x*=l.x,this.y*=l.y,this.z*=l.z,this},t.prototype.multiply=function(l){return this.multiplyByFloats(l.x,l.y,l.z)},t.prototype.multiplyToRef=function(l,y){return y.copyFromFloats(this.x*l.x,this.y*l.y,this.z*l.z)},t.prototype.multiplyByFloats=function(l,y,v){return new t(this.x*l,this.y*y,this.z*v)},t.prototype.divide=function(l){return new t(this.x/l.x,this.y/l.y,this.z/l.z)},t.prototype.divideToRef=function(l,y){return y.copyFromFloats(this.x/l.x,this.y/l.y,this.z/l.z)},t.prototype.divideInPlace=function(l){return this.divideToRef(l,this)},t.prototype.minimizeInPlace=function(l){return this.minimizeInPlaceFromFloats(l.x,l.y,l.z)},t.prototype.maximizeInPlace=function(l){return this.maximizeInPlaceFromFloats(l.x,l.y,l.z)},t.prototype.minimizeInPlaceFromFloats=function(l,y,v){return l<this.x&&(this.x=l),y<this.y&&(this.y=y),v<this.z&&(this.z=v),this},t.prototype.maximizeInPlaceFromFloats=function(l,y,v){return l>this.x&&(this.x=l),y>this.y&&(this.y=y),v>this.z&&(this.z=v),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.normalize=function(){return this.normalizeFromLength(this.length())},t.prototype.normalizeFromLength=function(l){return 0===l||1===l?this:this.scaleInPlace(1/l)},t.prototype.normalizeToNew=function(){var l=new t(0,0,0);return this.normalizeToRef(l),l},t.prototype.normalizeToRef=function(l){var y=this.length();return 0===y||1===y?l.copyFromFloats(this.x,this.y,this.z):this.scaleToRef(1/y,l)},t.prototype.clone=function(){return new t(this.x,this.y,this.z)},t.prototype.copyFrom=function(l){return this.copyFromFloats(l.x,l.y,l.z)},t.prototype.copyFromFloats=function(l,y,v){return this.x=l,this.y=y,this.z=v,this},t.prototype.set=function(l,y,v){return this.copyFromFloats(l,y,v)},t.prototype.setAll=function(l){return this.x=this.y=this.z=l,this},t}();y.Vector3=w},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Scalar=void 0;var m=function(){function t(){}return t.WithinEpsilon=function(l,y,v){void 0===v&&(v=1401298e-51);var m=l-y;return-v<=m&&m<=v},t.ToHex=function(l){var y=l.toString(16);return l<=15?("0"+y).toUpperCase():y.toUpperCase()},t.Sign=function(l){var y=+l;return 0===y||isNaN(y)?y:y>0?1:-1},t.Clamp=function(l,y,v){return void 0===y&&(y=0),void 0===v&&(v=1),Math.min(v,Math.max(y,l))},t.Log2=function(l){return Math.log(l)*Math.LOG2E},t.Repeat=function(l,y){return l-Math.floor(l/y)*y},t.Normalize=function(l,y,v){return(l-y)/(v-y)},t.Denormalize=function(l,y,v){return l*(v-y)+y},t.DeltaAngle=function(l,y){var v=t.Repeat(y-l,360);return v>180&&(v-=360),v},t.PingPong=function(l,y){var v=t.Repeat(l,2*y);return y-Math.abs(v-y)},t.SmoothStep=function(l,y,v){var m=t.Clamp(v);return y*(m=-2*m*m*m+3*m*m)+l*(1-m)},t.MoveTowards=function(l,y,v){return Math.abs(y-l)<=v?y:l+t.Sign(y-l)*v},t.MoveTowardsAngle=function(l,y,v){var m=t.DeltaAngle(l,y);return-v<m&&m<v?y:t.MoveTowards(l,l+m,v)},t.Lerp=function(l,y,v){return l+(y-l)*v},t.LerpAngle=function(l,y,v){var m=t.Repeat(y-l,360);return m>180&&(m-=360),l+m*t.Clamp(v)},t.InverseLerp=function(l,y,v){return l!==y?t.Clamp((v-l)/(y-l)):0},t.Hermite=function(l,y,v,m,g){var b=g*g,C=g*b;return l*(2*C-3*b+1)+v*(-2*C+3*b)+y*(C-2*b+g)+m*(C-b)},t.RandomRange=function(l,y){return l===y?l:Math.random()*(y-l)+l},t.RangeToPercent=function(l,y,v){return(l-y)/(v-y)},t.PercentToRange=function(l,y,v){return(v-y)*l+y},t.NormalizeRadians=function(l){return l-t.TwoPi*Math.floor((l+Math.PI)/t.TwoPi)},t.TwoPi=2*Math.PI,t}();y.Scalar=m},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__assign||function(){return(b=Object.assign||function(l){for(var y,v=1,m=arguments.length;v<m;v++)for(var g in y=arguments[v])Object.prototype.hasOwnProperty.call(y,g)&&(l[g]=y[g]);return l}).apply(this,arguments)},C=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.VideoTexture=y.VideoClip=y.SmartItem=y.OnAnimationEnd=y.OnPointerLock=y.OnPointerUUIDEvent=y.OnUUIDEvent=y.BasicMaterial=y.Material=y.TransparencyMode=y.TextShape=y.Fonts=y.Font=y.OBJShape=y.Animator=y.Texture=y.NFTShape=y.PictureFrameStyle=y.GLTFShape=y.CylinderShape=y.ConeShape=y.PlaneShape=y.CircleShape=y.SphereShape=y.BoxShape=y.Shape=y.Billboard=y.Transform=y.AvatarModifierArea=y.AvatarModifiers=y.CLASS_ID=void 0;var w,O=v(0),x=v(6),A=v(28),S=v(1),E=v(18);!function(l){l[l.TRANSFORM=1]="TRANSFORM",l[l.UUID_CALLBACK=8]="UUID_CALLBACK",l[l.BOX_SHAPE=16]="BOX_SHAPE",l[l.SPHERE_SHAPE=17]="SPHERE_SHAPE",l[l.PLANE_SHAPE=18]="PLANE_SHAPE",l[l.CONE_SHAPE=19]="CONE_SHAPE",l[l.CYLINDER_SHAPE=20]="CYLINDER_SHAPE",l[l.TEXT_SHAPE=21]="TEXT_SHAPE",l[l.NFT_SHAPE=22]="NFT_SHAPE",l[l.UI_WORLD_SPACE_SHAPE=23]="UI_WORLD_SPACE_SHAPE",l[l.UI_SCREEN_SPACE_SHAPE=24]="UI_SCREEN_SPACE_SHAPE",l[l.UI_CONTAINER_RECT=25]="UI_CONTAINER_RECT",l[l.UI_CONTAINER_STACK=26]="UI_CONTAINER_STACK",l[l.UI_TEXT_SHAPE=27]="UI_TEXT_SHAPE",l[l.UI_INPUT_TEXT_SHAPE=28]="UI_INPUT_TEXT_SHAPE",l[l.UI_IMAGE_SHAPE=29]="UI_IMAGE_SHAPE",l[l.UI_SLIDER_SHAPE=30]="UI_SLIDER_SHAPE",l[l.CIRCLE_SHAPE=31]="CIRCLE_SHAPE",l[l.BILLBOARD=32]="BILLBOARD",l[l.ANIMATION=33]="ANIMATION",l[l.FONT=34]="FONT",l[l.UI_FULLSCREEN_SHAPE=40]="UI_FULLSCREEN_SHAPE",l[l.UI_BUTTON_SHAPE=41]="UI_BUTTON_SHAPE",l[l.GLTF_SHAPE=54]="GLTF_SHAPE",l[l.OBJ_SHAPE=55]="OBJ_SHAPE",l[l.AVATAR_SHAPE=56]="AVATAR_SHAPE",l[l.BASIC_MATERIAL=64]="BASIC_MATERIAL",l[l.PBR_MATERIAL=65]="PBR_MATERIAL",l[l.HIGHLIGHT_ENTITY=66]="HIGHLIGHT_ENTITY",l[l.SOUND=67]="SOUND",l[l.TEXTURE=68]="TEXTURE",l[l.VIDEO_CLIP=70]="VIDEO_CLIP",l[l.VIDEO_TEXTURE=71]="VIDEO_TEXTURE",l[l.AUDIO_CLIP=200]="AUDIO_CLIP",l[l.AUDIO_SOURCE=201]="AUDIO_SOURCE",l[l.AUDIO_STREAM=202]="AUDIO_STREAM",l[l.GIZMOS=203]="GIZMOS",l[l.SMART_ITEM=204]="SMART_ITEM",l[l.AVATAR_MODIFIER_AREA=205]="AVATAR_MODIFIER_AREA",l[l.NAME=300]="NAME",l[l.LOCKED_ON_EDIT=301]="LOCKED_ON_EDIT",l[l.VISIBLE_ON_EDIT=302]="VISIBLE_ON_EDIT"}(w=y.CLASS_ID||(y.CLASS_ID={})),function(l){l.HIDE_AVATARS="HIDE_AVATARS",l.DISABLE_PASSPORTS="DISABLE_PASSPORTS"}(y.AvatarModifiers||(y.AvatarModifiers={}));var T=function(l){function e(y){var v=l.call(this)||this;return v.area=y.area,v.modifiers=y.modifiers,v}return g(e,l),C([O.ObservableComponent.field],e.prototype,"area",void 0),C([O.ObservableComponent.field],e.prototype,"modifiers",void 0),C([O.Component("engine.avatarModifierArea",w.AVATAR_MODIFIER_AREA)],e)}(O.ObservableComponent);y.AvatarModifierArea=T;var R=function(l){function e(y){void 0===y&&(y={});var v=l.call(this)||this;return v.position=y.position||x.Vector3.Zero(),v.rotation=y.rotation||x.Quaternion.Identity,v.scale=y.scale||new x.Vector3(1,1,1),v}return g(e,l),Object.defineProperty(e.prototype,"eulerAngles",{get:function(){return this.rotation.eulerAngles},enumerable:!1,configurable:!0}),e.prototype.lookAt=function(l,y){void 0===y&&(y=x.MathTmp.staticUp);var v=new x.Matrix;return x.Matrix.LookAtLHToRef(this.position,l,y,v),v.invert(),x.Quaternion.FromRotationMatrixToRef(v,this.rotation),this},e.prototype.rotate=function(l,y){return this.rotation.multiplyInPlace(this.rotation.angleAxis(y,l)),this},e.prototype.translate=function(l){return this.position.addInPlace(l),this},C([O.ObservableComponent.field],e.prototype,"position",void 0),C([O.ObservableComponent.field],e.prototype,"rotation",void 0),C([O.ObservableComponent.field],e.prototype,"scale",void 0),C([O.Component("engine.transform",w.TRANSFORM)],e)}(O.ObservableComponent);y.Transform=R;var I=function(l){function e(y,v,m){void 0===y&&(y=!0),void 0===v&&(v=!0),void 0===m&&(m=!0);var g=l.call(this)||this;return g.x=!0,g.y=!0,g.z=!0,g.x=y,g.y=v,g.z=m,g}return g(e,l),C([O.ObservableComponent.field],e.prototype,"x",void 0),C([O.ObservableComponent.field],e.prototype,"y",void 0),C([O.ObservableComponent.field],e.prototype,"z",void 0),C([O.Component("engine.billboard",w.BILLBOARD)],e)}(O.ObservableComponent);y.Billboard=I;var P=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.withCollisions=!0,y.isPointerBlocker=!0,y.visible=!0,y}return g(e,l),C([O.ObservableComponent.field],e.prototype,"withCollisions",void 0),C([O.ObservableComponent.field],e.prototype,"isPointerBlocker",void 0),C([O.ObservableComponent.field],e.prototype,"visible",void 0),e}(O.ObservableComponent);y.Shape=P;var M=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}return g(e,l),C([O.ObservableComponent.field],e.prototype,"uvs",void 0),C([O.DisposableComponent("engine.shape",w.BOX_SHAPE)],e)}(P);y.BoxShape=M;var z=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}return g(e,l),C([O.DisposableComponent("engine.shape",w.SPHERE_SHAPE)],e)}(P);y.SphereShape=z;var D=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}return g(e,l),C([O.ObservableComponent.field],e.prototype,"segments",void 0),C([O.ObservableComponent.field],e.prototype,"arc",void 0),C([O.DisposableComponent("engine.shape",w.CIRCLE_SHAPE)],e)}(P);y.CircleShape=D;var F=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.width=1,y.height=1,y}return g(e,l),C([O.ObservableComponent.field],e.prototype,"width",void 0),C([O.ObservableComponent.field],e.prototype,"height",void 0),C([O.ObservableComponent.field],e.prototype,"uvs",void 0),C([O.DisposableComponent("engine.shape",w.PLANE_SHAPE)],e)}(P);y.PlaneShape=F;var N=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.radiusTop=0,y.radiusBottom=1,y.segmentsHeight=1,y.segmentsRadial=36,y.openEnded=!1,y.radius=null,y.arc=360,y}return g(e,l),C([O.ObservableComponent.field],e.prototype,"radiusTop",void 0),C([O.ObservableComponent.field],e.prototype,"radiusBottom",void 0),C([O.ObservableComponent.field],e.prototype,"segmentsHeight",void 0),C([O.ObservableComponent.field],e.prototype,"segmentsRadial",void 0),C([O.ObservableComponent.field],e.prototype,"openEnded",void 0),C([O.ObservableComponent.field],e.prototype,"radius",void 0),C([O.ObservableComponent.field],e.prototype,"arc",void 0),C([O.DisposableComponent("engine.shape",w.CONE_SHAPE)],e)}(P);y.ConeShape=N;var U=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.radiusTop=1,y.radiusBottom=1,y.segmentsHeight=1,y.segmentsRadial=36,y.openEnded=!1,y.radius=null,y.arc=360,y}return g(e,l),C([O.ObservableComponent.field],e.prototype,"radiusTop",void 0),C([O.ObservableComponent.field],e.prototype,"radiusBottom",void 0),C([O.ObservableComponent.field],e.prototype,"segmentsHeight",void 0),C([O.ObservableComponent.field],e.prototype,"segmentsRadial",void 0),C([O.ObservableComponent.field],e.prototype,"openEnded",void 0),C([O.ObservableComponent.field],e.prototype,"radius",void 0),C([O.ObservableComponent.field],e.prototype,"arc",void 0),C([O.DisposableComponent("engine.shape",w.CYLINDER_SHAPE)],e)}(P);y.CylinderShape=U;var $,L=function(l){function e(y){var v=l.call(this)||this;return v.src=y,v}return g(e,l),C([P.readonly],e.prototype,"src",void 0),C([O.DisposableComponent("engine.shape",w.GLTF_SHAPE)],e)}(P);y.GLTFShape=L,function(l){l[l.Classic=0]="Classic",l[l.Baroque_Ornament=1]="Baroque_Ornament",l[l.Diamond_Ornament=2]="Diamond_Ornament",l[l.Minimal_Wide=3]="Minimal_Wide",l[l.Minimal_Grey=4]="Minimal_Grey",l[l.Blocky=5]="Blocky",l[l.Gold_Edges=6]="Gold_Edges",l[l.Gold_Carved=7]="Gold_Carved",l[l.Gold_Wide=8]="Gold_Wide",l[l.Gold_Rounded=9]="Gold_Rounded",l[l.Metal_Medium=10]="Metal_Medium",l[l.Metal_Wide=11]="Metal_Wide",l[l.Metal_Slim=12]="Metal_Slim",l[l.Metal_Rounded=13]="Metal_Rounded",l[l.Pins=14]="Pins",l[l.Minimal_Black=15]="Minimal_Black",l[l.Minimal_White=16]="Minimal_White",l[l.Tape=17]="Tape",l[l.Wood_Slim=18]="Wood_Slim",l[l.Wood_Wide=19]="Wood_Wide",l[l.Wood_Twigs=20]="Wood_Twigs",l[l.Canvas=21]="Canvas",l[l.None=22]="None"}($=y.PictureFrameStyle||(y.PictureFrameStyle={}));var k=function(l){function e(y,v){void 0===v&&(v={});var m=l.call(this)||this;m.src=y;var g=new x.Color3(.6404918,.611472,.8584906),b=$.Classic;return v instanceof x.Color3?g=v:null!=v&&(v.color&&(g=v.color),v.style&&(b=v.style)),m.color=g,m.style=b,m}return g(e,l),C([P.readonly],e.prototype,"src",void 0),C([P.readonly],e.prototype,"style",void 0),C([O.ObservableComponent.field],e.prototype,"color",void 0),C([O.DisposableComponent("engine.shape",w.NFT_SHAPE)],e)}(P);y.NFTShape=k;var j=function(l){function e(y,v){var m=l.call(this)||this;if(m.src=y,v)for(var g in v)m[g]=v[g];return m}return g(e,l),C([O.ObservableComponent.readonly],e.prototype,"src",void 0),C([O.ObservableComponent.readonly],e.prototype,"samplingMode",void 0),C([O.ObservableComponent.readonly],e.prototype,"wrap",void 0),C([O.ObservableComponent.readonly],e.prototype,"hasAlpha",void 0),C([O.DisposableComponent("engine.texture",w.TEXTURE)],e)}(O.ObservableComponent);y.Texture=j;var V=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.states=[],y}return g(e,l),e.prototype.addClip=function(l){var y=this;return this.states.push(l),l.onChange((function(){y.dirty=!0})),l.owner=this,this},e.prototype.getClip=function(l){for(var y=0;y<this.states.length;y++){var v=this.states[y];if(v.clip===l)return v}var m=new A.AnimationState(l);return this.addClip(m),m},e.prototype.stop=function(l){if(l)l.playing=!1,l.shouldReset=!0;else for(var y=0;y<this.states.length;y++){var v=this.states[y];this.stop(v)}},e.prototype.play=function(l,y){void 0===y&&(y=!1);for(var v=0;v<this.states.length;v++){var m=this.states[v];m.layer===l.layer&&l!==m&&this.pause(m)}y&&(l.shouldReset=!0),l.playing=!0,l.dirty=!0,l.data.nonce=Math.random()},e.prototype.pause=function(l){if(l)l.playing=!1;else for(var y=0;y<this.states.length;y++){var v=this.states[y];this.pause(v)}},C([O.ObservableComponent.readonly],e.prototype,"states",void 0),C([O.Component("engine.animator",w.ANIMATION)],e)}(P);y.Animator=V;var H=function(l){function e(y){var v=l.call(this)||this;return v.src=y,v}return g(e,l),C([O.ObservableComponent.readonly],e.prototype,"src",void 0),C([O.DisposableComponent("engine.shape",w.OBJ_SHAPE)],e)}(P);y.OBJShape=H;var B=function(l){function e(y){void 0===y&&(y="");var v=l.call(this)||this;return v.src=y,v}return g(e,l),C([O.ObservableComponent.readonly],e.prototype,"src",void 0),C([O.DisposableComponent("engine.font",w.FONT)],e)}(O.ObservableComponent);y.Font=B,function(l){l.SanFrancisco="builtin:SF-UI-Text-Regular SDF",l.SanFrancisco_Heavy="builtin:SF-UI-Text-Heavy SDF",l.SanFrancisco_Semibold="builtin:SF-UI-Text-Semibold SDF",l.LiberationSans="builtin:LiberationSans SDF"}(y.Fonts||(y.Fonts={}));var q,W=function(l){function e(y){var v=l.call(this)||this;return v.outlineWidth=0,v.outlineColor=new x.Color3(1,1,1),v.color=new x.Color3(1,1,1),v.fontSize=10,v.fontWeight="normal",v.opacity=1,v.value="",v.lineSpacing="0px",v.lineCount=0,v.resizeToFit=!1,v.textWrapping=!1,v.shadowBlur=0,v.shadowOffsetX=0,v.shadowOffsetY=0,v.shadowColor=new x.Color3(1,1,1),v.zIndex=0,v.hTextAlign="center",v.vTextAlign="center",v.width=1,v.height=1,v.paddingTop=0,v.paddingRight=0,v.paddingBottom=0,v.paddingLeft=0,v.isPickable=!1,v.billboard=!1,v.visible=!0,y&&(v.value=y),v}return g(e,l),C([O.ObservableComponent.field],e.prototype,"outlineWidth",void 0),C([O.ObservableComponent.field],e.prototype,"outlineColor",void 0),C([O.ObservableComponent.field],e.prototype,"color",void 0),C([O.ObservableComponent.field],e.prototype,"fontSize",void 0),C([O.ObservableComponent.field],e.prototype,"fontWeight",void 0),C([O.ObservableComponent.component],e.prototype,"font",void 0),C([O.ObservableComponent.field],e.prototype,"opacity",void 0),C([O.ObservableComponent.field],e.prototype,"value",void 0),C([O.ObservableComponent.field],e.prototype,"lineSpacing",void 0),C([O.ObservableComponent.field],e.prototype,"lineCount",void 0),C([O.ObservableComponent.field],e.prototype,"resizeToFit",void 0),C([O.ObservableComponent.field],e.prototype,"textWrapping",void 0),C([O.ObservableComponent.field],e.prototype,"shadowBlur",void 0),C([O.ObservableComponent.field],e.prototype,"shadowOffsetX",void 0),C([O.ObservableComponent.field],e.prototype,"shadowOffsetY",void 0),C([O.ObservableComponent.field],e.prototype,"shadowColor",void 0),C([O.ObservableComponent.field],e.prototype,"zIndex",void 0),C([O.ObservableComponent.field],e.prototype,"hTextAlign",void 0),C([O.ObservableComponent.field],e.prototype,"vTextAlign",void 0),C([O.ObservableComponent.field],e.prototype,"width",void 0),C([O.ObservableComponent.field],e.prototype,"height",void 0),C([O.ObservableComponent.field],e.prototype,"paddingTop",void 0),C([O.ObservableComponent.field],e.prototype,"paddingRight",void 0),C([O.ObservableComponent.field],e.prototype,"paddingBottom",void 0),C([O.ObservableComponent.field],e.prototype,"paddingLeft",void 0),C([O.ObservableComponent.field],e.prototype,"isPickable",void 0),C([O.ObservableComponent.field],e.prototype,"billboard",void 0),C([O.ObservableComponent.field],e.prototype,"visible",void 0),C([O.Component("engine.text",w.TEXT_SHAPE)],e)}(O.ObservableComponent);y.TextShape=W,function(l){l[l.OPAQUE=0]="OPAQUE",l[l.ALPHA_TEST=1]="ALPHA_TEST",l[l.ALPHA_BLEND=2]="ALPHA_BLEND",l[l.ALPHA_TEST_AND_BLEND=3]="ALPHA_TEST_AND_BLEND",l[l.AUTO=4]="AUTO"}(q=y.TransparencyMode||(y.TransparencyMode={}));var G=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.alphaTest=.5,y.castShadows=!0,y.transparencyMode=q.AUTO,y}return g(e,l),C([O.ObservableComponent.field],e.prototype,"alphaTest",void 0),C([O.ObservableComponent.field],e.prototype,"albedoColor",void 0),C([O.ObservableComponent.field],e.prototype,"emissiveColor",void 0),C([O.ObservableComponent.field],e.prototype,"metallic",void 0),C([O.ObservableComponent.field],e.prototype,"roughness",void 0),C([O.ObservableComponent.field],e.prototype,"ambientColor",void 0),C([O.ObservableComponent.field],e.prototype,"reflectionColor",void 0),C([O.ObservableComponent.field],e.prototype,"reflectivityColor",void 0),C([O.ObservableComponent.field],e.prototype,"directIntensity",void 0),C([O.ObservableComponent.field],e.prototype,"microSurface",void 0),C([O.ObservableComponent.field],e.prototype,"emissiveIntensity",void 0),C([O.ObservableComponent.field],e.prototype,"environmentIntensity",void 0),C([O.ObservableComponent.field],e.prototype,"specularIntensity",void 0),C([O.ObservableComponent.component],e.prototype,"albedoTexture",void 0),C([O.ObservableComponent.component],e.prototype,"alphaTexture",void 0),C([O.ObservableComponent.component],e.prototype,"emissiveTexture",void 0),C([O.ObservableComponent.component],e.prototype,"bumpTexture",void 0),C([O.ObservableComponent.component],e.prototype,"refractionTexture",void 0),C([O.ObservableComponent.field],e.prototype,"castShadows",void 0),C([O.ObservableComponent.field],e.prototype,"transparencyMode",void 0),C([O.DisposableComponent("engine.material",w.PBR_MATERIAL)],e)}(O.ObservableComponent);y.Material=G;var J=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.alphaTest=.5,y.castShadows=!0,y}return g(e,l),C([O.ObservableComponent.component],e.prototype,"texture",void 0),C([O.ObservableComponent.field],e.prototype,"alphaTest",void 0),C([O.ObservableComponent.field],e.prototype,"castShadows",void 0),C([O.DisposableComponent("engine.material",w.BASIC_MATERIAL)],e)}(O.ObservableComponent);y.BasicMaterial=J;var Y=function(l){function e(y){var v=l.call(this)||this;if(v.uuid=S.newId("UUID"),!y||!("apply"in y)||!("call"in y))throw new Error("Callback is not a function");return v.callback=y,v}return g(e,l),e.uuidEvent=function(l,y){if(delete l[y]){var v=y+"_"+Math.random();l[v]=void 0,Object.defineProperty(l,v,b(b({},Object.getOwnPropertyDescriptor(l,v)),{enumerable:!1})),Object.defineProperty(l,y.toString(),{get:function(){return this[v]},set:function(l){var m=this[v];if(l){if(!(l instanceof e))throw new Error("value is not an OnUUIDEvent");this.data[y]=l.uuid}else this.data[y]=null;if(this[v]=l,l!==m){this.dirty=!0;for(var g=0;g<this.subscriptions.length;g++)this.subscriptions[g](y,l,m)}},enumerable:!0})}},e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type}},C([O.ObservableComponent.field],e.prototype,"callback",void 0),e}(O.ObservableComponent);y.OnUUIDEvent=Y;var X=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.button=E.ActionButton.ANY,y.hoverText="Interact",y.distance=10,y.showFeedback=!0,y}return g(e,l),e.prototype.toJSON=function(){return{uuid:this.uuid,type:this.type,button:this.button,hoverText:this.hoverText,distance:this.distance,showFeedback:this.showFeedback}},C([O.ObservableComponent.field],e.prototype,"button",void 0),C([O.ObservableComponent.field],e.prototype,"hoverText",void 0),C([O.ObservableComponent.field],e.prototype,"distance",void 0),C([O.ObservableComponent.field],e.prototype,"showFeedback",void 0),e}(Y);y.OnPointerUUIDEvent=X;var Q=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.type="onPointerLock",y}return g(e,l),C([O.ObservableComponent.readonly],e.prototype,"type",void 0),C([O.Component("engine.onPointerLock",w.UUID_CALLBACK)],e)}(Y);y.OnPointerLock=Q;var K=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.type="onAnimationEnd",y}return g(e,l),C([O.ObservableComponent.readonly],e.prototype,"type",void 0),C([O.Component("engine.onAnimationEnd",w.UUID_CALLBACK)],e)}(Y);y.OnAnimationEnd=K;var Z=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}return g(e,l),C([O.Component("engine.smartItem",w.SMART_ITEM)],e)}(O.ObservableComponent);y.SmartItem=Z;var tt=function(l){function e(y){var v=l.call(this)||this;return v.url=y,v}return g(e,l),C([O.ObservableComponent.readonly],e.prototype,"url",void 0),C([O.DisposableComponent("engine.VideoClip",w.VIDEO_CLIP)],e)}(O.ObservableComponent);y.VideoClip=tt;var et=function(l){function e(y,v){var m=l.call(this)||this;if(m.volume=1,m.playbackRate=1,m.loop=!1,m.seek=-1,m.playing=!1,!(y instanceof tt))throw new Error("Trying to create VideoTexture(VideoClip) with an invalid VideoClip");if(m.videoClipId=O.getComponentId(y),v)for(var g in v)m[g]=v[g];return m}return g(e,l),e.prototype.play=function(){this.playing=!0},e.prototype.pause=function(){this.playing=!1},e.prototype.reset=function(){this.seekTime(0),this.pause()},e.prototype.seekTime=function(l){this.seek=l,this.dirty=!0,this.data.nonce=Math.random()},e.prototype.toJSON=function(){if(this.seek>=0){var y=JSON.parse(JSON.stringify(l.prototype.toJSON.call(this)));return this.seek=-1,y}return l.prototype.toJSON.call(this)},C([O.ObservableComponent.readonly],e.prototype,"videoClipId",void 0),C([O.ObservableComponent.readonly],e.prototype,"samplingMode",void 0),C([O.ObservableComponent.readonly],e.prototype,"wrap",void 0),C([O.ObservableComponent.field],e.prototype,"volume",void 0),C([O.ObservableComponent.field],e.prototype,"playbackRate",void 0),C([O.ObservableComponent.field],e.prototype,"loop",void 0),C([O.ObservableComponent.field],e.prototype,"seek",void 0),C([O.ObservableComponent.field],e.prototype,"playing",void 0),C([O.DisposableComponent("engine.VideoTexture",w.VIDEO_TEXTURE)],e)}(O.ObservableComponent);y.VideoTexture=et},function(l,y,v){"use strict";var m=this&&this.__createBinding||(Object.create?function(l,y,v,m){void 0===m&&(m=v),Object.defineProperty(l,m,{enumerable:!0,get:function(){return y[v]}})}:function(l,y,v,m){void 0===m&&(m=v),l[m]=y[v]}),g=this&&this.__exportStar||function(l,y){for(var v in l)"default"===v||Object.prototype.hasOwnProperty.call(y,v)||m(y,l,v)};Object.defineProperty(y,"__esModule",{value:!0}),g(v(2),y),g(v(9),y),g(v(24),y),g(v(25),y),g(v(35),y),g(v(36),y),g(v(37),y),g(v(26),y),g(v(38),y),g(v(39),y),g(v(13),y),g(v(40),y),g(v(41),y),g(v(27),y),g(v(12),y),g(v(4),y),g(v(42),y),g(v(17),y),g(v(3),y),g(v(23),y),g(v(6),y)},function(l,y,v){"use strict";var m=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.ParentChanged=y.ComponentAdded=y.ComponentRemoved=void 0;var g=v(8),b=m([g.EventConstructor()],(function(l,y,v){this.entity=l,this.componentName=y,this.component=v}));y.ComponentRemoved=b;var C=m([g.EventConstructor()],(function(l,y,v){this.entity=l,this.componentName=y,this.classId=v}));y.ComponentAdded=C;var w=m([g.EventConstructor()],(function(l,y){this.entity=l,this.parent=y}));y.ParentChanged=w},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.EventConstructor=y.EventManager=void 0;var m=v(1),g=[];function i(l){if(!("__event_name__"in l)||"string"!=typeof l.__event_name__)throw new Error("The EventConstructor is not registered");return l.__event_name__}var b=function(){function t(){this.listeners={}}return t.prototype.addListener=function(l,y,v){if(!l||"function"!=typeof l)throw new Error("Invalid EventConstructor");var m=i(l),g=this.listeners[m];g||(g=this.listeners[m]=[]);for(var b=0;b<g.length;b++)if(g[b].listener===y)throw new Error("The provided listener is already registered");return g.push({listener:y,fn:v}),this},t.prototype.removeListener=function(l,y){if(!y||"function"!=typeof y)throw new Error("Invalid EventConstructor");var v=i(y),m=this.listeners[v];if(!m)return!1;for(var g=0;g<m.length;g++)if(m[g].listener===l)return m.splice(g,1),!0;return!1},t.prototype.fireEvent=function(l){var y=i(l.constructor),v=this.listeners[y];if(v)for(var g=0;g<v.length;g++)try{var b=v[g];b.fn.call(b.listener,l)}catch(l){m.error(l)}return this},t}();y.EventManager=b,y.EventConstructor=function(){var l=m.newId("EV");if(-1!==g.indexOf(l))throw new Error("The event name "+l+" is already taken");return g.push(l),function(y){return y.__event_name__=l,y}}},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MathTmp=void 0;var m=v(1),g=v(3),b=v(12),C=v(13);y.MathTmp={Vector3:m.buildArray(6,g.Vector3.Zero),Matrix:m.buildArray(2,C.Matrix.Identity),Quaternion:m.buildArray(3,b.Quaternion.Zero),staticUp:g.Vector3.Up(),tmpMatrix:C.Matrix.Zero()}},function(l,y,v){"use strict";var m=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y._initEventObservables=y.onPlayerExpressionObservable=y.onSceneReadyObservable=y.onLeaveScene=y.onLeaveSceneObservable=y.onEnterScene=y.onEnterSceneObservable=y.onIdleStateChangedObservable=y.onCameraModeChangedObservable=y.PointerEvent=y.RaycastResponse=y.UUIDEvent=y.CameraMode=void 0;var g=v(8),b=v(15),C=v(11);Object.defineProperty(y,"CameraMode",{enumerable:!0,get:function(){return C.CameraMode}});var w=m([g.EventConstructor()],(function(l,y){this.uuid=l,this.payload=y}));y.UUIDEvent=w;var O=m([g.EventConstructor()],(function(l){this.payload=l}));y.RaycastResponse=O;var x,A=m([g.EventConstructor()],(function(l){this.payload=l}));function c(l){return function(){x&&x.subscribe(l)}}y.PointerEvent=A,y.onCameraModeChangedObservable=new b.Observable(c("cameraModeChanged")),y.onIdleStateChangedObservable=new b.Observable(c("idleStateChanged")),y.onEnterSceneObservable=new b.Observable(c("onEnterScene")),y.onEnterScene=y.onEnterSceneObservable,y.onLeaveSceneObservable=new b.Observable(c("onLeaveScene")),y.onLeaveScene=y.onLeaveSceneObservable,y.onSceneReadyObservable=new b.Observable(c("sceneStart")),y.onPlayerExpressionObservable=new b.Observable(c("playerExpression")),y._initEventObservables=function(l){(x=l)&&x.onEvent((function(l){switch(l.type){case"onEnterScene":return void y.onEnterSceneObservable.notifyObservers(l.data);case"onLeaveScene":return void y.onLeaveSceneObservable.notifyObservers(l.data);case"cameraModeChanged":return void y.onCameraModeChangedObservable.notifyObservers(l.data);case"idleStateChanged":return void y.onIdleStateChangedObservable.notifyObservers(l.data);case"sceneStart":return void y.onSceneReadyObservable.notifyObservers(l.data);case"playerExpression":return void y.onPlayerExpressionObservable.notifyObservers(l.data)}}))}},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.LandRole=y.AVATAR_OBSERVABLE=y.CameraMode=y.InputEventType=void 0,function(l){l[l.DOWN=0]="DOWN",l[l.UP=1]="UP"}(y.InputEventType||(y.InputEventType={})),function(l){l[l.FirstPerson=0]="FirstPerson",l[l.ThirdPerson=1]="ThirdPerson",l[l.BuildingToolGodMode=2]="BuildingToolGodMode"}(y.CameraMode||(y.CameraMode={})),y.AVATAR_OBSERVABLE="AVATAR_OBSERVABLE",function(l){l.OWNER="owner",l.OPERATOR="operator"}(y.LandRole||(y.LandRole={}))},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Quaternion=void 0;var m=v(13),g=v(3),b=v(9),C=v(2),w=v(4),O=function(){function t(l,y,v,m){void 0===l&&(l=0),void 0===y&&(y=0),void 0===v&&(v=0),void 0===m&&(m=1),this.x=l,this.y=y,this.z=v,this.w=m}return t.FromRotationMatrix=function(l){var y=new t;return t.FromRotationMatrixToRef(l,y),y},t.FromRotationMatrixToRef=function(l,y){var v,m=l.m,g=m[0],b=m[4],C=m[8],w=m[1],O=m[5],x=m[9],A=m[2],S=m[6],E=m[10],T=g+O+E;T>0?(v=.5/Math.sqrt(T+1),y.w=.25/v,y.x=(S-x)*v,y.y=(C-A)*v,y.z=(w-b)*v):g>O&&g>E?(v=2*Math.sqrt(1+g-O-E),y.w=(S-x)/v,y.x=.25*v,y.y=(b+w)/v,y.z=(C+A)/v):O>E?(v=2*Math.sqrt(1+O-g-E),y.w=(C-A)/v,y.x=(b+w)/v,y.y=.25*v,y.z=(x+S)/v):(v=2*Math.sqrt(1+E-g-O),y.w=(w-b)/v,y.x=(C+A)/v,y.y=(x+S)/v,y.z=.25*v)},t.Dot=function(l,y){return l.x*y.x+l.y*y.y+l.z*y.z+l.w*y.w},t.AreClose=function(l,y){return t.Dot(l,y)>=0},t.Zero=function(){return new t(0,0,0,0)},t.Inverse=function(l){return new t(-l.x,-l.y,-l.z,l.w)},t.IsIdentity=function(l){return l&&0===l.x&&0===l.y&&0===l.z&&1===l.w},t.RotationAxis=function(l,y){var v=y*C.DEG2RAD;return t.RotationAxisToRef(l,v,new t)},t.RotationAxisToRef=function(l,y,v){var m=y*C.DEG2RAD,g=Math.sin(m/2);return l.normalize(),v.w=Math.cos(m/2),v.x=l.x*g,v.y=l.y*g,v.z=l.z*g,v},t.FromArray=function(l,y){return void 0===y&&(y=0),new t(l[y],l[y+1],l[y+2],l[y+3])},t.FromEulerAnglesRef=function(l,y,v,m){return t.RotationYawPitchRollToRef(y*C.DEG2RAD,l*C.DEG2RAD,v*C.DEG2RAD,m)},t.RotationYawPitchRoll=function(l,y,v){var m=new t;return t.RotationYawPitchRollToRef(l,y,v,m),m},t.RotationYawPitchRollToRef=function(l,y,v,m){var g=.5*y,b=.5*l,C=.5*v,w=Math.cos(g),O=Math.cos(b),x=Math.cos(C),A=Math.sin(g),S=Math.sin(b),E=Math.sin(C);m.x=O*A*x+S*w*E,m.y=S*w*x-O*A*E,m.z=O*w*E-S*A*x,m.w=O*w*x+S*A*E},t.RotationAlphaBetaGamma=function(l,y,v){var m=new t;return t.RotationAlphaBetaGammaToRef(l,y,v,m),m},t.RotationAlphaBetaGammaToRef=function(l,y,v,m){var g=.5*(v+l),b=.5*(v-l),C=.5*y;m.x=Math.cos(b)*Math.sin(C),m.y=Math.sin(b)*Math.sin(C),m.z=Math.sin(g)*Math.cos(C),m.w=Math.cos(g)*Math.cos(C)},t.RotationQuaternionFromAxis=function(l,y,v){var m=new t(0,0,0,0);return t.RotationQuaternionFromAxisToRef(l,y,v,m),m},t.RotationQuaternionFromAxisToRef=function(l,y,v,g){var C=b.MathTmp.Matrix[0];m.Matrix.FromXYZAxesToRef(l.normalize(),y.normalize(),v.normalize(),C),t.FromRotationMatrixToRef(C,g)},t.Slerp=function(l,y,v){var m=t.Identity;return t.SlerpToRef(l,y,v,m),m},t.SlerpToRef=function(l,y,v,m){var g,b,C=l.x*y.x+l.y*y.y+l.z*y.z+l.w*y.w,w=!1;if(C<0&&(w=!0,C=-C),C>.999999)b=1-v,g=w?-v:v;else{var O=Math.acos(C),x=1/Math.sin(O);b=Math.sin((1-v)*O)*x,g=w?-Math.sin(v*O)*x:Math.sin(v*O)*x}m.x=b*l.x+g*y.x,m.y=b*l.y+g*y.y,m.z=b*l.z+g*y.z,m.w=b*l.w+g*y.w},t.Hermite=function(l,y,v,m,g){var b=g*g,C=g*b,w=2*C-3*b+1,O=-2*C+3*b,x=C-2*b+g,A=C-b;return new t(l.x*w+v.x*O+y.x*x+m.x*A,l.y*w+v.y*O+y.y*x+m.y*A,l.z*w+v.z*O+y.z*x+m.z*A,l.w*w+v.w*O+y.w*x+m.w*A)},Object.defineProperty(t,"Identity",{get:function(){return new t(0,0,0,1)},enumerable:!1,configurable:!0}),t.Angle=function(l,y){var v=t.Dot(l,y);return 2*Math.acos(Math.min(Math.abs(v),1))*C.RAD2DEG},t.Euler=function(l,y,v){return t.RotationYawPitchRoll(y*C.DEG2RAD,l*C.DEG2RAD,v*C.DEG2RAD)},t.LookRotation=function(l,y){void 0===y&&(y=b.MathTmp.staticUp);var v=g.Vector3.Normalize(l),m=g.Vector3.Normalize(g.Vector3.Cross(y,v)),C=g.Vector3.Cross(v,m),w=m.x,O=m.y,x=m.z,A=C.x,S=C.y,E=C.z,T=v.x,R=v.y,I=v.z,P=w+S+I,M=new t;if(P>0){var z=Math.sqrt(P+1);return M.w=.5*z,z=.5/z,M.x=(E-R)*z,M.y=(T-x)*z,M.z=(O-A)*z,M}if(w>=S&&w>=I){var D=Math.sqrt(1+w-S-I),F=.5/D;return M.x=.5*D,M.y=(O+A)*F,M.z=(x+T)*F,M.w=(E-R)*F,M}if(S>I){var N=Math.sqrt(1+S-w-I),U=.5/N;return M.x=(A+O)*U,M.y=.5*N,M.z=(R+E)*U,M.w=(T-x)*U,M}var $=Math.sqrt(1+I-w-S),L=.5/$;return M.x=(T+x)*L,M.y=(R+E)*L,M.z=.5*$,M.w=(O-A)*L,M},t.RotateTowards=function(l,y,v){var m=t.Angle(l,y);if(0===m)return y;var g=Math.min(1,v/m);return t.Slerp(l,y,g)},t.FromToRotation=function(l,y,v){void 0===v&&(v=b.MathTmp.staticUp);var m=l.normalize(),C=y.normalize(),w=g.Vector3.Cross(m,C),O=Math.sqrt(m.lengthSquared()*C.lengthSquared())+g.Vector3.Dot(m,C);return w.lengthSquared()<1e-4?Math.abs(O)<1e-4?new t(v.x,v.y,v.z,0).normalized:t.Identity:new t(w.x,w.y,w.z,O).normalized},Object.defineProperty(t.prototype,"normalized",{get:function(){return this.normalize()},enumerable:!1,configurable:!0}),t.prototype.setFromToRotation=function(l,y,v){void 0===v&&(v=b.MathTmp.staticUp);var m=t.FromToRotation(l,y,v);this.x=m.x,this.y=m.y,this.z=m.z,this.w=m.w},Object.defineProperty(t.prototype,"eulerAngles",{get:function(){var l=new g.Vector3,y=this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w,v=this.x*this.w-this.y*this.z;return v>.4995*y?(l.x=Math.PI/2,l.y=2*Math.atan2(this.y,this.x),l.z=0):v<-.4995*y?(l.x=-Math.PI/2,l.y=-2*Math.atan2(this.y,this.x),l.z=0):(l.x=Math.asin(2*(this.w*this.x-this.y*this.z)),l.y=Math.atan2(2*this.w*this.y+2*this.z*this.x,1-2*(this.x*this.x+this.y*this.y)),l.z=Math.atan2(2*this.w*this.z+2*this.x*this.y,1-2*(this.z*this.z+this.x*this.x))),l.x*=C.RAD2DEG,l.y*=C.RAD2DEG,l.z*=C.RAD2DEG,l.x=w.Scalar.Repeat(l.x,360),l.y=w.Scalar.Repeat(l.y,360),l.z=w.Scalar.Repeat(l.z,360),l},set:function(l){this.setEuler(l.x,l.y,l.z)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+", "+this.w+")"},Object.defineProperty(t.prototype,"length",{get:function(){return Math.sqrt(this.lengthSquared)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lengthSquared",{get:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},enumerable:!1,configurable:!0}),t.prototype.getClassName=function(){return"Quaternion"},t.prototype.getHashCode=function(){var l=this.x||0;return 397*(l=397*(l=397*l^(this.y||0))^(this.z||0))^(this.w||0)},t.prototype.asArray=function(){return[this.x,this.y,this.z,this.w]},t.prototype.equals=function(l){return l&&this.x===l.x&&this.y===l.y&&this.z===l.z&&this.w===l.w},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(l){return this.x=l.x,this.y=l.y,this.z=l.z,this.w=l.w,this},t.prototype.copyFromFloats=function(l,y,v,m){return this.x=l,this.y=y,this.z=v,this.w=m,this},t.prototype.set=function(l,y,v,m){return this.copyFromFloats(l,y,v,m)},t.prototype.setEuler=function(l,y,v){return t.RotationYawPitchRollToRef(y*C.DEG2RAD,l*C.DEG2RAD,v*C.DEG2RAD,this),this},t.prototype.add=function(l){return new t(this.x+l.x,this.y+l.y,this.z+l.z,this.w+l.w)},t.prototype.addInPlace=function(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this.w+=l.w,this},t.prototype.subtract=function(l){return new t(this.x-l.x,this.y-l.y,this.z-l.z,this.w-l.w)},t.prototype.scale=function(l){return new t(this.x*l,this.y*l,this.z*l,this.w*l)},t.prototype.scaleToRef=function(l,y){return y.x=this.x*l,y.y=this.y*l,y.z=this.z*l,y.w=this.w*l,this},t.prototype.scaleInPlace=function(l){return this.x*=l,this.y*=l,this.z*=l,this.w*=l,this},t.prototype.scaleAndAddToRef=function(l,y){return y.x+=this.x*l,y.y+=this.y*l,y.z+=this.z*l,y.w+=this.w*l,this},t.prototype.multiply=function(l){var y=new t(0,0,0,1);return this.multiplyToRef(l,y),y},t.prototype.multiplyToRef=function(l,y){var v=this.x*l.w+this.y*l.z-this.z*l.y+this.w*l.x,m=-this.x*l.z+this.y*l.w+this.z*l.x+this.w*l.y,g=this.x*l.y-this.y*l.x+this.z*l.w+this.w*l.z,b=-this.x*l.x-this.y*l.y-this.z*l.z+this.w*l.w;return y.copyFromFloats(v,m,g,b),this},t.prototype.multiplyInPlace=function(l){return this.multiplyToRef(l,this),this},t.prototype.conjugateToRef=function(l){return l.copyFromFloats(-this.x,-this.y,-this.z,this.w),this},t.prototype.conjugateInPlace=function(){return this.x*=-1,this.y*=-1,this.z*=-1,this},t.prototype.conjugate=function(){return new t(-this.x,-this.y,-this.z,this.w)},t.prototype.normalize=function(){var l=1/this.length;return this.x*=l,this.y*=l,this.z*=l,this.w*=l,this},t.prototype.angleAxis=function(l,y){if(0===y.lengthSquared())return t.Identity;var v=t.Identity,m=l*C.DEG2RAD;m*=.5;var g=y.normalize();return g=y.scaleInPlace(Math.sin(m)),v.x=g.x,v.y=g.y,v.z=g.z,v.w=Math.cos(m),v.normalize()},t.prototype.toRotationMatrix=function(l){return m.Matrix.FromQuaternionToRef(this,l),this},t.prototype.fromRotationMatrix=function(l){return t.FromRotationMatrixToRef(l,this),this},t}();y.Quaternion=O},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Matrix=void 0;var m=v(3),g=v(12),b=v(9),C=v(23),w=function(){function t(){this._isIdentity=!1,this._isIdentityDirty=!0,this._isIdentity3x2=!0,this._isIdentity3x2Dirty=!0,this._m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this._updateIdentityStatus(!1)}return Object.defineProperty(t.prototype,"m",{get:function(){return this._m},enumerable:!1,configurable:!0}),Object.defineProperty(t,"IdentityReadOnly",{get:function(){return t._identityReadOnly},enumerable:!1,configurable:!0}),t.FromArray=function(l,y){void 0===y&&(y=0);var v=new t;return t.FromArrayToRef(l,y,v),v},t.FromArrayToRef=function(l,y,v){for(var m=0;m<16;m++)v._m[m]=l[m+y];v._markAsUpdated()},t.FromFloatArrayToRefScaled=function(l,y,v,m){for(var g=0;g<16;g++)m._m[g]=l[g+y]*v;m._markAsUpdated()},t.FromValuesToRef=function(l,y,v,m,g,b,C,w,O,x,A,S,E,T,R,I,P){var M=P._m;M[0]=l,M[1]=y,M[2]=v,M[3]=m,M[4]=g,M[5]=b,M[6]=C,M[7]=w,M[8]=O,M[9]=x,M[10]=A,M[11]=S,M[12]=E,M[13]=T,M[14]=R,M[15]=I,P._markAsUpdated()},t.FromValues=function(l,y,v,m,g,b,C,w,O,x,A,S,E,T,R,I){var P=new t,M=P._m;return M[0]=l,M[1]=y,M[2]=v,M[3]=m,M[4]=g,M[5]=b,M[6]=C,M[7]=w,M[8]=O,M[9]=x,M[10]=A,M[11]=S,M[12]=E,M[13]=T,M[14]=R,M[15]=I,P._markAsUpdated(),P},t.Compose=function(l,y,v){var m=new t;return t.ComposeToRef(l,y,v,m),m},t.ComposeToRef=function(l,y,v,m){t.ScalingToRef(l.x,l.y,l.z,b.MathTmp.Matrix[1]),y.toRotationMatrix(b.MathTmp.Matrix[0]),b.MathTmp.Matrix[1].multiplyToRef(b.MathTmp.Matrix[0],m),m.setTranslation(v)},t.Identity=function(){var l=t.FromValues(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return l._updateIdentityStatus(!0),l},t.IdentityToRef=function(l){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,l),l._updateIdentityStatus(!0)},t.Zero=function(){var l=t.FromValues(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return l._updateIdentityStatus(!1),l},t.RotationX=function(l){var y=new t;return t.RotationXToRef(l,y),y},t.Invert=function(l){var y=new t;return l.invertToRef(y),y},t.RotationXToRef=function(l,y){var v=Math.sin(l),m=Math.cos(l);t.FromValuesToRef(1,0,0,0,0,m,v,0,0,-v,m,0,0,0,0,1,y),y._updateIdentityStatus(1===m&&0===v)},t.RotationY=function(l){var y=new t;return t.RotationYToRef(l,y),y},t.RotationYToRef=function(l,y){var v=Math.sin(l),m=Math.cos(l);t.FromValuesToRef(m,0,-v,0,0,1,0,0,v,0,m,0,0,0,0,1,y),y._updateIdentityStatus(1===m&&0===v)},t.RotationZ=function(l){var y=new t;return t.RotationZToRef(l,y),y},t.RotationZToRef=function(l,y){var v=Math.sin(l),m=Math.cos(l);t.FromValuesToRef(m,v,0,0,-v,m,0,0,0,0,1,0,0,0,0,1,y),y._updateIdentityStatus(1===m&&0===v)},t.RotationAxis=function(l,y){var v=new t;return t.RotationAxisToRef(l,y,v),v},t.RotationAxisToRef=function(l,y,v){var m=Math.sin(-y),g=Math.cos(-y),b=1-g;l.normalize();var C=v._m;C[0]=l.x*l.x*b+g,C[1]=l.x*l.y*b-l.z*m,C[2]=l.x*l.z*b+l.y*m,C[3]=0,C[4]=l.y*l.x*b+l.z*m,C[5]=l.y*l.y*b+g,C[6]=l.y*l.z*b-l.x*m,C[7]=0,C[8]=l.z*l.x*b-l.y*m,C[9]=l.z*l.y*b+l.x*m,C[10]=l.z*l.z*b+g,C[11]=0,C[12]=0,C[13]=0,C[14]=0,C[15]=1,v._markAsUpdated()},t.RotationYawPitchRoll=function(l,y,v){var m=new t;return t.RotationYawPitchRollToRef(l,y,v,m),m},t.RotationYawPitchRollToRef=function(l,y,v,m){g.Quaternion.RotationYawPitchRollToRef(l,y,v,b.MathTmp.Quaternion[0]),b.MathTmp.Quaternion[0].toRotationMatrix(m)},t.Scaling=function(l,y,v){var m=new t;return t.ScalingToRef(l,y,v,m),m},t.ScalingToRef=function(l,y,v,m){t.FromValuesToRef(l,0,0,0,0,y,0,0,0,0,v,0,0,0,0,1,m),m._updateIdentityStatus(1===l&&1===y&&1===v)},t.Translation=function(l,y,v){var m=new t;return t.TranslationToRef(l,y,v,m),m},t.TranslationToRef=function(l,y,v,m){t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,l,y,v,1,m),m._updateIdentityStatus(0===l&&0===y&&0===v)},t.Lerp=function(l,y,v){var m=new t;return t.LerpToRef(l,y,v,m),m},t.LerpToRef=function(l,y,v,m){for(var g=0;g<16;g++)m._m[g]=l._m[g]*(1-v)+y._m[g]*v;m._markAsUpdated()},t.DecomposeLerp=function(l,y,v){var m=new t;return t.DecomposeLerpToRef(l,y,v,m),m},t.DecomposeLerpToRef=function(l,y,v,C){var w=b.MathTmp.Vector3[0],O=b.MathTmp.Quaternion[0],x=b.MathTmp.Vector3[1];l.decompose(w,O,x);var A=b.MathTmp.Vector3[2],S=b.MathTmp.Quaternion[1],E=b.MathTmp.Vector3[3];y.decompose(A,S,E);var T=b.MathTmp.Vector3[4];m.Vector3.LerpToRef(w,A,v,T);var R=b.MathTmp.Quaternion[2];g.Quaternion.SlerpToRef(O,S,v,R);var I=b.MathTmp.Vector3[5];m.Vector3.LerpToRef(x,E,v,I),t.ComposeToRef(T,R,I,C)},t.LookAtLH=function(l,y,v){var m=new t;return t.LookAtLHToRef(l,y,v,m),m},t.LookAtLHToRef=function(l,y,v,g){var C=b.MathTmp.Vector3[0],w=b.MathTmp.Vector3[1],O=b.MathTmp.Vector3[2];y.subtractToRef(l,O),O.normalize(),m.Vector3.CrossToRef(v,O,C);var x=C.lengthSquared();0===x?C.x=1:C.normalizeFromLength(Math.sqrt(x)),m.Vector3.CrossToRef(O,C,w),w.normalize();var A=-m.Vector3.Dot(C,l),S=-m.Vector3.Dot(w,l),E=-m.Vector3.Dot(O,l);t.FromValuesToRef(C.x,w.x,O.x,0,C.y,w.y,O.y,0,C.z,w.z,O.z,0,A,S,E,1,g)},t.LookAtRH=function(l,y,v){var m=new t;return t.LookAtRHToRef(l,y,v,m),m},t.LookAtRHToRef=function(l,y,v,g){var C=b.MathTmp.Vector3[0],w=b.MathTmp.Vector3[1],O=b.MathTmp.Vector3[2];l.subtractToRef(y,O),O.normalize(),m.Vector3.CrossToRef(v,O,C);var x=C.lengthSquared();0===x?C.x=1:C.normalizeFromLength(Math.sqrt(x)),m.Vector3.CrossToRef(O,C,w),w.normalize();var A=-m.Vector3.Dot(C,l),S=-m.Vector3.Dot(w,l),E=-m.Vector3.Dot(O,l);t.FromValuesToRef(C.x,w.x,O.x,0,C.y,w.y,O.y,0,C.z,w.z,O.z,0,A,S,E,1,g)},t.OrthoLH=function(l,y,v,m){var g=new t;return t.OrthoLHToRef(l,y,v,m,g),g},t.OrthoLHToRef=function(l,y,v,m,g){var b=2/l,C=2/y,w=2/(m-v),O=-(m+v)/(m-v);t.FromValuesToRef(b,0,0,0,0,C,0,0,0,0,w,0,0,0,O,1,g),g._updateIdentityStatus(1===b&&1===C&&1===w&&0===O)},t.OrthoOffCenterLH=function(l,y,v,m,g,b){var C=new t;return t.OrthoOffCenterLHToRef(l,y,v,m,g,b,C),C},t.OrthoOffCenterLHToRef=function(l,y,v,m,g,b,C){var w=2/(y-l),O=2/(m-v),x=2/(b-g),A=-(b+g)/(b-g),S=(l+y)/(l-y),E=(m+v)/(v-m);t.FromValuesToRef(w,0,0,0,0,O,0,0,0,0,x,0,S,E,A,1,C),C._markAsUpdated()},t.OrthoOffCenterRH=function(l,y,v,m,g,b){var C=new t;return t.OrthoOffCenterRHToRef(l,y,v,m,g,b,C),C},t.OrthoOffCenterRHToRef=function(l,y,v,m,g,b,C){t.OrthoOffCenterLHToRef(l,y,v,m,g,b,C),C._m[10]*=-1},t.PerspectiveLH=function(l,y,v,m){var g=new t,b=2*v/l,C=2*v/y,w=(m+v)/(m-v),O=-2*m*v/(m-v);return t.FromValuesToRef(b,0,0,0,0,C,0,0,0,0,w,1,0,0,O,0,g),g._updateIdentityStatus(!1),g},t.PerspectiveFovLH=function(l,y,v,m){var g=new t;return t.PerspectiveFovLHToRef(l,y,v,m,g),g},t.PerspectiveFovLHToRef=function(l,y,v,m,g,b){void 0===b&&(b=!0);var C=v,w=m,O=1/Math.tan(.5*l),x=b?O/y:O,A=b?O:O*y,S=(w+C)/(w-C),E=-2*w*C/(w-C);t.FromValuesToRef(x,0,0,0,0,A,0,0,0,0,S,1,0,0,E,0,g),g._updateIdentityStatus(!1)},t.PerspectiveFovRH=function(l,y,v,m){var g=new t;return t.PerspectiveFovRHToRef(l,y,v,m,g),g},t.PerspectiveFovRHToRef=function(l,y,v,m,g,b){void 0===b&&(b=!0);var C=v,w=m,O=1/Math.tan(.5*l),x=b?O/y:O,A=b?O:O*y,S=-(w+C)/(w-C),E=-2*w*C/(w-C);t.FromValuesToRef(x,0,0,0,0,A,0,0,0,0,S,-1,0,0,E,0,g),g._updateIdentityStatus(!1)},t.PerspectiveFovWebVRToRef=function(l,y,v,m,g){void 0===g&&(g=!1);var b=g?-1:1,C=Math.tan(l.upDegrees*Math.PI/180),w=Math.tan(l.downDegrees*Math.PI/180),O=Math.tan(l.leftDegrees*Math.PI/180),x=Math.tan(l.rightDegrees*Math.PI/180),A=2/(O+x),S=2/(C+w),E=m._m;E[0]=A,E[1]=E[2]=E[3]=E[4]=0,E[5]=S,E[6]=E[7]=0,E[8]=(O-x)*A*.5,E[9]=-(C-w)*S*.5,E[10]=-v/(y-v),E[11]=1*b,E[12]=E[13]=E[15]=0,E[14]=-2*v*y/(v-y),m._markAsUpdated()},t.GetAsMatrix2x2=function(l){return[l._m[0],l._m[1],l._m[4],l._m[5]]},t.GetAsMatrix3x3=function(l){return[l._m[0],l._m[1],l._m[2],l._m[4],l._m[5],l._m[6],l._m[8],l._m[9],l._m[10]]},t.Transpose=function(l){var y=new t;return t.TransposeToRef(l,y),y},t.TransposeToRef=function(l,y){var v=y._m,m=l._m;v[0]=m[0],v[1]=m[4],v[2]=m[8],v[3]=m[12],v[4]=m[1],v[5]=m[5],v[6]=m[9],v[7]=m[13],v[8]=m[2],v[9]=m[6],v[10]=m[10],v[11]=m[14],v[12]=m[3],v[13]=m[7],v[14]=m[11],v[15]=m[15],y._updateIdentityStatus(l._isIdentity,l._isIdentityDirty)},t.Reflection=function(l){var y=new t;return t.ReflectionToRef(l,y),y},t.ReflectionToRef=function(l,y){l.normalize();var v=l.normal.x,m=l.normal.y,g=l.normal.z,b=-2*v,C=-2*m,w=-2*g;t.FromValuesToRef(b*v+1,C*v,w*v,0,b*m,C*m+1,w*m,0,b*g,C*g,w*g+1,0,b*l.d,C*l.d,w*l.d,1,y)},t.FromXYZAxesToRef=function(l,y,v,m){t.FromValuesToRef(l.x,l.y,l.z,0,y.x,y.y,y.z,0,v.x,v.y,v.z,0,0,0,0,1,m)},t.FromQuaternionToRef=function(l,y){var v=l.x*l.x,m=l.y*l.y,g=l.z*l.z,b=l.x*l.y,C=l.z*l.w,w=l.z*l.x,O=l.y*l.w,x=l.y*l.z,A=l.x*l.w;y._m[0]=1-2*(m+g),y._m[1]=2*(b+C),y._m[2]=2*(w-O),y._m[3]=0,y._m[4]=2*(b-C),y._m[5]=1-2*(g+v),y._m[6]=2*(x+A),y._m[7]=0,y._m[8]=2*(w+O),y._m[9]=2*(x-A),y._m[10]=1-2*(m+v),y._m[11]=0,y._m[12]=0,y._m[13]=0,y._m[14]=0,y._m[15]=1,y._markAsUpdated()},t.prototype._markAsUpdated=function(){this.updateFlag=t._updateFlagSeed++,this._isIdentity=!1,this._isIdentity3x2=!1,this._isIdentityDirty=!0,this._isIdentity3x2Dirty=!0},t.prototype.isIdentity=function(){if(this._isIdentityDirty){this._isIdentityDirty=!1;var l=this._m;this._isIdentity=1===l[0]&&0===l[1]&&0===l[2]&&0===l[3]&&0===l[4]&&1===l[5]&&0===l[6]&&0===l[7]&&0===l[8]&&0===l[9]&&1===l[10]&&0===l[11]&&0===l[12]&&0===l[13]&&0===l[14]&&1===l[15]}return this._isIdentity},t.prototype.isIdentityAs3x2=function(){return this._isIdentity3x2Dirty&&(this._isIdentity3x2Dirty=!1,1!==this._m[0]||1!==this._m[5]||1!==this._m[15]||0!==this._m[1]||0!==this._m[2]||0!==this._m[3]||0!==this._m[4]||0!==this._m[6]||0!==this._m[7]||0!==this._m[8]||0!==this._m[9]||0!==this._m[10]||0!==this._m[11]||0!==this._m[12]||0!==this._m[13]||0!==this._m[14]?this._isIdentity3x2=!1:this._isIdentity3x2=!0),this._isIdentity3x2},t.prototype.determinant=function(){if(!0===this._isIdentity)return 1;var l=this._m,y=l[0],v=l[1],m=l[2],g=l[3],b=l[4],C=l[5],w=l[6],O=l[7],x=l[8],A=l[9],S=l[10],E=l[11],T=l[12],R=l[13],I=l[14],P=l[15],M=S*P-I*E,z=A*P-R*E,D=A*I-R*S,F=x*P-T*E,N=x*I-S*T,U=x*R-T*A;return y*+(C*M-w*z+O*D)+v*-(b*M-w*F+O*N)+m*+(b*z-C*F+O*U)+g*-(b*D-C*N+w*U)},t.prototype.toArray=function(){return this._m},t.prototype.asArray=function(){return this._m},t.prototype.invert=function(){return this.invertToRef(this),this},t.prototype.reset=function(){return t.FromValuesToRef(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,this),this._updateIdentityStatus(!1),this},t.prototype.add=function(l){var y=new t;return this.addToRef(l,y),y},t.prototype.addToRef=function(l,y){for(var v=0;v<16;v++)y._m[v]=this._m[v]+l._m[v];return y._markAsUpdated(),this},t.prototype.addToSelf=function(l){for(var y=0;y<16;y++)this._m[y]+=l._m[y];return this._markAsUpdated(),this},t.prototype.invertToRef=function(l){if(!0===this._isIdentity)return t.IdentityToRef(l),this;var y=this._m,v=y[0],m=y[1],g=y[2],b=y[3],C=y[4],w=y[5],O=y[6],x=y[7],A=y[8],S=y[9],E=y[10],T=y[11],R=y[12],I=y[13],P=y[14],M=y[15],z=E*M-P*T,D=S*M-I*T,F=S*P-I*E,N=A*M-R*T,U=A*P-E*R,$=A*I-R*S,L=+(w*z-O*D+x*F),k=-(C*z-O*N+x*U),j=+(C*D-w*N+x*$),V=-(C*F-w*U+O*$),H=v*L+m*k+g*j+b*V;if(0===H)return l.copyFrom(this),this;var B=1/H,q=O*M-P*x,W=w*M-I*x,G=w*P-I*O,J=C*M-R*x,Y=C*P-R*O,X=C*I-R*w,Q=O*T-E*x,K=w*T-S*x,Z=w*E-S*O,tt=C*T-A*x,et=C*E-A*O,nt=C*S-A*w,ot=-(m*z-g*D+b*F),rt=+(v*z-g*N+b*U),it=-(v*D-m*N+b*$),st=+(v*F-m*U+g*$),at=+(m*q-g*W+b*G),ut=-(v*q-g*J+b*Y),ct=+(v*W-m*J+b*X),pt=-(v*G-m*Y+g*X),ht=-(m*Q-g*K+b*Z),lt=+(v*Q-g*tt+b*et),ft=-(v*K-m*tt+b*nt),dt=+(v*Z-m*et+g*nt);return t.FromValuesToRef(L*B,ot*B,at*B,ht*B,k*B,rt*B,ut*B,lt*B,j*B,it*B,ct*B,ft*B,V*B,st*B,pt*B,dt*B,l),this},t.prototype.addAtIndex=function(l,y){return this._m[l]+=y,this._markAsUpdated(),this},t.prototype.multiplyAtIndex=function(l,y){return this._m[l]*=y,this._markAsUpdated(),this},t.prototype.setTranslationFromFloats=function(l,y,v){return this._m[12]=l,this._m[13]=y,this._m[14]=v,this._markAsUpdated(),this},t.prototype.setTranslation=function(l){return this.setTranslationFromFloats(l.x,l.y,l.z)},t.prototype.getTranslation=function(){return new m.Vector3(this._m[12],this._m[13],this._m[14])},t.prototype.getTranslationToRef=function(l){return l.x=this._m[12],l.y=this._m[13],l.z=this._m[14],this},t.prototype.removeRotationAndScaling=function(){var l=this.m;return t.FromValuesToRef(1,0,0,0,0,1,0,0,0,0,1,0,l[12],l[13],l[14],l[15],this),this._updateIdentityStatus(0===l[12]&&0===l[13]&&0===l[14]&&1===l[15]),this},t.prototype.multiply=function(l){var y=new t;return this.multiplyToRef(l,y),y},t.prototype.copyFrom=function(l){l.copyToArray(this._m);var y=l;return this._updateIdentityStatus(y._isIdentity,y._isIdentityDirty,y._isIdentity3x2,y._isIdentity3x2Dirty),this},t.prototype.copyToArray=function(l,y){void 0===y&&(y=0);for(var v=0;v<16;v++)l[y+v]=this._m[v];return this},t.prototype.multiplyToRef=function(l,y){return this._isIdentity?(y.copyFrom(l),this):l._isIdentity?(y.copyFrom(this),this):(this.multiplyToArray(l,y._m,0),y._markAsUpdated(),this)},t.prototype.multiplyToArray=function(l,y,v){var m=this._m,g=l.m,b=m[0],C=m[1],w=m[2],O=m[3],x=m[4],A=m[5],S=m[6],E=m[7],T=m[8],R=m[9],I=m[10],P=m[11],M=m[12],z=m[13],D=m[14],F=m[15],N=g[0],U=g[1],$=g[2],L=g[3],k=g[4],j=g[5],V=g[6],H=g[7],B=g[8],q=g[9],W=g[10],G=g[11],J=g[12],Y=g[13],X=g[14],Q=g[15];return y[v]=b*N+C*k+w*B+O*J,y[v+1]=b*U+C*j+w*q+O*Y,y[v+2]=b*$+C*V+w*W+O*X,y[v+3]=b*L+C*H+w*G+O*Q,y[v+4]=x*N+A*k+S*B+E*J,y[v+5]=x*U+A*j+S*q+E*Y,y[v+6]=x*$+A*V+S*W+E*X,y[v+7]=x*L+A*H+S*G+E*Q,y[v+8]=T*N+R*k+I*B+P*J,y[v+9]=T*U+R*j+I*q+P*Y,y[v+10]=T*$+R*V+I*W+P*X,y[v+11]=T*L+R*H+I*G+P*Q,y[v+12]=M*N+z*k+D*B+F*J,y[v+13]=M*U+z*j+D*q+F*Y,y[v+14]=M*$+z*V+D*W+F*X,y[v+15]=M*L+z*H+D*G+F*Q,this},t.prototype.equals=function(l){var y=l;if(!y)return!1;if((this._isIdentity||y._isIdentity)&&!this._isIdentityDirty&&!y._isIdentityDirty)return this._isIdentity&&y._isIdentity;var v=this.m,m=y.m;return v[0]===m[0]&&v[1]===m[1]&&v[2]===m[2]&&v[3]===m[3]&&v[4]===m[4]&&v[5]===m[5]&&v[6]===m[6]&&v[7]===m[7]&&v[8]===m[8]&&v[9]===m[9]&&v[10]===m[10]&&v[11]===m[11]&&v[12]===m[12]&&v[13]===m[13]&&v[14]===m[14]&&v[15]===m[15]},t.prototype.clone=function(){var l=new t;return l.copyFrom(this),l},t.prototype.getClassName=function(){return"Matrix"},t.prototype.getHashCode=function(){for(var l=this._m[0]||0,y=1;y<16;y++)l=397*l^(this._m[y]||0);return l},t.prototype.decompose=function(l,y,v){if(this._isIdentity)return v&&v.setAll(0),l&&l.setAll(1),y&&y.copyFromFloats(0,0,0,1),!0;var m=this._m;v&&v.copyFromFloats(m[12],m[13],m[14]);var C=l||b.MathTmp.Vector3[0];if(C.x=Math.sqrt(m[0]*m[0]+m[1]*m[1]+m[2]*m[2]),C.y=Math.sqrt(m[4]*m[4]+m[5]*m[5]+m[6]*m[6]),C.z=Math.sqrt(m[8]*m[8]+m[9]*m[9]+m[10]*m[10]),this.determinant()<=0&&(C.y*=-1),0===C.x||0===C.y||0===C.z)return y&&y.copyFromFloats(0,0,0,1),!1;if(y){var w=1/C.x,O=1/C.y,x=1/C.z;t.FromValuesToRef(m[0]*w,m[1]*w,m[2]*w,0,m[4]*O,m[5]*O,m[6]*O,0,m[8]*x,m[9]*x,m[10]*x,0,0,0,0,1,b.MathTmp.Matrix[0]),g.Quaternion.FromRotationMatrixToRef(b.MathTmp.Matrix[0],y)}return!0},t.prototype.getRow=function(l){if(l<0||l>3)return null;var y=4*l;return new C.Vector4(this._m[y+0],this._m[y+1],this._m[y+2],this._m[y+3])},t.prototype.setRow=function(l,y){return this.setRowFromFloats(l,y.x,y.y,y.z,y.w)},t.prototype.transpose=function(){return t.Transpose(this)},t.prototype.transposeToRef=function(l){return t.TransposeToRef(this,l),this},t.prototype.setRowFromFloats=function(l,y,v,m,g){if(l<0||l>3)return this;var b=4*l;return this._m[b+0]=y,this._m[b+1]=v,this._m[b+2]=m,this._m[b+3]=g,this._markAsUpdated(),this},t.prototype.scale=function(l){var y=new t;return this.scaleToRef(l,y),y},t.prototype.scaleToRef=function(l,y){for(var v=0;v<16;v++)y._m[v]=this._m[v]*l;return y._markAsUpdated(),this},t.prototype.scaleAndAddToRef=function(l,y){for(var v=0;v<16;v++)y._m[v]+=this._m[v]*l;return y._markAsUpdated(),this},t.prototype.toNormalMatrix=function(l){var y=b.MathTmp.Matrix[0];this.invertToRef(y),y.transposeToRef(l);var v=l._m;t.FromValuesToRef(v[0],v[1],v[2],0,v[4],v[5],v[6],0,v[8],v[9],v[10],0,0,0,0,1,l)},t.prototype.getRotationMatrix=function(){var l=new t;return this.getRotationMatrixToRef(l),l},t.prototype.getRotationMatrixToRef=function(l){var y=b.MathTmp.Vector3[0];if(!this.decompose(y))return t.IdentityToRef(l),this;var v=this._m,m=1/y.x,g=1/y.y,C=1/y.z;return t.FromValuesToRef(v[0]*m,v[1]*m,v[2]*m,0,v[4]*g,v[5]*g,v[6]*g,0,v[8]*C,v[9]*C,v[10]*C,0,0,0,0,1,l),this},t.prototype.toggleModelMatrixHandInPlace=function(){var l=this._m;l[2]*=-1,l[6]*=-1,l[8]*=-1,l[9]*=-1,l[14]*=-1,this._markAsUpdated()},t.prototype.toggleProjectionMatrixHandInPlace=function(){var l=this._m;l[8]*=-1,l[9]*=-1,l[10]*=-1,l[11]*=-1,this._markAsUpdated()},t.prototype._updateIdentityStatus=function(l,y,v,m){void 0===y&&(y=!1),void 0===v&&(v=!1),void 0===m&&(m=!0),this.updateFlag=t._updateFlagSeed++,this._isIdentity=l,this._isIdentity3x2=l||v,this._isIdentityDirty=!this._isIdentity&&y,this._isIdentity3x2Dirty=!this._isIdentity3x2&&m},t._updateFlagSeed=0,t._identityReadOnly=t.Identity(),t}();y.Matrix=w},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Entity=void 0;var m=v(0),g=v(7),b=v(1),C=function(){function t(l){this.name=l,this.children={},this.eventManager=null,this.alive=!1,this.uuid=b.newId("E"),this.components={},this.engine=null,this._parent=null}return t.prototype.addComponentOrReplace=function(l){if("function"==typeof l)throw new Error("You passed a function or class as a component, an instance of component is expected");if("object"!=typeof l)throw new Error("You passed a "+typeof l+", an instance of component is expected");var y=m.getComponentName(l);if(this.components[y]){if(this.components[y]===l)return l;this.removeComponent(this.components[y],!1)}return this.addComponent(l)},t.prototype.hasComponent=function(l){var y=typeof l;if("string"!==y&&"object"!==y&&"function"!==y)throw new Error("Entity#has(component): component is not a class, name or instance");if(null==l)return!1;var v="string"===y?l:m.getComponentName(l),g=this.components[v];return!!g&&("object"===y?g===l:"function"!==y||g instanceof l)},t.prototype.getComponent=function(l){var y=typeof l;if("string"!==y&&"function"!==y)throw new Error("Entity#get(component): component is not a class or name");var v="string"===y?l:m.getComponentName(l),g=this.components[v];if(!g)throw new Error('Can not get component "'+v+'" from entity "'+this.identifier+'"');if("function"===y){if(g instanceof l)return g;throw new Error('Can not get component "'+v+'" from entity "'+this.identifier+'" (by instance)')}return g},t.prototype.getComponentOrNull=function(l){var y=typeof l;if("string"!==y&&"function"!==y)throw new Error("Entity#getOrNull(component): component is not a class or name");var v="string"===y?l:m.getComponentName(l),g=this.components[v];return g?"function"===y?g instanceof l?g:null:g:null},t.prototype.getComponentOrCreate=function(l){if("function"!=typeof l)throw new Error("Entity#getOrCreate(component): component is not a class");var y=this.getComponentOrNull(l);return y||(y=new l,m.getComponentName(y),this.addComponentOrReplace(y)),y},t.prototype.addComponent=function(l){if("object"!=typeof l)throw new Error("Entity#add(component): You passed a function or class as a component, an instance of component is expected");var y=m.getComponentName(l),v=m.getComponentClassId(l);if(this.components[y])throw new Error('A component of type "'+y+'" is already present in entity "'+this.identifier+'"');this.components[y]=l,this.eventManager&&this.eventManager.fireEvent(new g.ComponentAdded(this,y,v));var b=l;return"function"==typeof b.addedToEntity&&b.addedToEntity(this),l},t.prototype.removeComponent=function(l,y){void 0===y&&(y=!0);var v=typeof l;if("string"!==v&&"function"!==v&&"object"!==v)throw new Error("Entity#remove(component): component is not a class, class or name");var C="string"===v?l:m.getComponentName(l),w=this.components[C];if(w){if("function"===v)return w instanceof l?(delete this.components[C],void(w&&(y&&this.eventManager&&this.eventManager.fireEvent(new g.ComponentRemoved(this,C,w)),"function"==typeof w.removedFromEntity&&w.removedFromEntity(this)))):void b.log('Entity Warning: Trying to remove wrong (by constructor) component "'+C+'" from entity "'+this.identifier+'"');delete this.components[C],w&&(y&&this.eventManager&&this.eventManager.fireEvent(new g.ComponentRemoved(this,C,w)),"function"==typeof w.removedFromEntity&&w.removedFromEntity(this))}else b.log('Entity Warning: Trying to remove inexisting component "'+C+'" from entity "'+this.identifier+'"')},t.prototype.isAddedToEngine=function(){return!(!this.engine||!(this.uuid in this.engine.entities)&&this.engine.rootEntity!==this)},t.prototype.setParent=function(l){var y;if(l&&"getEntityRepresentation"in l){if(!this.engine)throw new Error("In order to set an attachable as parent, you first need to add the entity to the engine.");y=l.getEntityRepresentation(this.engine)}else y=!l&&this.engine?this.engine.rootEntity:l;var v=this.getParent();if(y===this)throw new Error('Failed to set parent for entity "'+this.identifier+"\": An entity can't set itself as a its own parent");if(y===v)return this;var m=this.getCircularAncestor(y);if(m)throw new Error('Failed to set parent for entity "'+this.identifier+'": Circular parent references are not allowed (See entity "'+m+'")');return v&&delete v.children[this.uuid],null!==y&&"0"!==y.uuid&&(!y.isAddedToEngine()&&this.isAddedToEngine()&&this.engine.removeEntity(this),y.isAddedToEngine()&&!this.isAddedToEngine()&&y.engine.addEntity(this)),this._parent=y||null,this.registerAsChild(),this.eventManager&&this.engine&&this.eventManager.fireEvent(new g.ParentChanged(this,y)),this},t.prototype.getParent=function(){return this._parent},Object.defineProperty(t.prototype,"identifier",{get:function(){return this.name||this.uuid},enumerable:!1,configurable:!0}),t.prototype.getCircularAncestor=function(l){for(var y=this.engine?this.engine.rootEntity:null,v=l;v&&v!==y;){var m=v.getParent();if(m===this)return v.uuid;v=m}return null},t.prototype.registerAsChild=function(){var l=this.getParent();this.uuid&&l&&(l.children[this.uuid]=this)},t}();y.Entity=C},function(l,y,v){"use strict";var m=this&&this.__awaiter||function(l,y,v,m){return new(v||(v=Promise))((function(g,b){function s(l){try{p(m.next(l))}catch(l){b(l)}}function a(l){try{p(m.throw(l))}catch(l){b(l)}}function p(l){var y;l.done?g(l.value):(y=l.value,y instanceof v?y:new v((function(l){l(y)}))).then(s,a)}p((m=m.apply(l,y||[])).next())}))},g=this&&this.__generator||function(l,y){var v,m,g,b,C={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return b={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function a(b){return function(w){return function(b){if(v)throw new TypeError("Generator is already executing.");for(;C;)try{if(v=1,m&&(g=2&b[0]?m.return:b[0]?m.throw||((g=m.return)&&g.call(m),0):m.next)&&!(g=g.call(m,b[1])).done)return g;switch(m=0,g&&(b=[2&b[0],g.value]),b[0]){case 0:case 1:g=b;break;case 4:return C.label++,{value:b[1],done:!1};case 5:C.label++,m=b[1],b=[0];continue;case 7:b=C.ops.pop(),C.trys.pop();continue;default:if(!((g=(g=C.trys).length>0&&g[g.length-1])||6!==b[0]&&2!==b[0])){C=0;continue}if(3===b[0]&&(!g||b[1]>g[0]&&b[1]<g[3])){C.label=b[1];break}if(6===b[0]&&C.label<g[1]){C.label=g[1],g=b;break}if(g&&C.label<g[2]){C.label=g[2],C.ops.push(b);break}g[2]&&C.ops.pop(),C.trys.pop();continue}b=y.call(l,C)}catch(l){b=[6,l],m=0}finally{v=g=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,w])}}},b=this&&this.__values||function(l){var y="function"==typeof Symbol&&Symbol.iterator,v=y&&l[y],m=0;if(v)return v.call(l);if(l&&"number"==typeof l.length)return{next:function(){return l&&m>=l.length&&(l=void 0),{value:l&&l[m++],done:!l}}};throw new TypeError(y?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(y,"__esModule",{value:!0}),y.Observable=y.MultiObserver=y.Observer=y.ObserverEventState=void 0;var C=v(22),w=function(){function t(l,y,v,m){void 0===y&&(y=!1),this.initalize(l,y,v,m)}return t.prototype.initalize=function(l,y,v,m){return void 0===y&&(y=!1),this.mask=l,this.skipNextObservers=y,this.target=v,this.currentTarget=m,this},t}();y.ObserverEventState=w;var p=function(l,y,v){void 0===v&&(v=null),this.callback=l,this.mask=y,this.scope=v,this.unregisterOnNextCall=!1,this._willBeUnregistered=!1};y.Observer=p;var O=function(){function t(){this._observers=null,this._observables=null}return t.Watch=function(l,y,v,m){var g,C;void 0===v&&(v=-1),void 0===m&&(m=null);var w=new t;w._observers=new Array,w._observables=l;try{for(var O=b(l),x=O.next();!x.done;x=O.next()){var A=x.value.add(y,v,!1,m);A&&w._observers.push(A)}}catch(l){g={error:l}}finally{try{x&&!x.done&&(C=O.return)&&C.call(O)}finally{if(g)throw g.error}}return w},t.prototype.dispose=function(){if(this._observers&&this._observables)for(var l=0;l<this._observers.length;l++)this._observables[l].remove(this._observers[l]);this._observers=null,this._observables=null},t}();y.MultiObserver=O;var x=function(){function t(l){this._observers=new Array,this._onObserverAdded=null,this._eventState=new w(0),l&&(this._onObserverAdded=l)}return t.prototype.add=function(l,y,v,m,g){if(void 0===y&&(y=-1),void 0===v&&(v=!1),void 0===m&&(m=null),void 0===g&&(g=!1),!l)return null;var b=new p(l,y,m);return b.unregisterOnNextCall=g,v?this._observers.unshift(b):this._observers.push(b),this._onObserverAdded&&this._onObserverAdded(b),b},t.prototype.addOnce=function(l){return this.add(l,void 0,void 0,void 0,!0)},t.prototype.remove=function(l){return!!l&&-1!==this._observers.indexOf(l)&&(this._deferUnregister(l),!0)},t.prototype.removeCallback=function(l,y){for(var v=0;v<this._observers.length;v++)if(this._observers[v].callback===l&&(!y||y===this._observers[v].scope))return this._deferUnregister(this._observers[v]),!0;return!1},t.prototype.notifyObservers=function(l,y,v,m){var g,C;if(void 0===y&&(y=-1),!this._observers.length)return!0;var w=this._eventState;w.mask=y,w.target=v,w.currentTarget=m,w.skipNextObservers=!1,w.lastReturnValue=l;try{for(var O=b(this._observers),x=O.next();!x.done;x=O.next()){var A=x.value;if(!A._willBeUnregistered&&(A.mask&y&&(A.scope?w.lastReturnValue=A.callback.apply(A.scope,[l,w]):w.lastReturnValue=A.callback(l,w),A.unregisterOnNextCall&&this._deferUnregister(A)),w.skipNextObservers))return!1}}catch(l){g={error:l}}finally{try{x&&!x.done&&(C=O.return)&&C.call(O)}finally{if(g)throw g.error}}return!0},t.prototype.notifyObserversWithPromise=function(l,y,v,m){var g=this;void 0===y&&(y=-1);var b=Promise.resolve(l);if(!this._observers.length)return b;var C=this._eventState;return C.mask=y,C.target=v,C.currentTarget=m,C.skipNextObservers=!1,this._observers.forEach((function(v){C.skipNextObservers||v._willBeUnregistered||v.mask&y&&(b=v.scope?b.then((function(y){return C.lastReturnValue=y,v.callback.apply(v.scope,[l,C])})):b.then((function(y){return C.lastReturnValue=y,v.callback(l,C)})),v.unregisterOnNextCall&&g._deferUnregister(v))})),b.then((function(){return l}))},t.prototype.notifyObserver=function(l,y,v){void 0===v&&(v=-1);var m=this._eventState;m.mask=v,m.skipNextObservers=!1,l.callback(y,m)},t.prototype.hasObservers=function(){return this._observers.length>0},t.prototype.clear=function(){this._observers=new Array,this._onObserverAdded=null},t.prototype.clone=function(){var l=new t;return l._observers=this._observers.slice(0),l},t.prototype.hasSpecificMask=function(l){var y,v;void 0===l&&(l=-1);try{for(var m=b(this._observers),g=m.next();!g.done;g=m.next()){var C=g.value;if(C.mask&l||C.mask===l)return!0}}catch(l){y={error:l}}finally{try{g&&!g.done&&(v=m.return)&&v.call(m)}finally{if(y)throw y.error}}return!1},t.prototype._deferUnregister=function(l){var y=this;l.unregisterOnNextCall=!1,l._willBeUnregistered=!0,C.executeTask((function(){return m(y,void 0,void 0,(function(){return g(this,(function(y){return[2,this._remove(l)]}))}))}))},t.prototype._remove=function(l){if(!l)return!1;var y=this._observers.indexOf(l);return-1!==y&&(this._observers.splice(y,1),!0)},t}();y.Observable=x},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.uuidEventSystem=y.UUIDEventSystem=y.pointerEventSystem=y.PointerEventSystem=y.raycastEventSystem=y.RaycastEventSystem=void 0;var m=v(10),g=v(5),b=v(7),C=v(18),w=v(29),O=function(){function t(){}return t.prototype.activate=function(l){l.eventManager.addListener(m.RaycastResponse,this,(function(l){"HitFirst"===l.payload.queryType?w.PhysicsCast.instance.handleRaycastHitFirstResponse(l):"HitAll"===l.payload.queryType&&w.PhysicsCast.instance.handleRaycastHitAllResponse(l)})),"undefined"!=typeof dcl&&dcl.subscribe("raycastResponse")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("raycastResponse")},t}();y.RaycastEventSystem=O,y.raycastEventSystem=new O;var x=function(){function t(){}return t.prototype.activate=function(l){l.eventManager.addListener(m.PointerEvent,this,(function(l){C.Input.instance.handlePointerEvent(l.payload)})),"undefined"!=typeof dcl&&(dcl.subscribe("pointerUp"),dcl.subscribe("pointerDown"),dcl.subscribe("pointerEvent"))},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&(dcl.unsubscribe("pointerUp"),dcl.unsubscribe("pointerDown"),dcl.unsubscribe("pointerEvent"))},t}();y.PointerEventSystem=x,y.pointerEventSystem=new x;var A=function(){function t(){this.handlerMap={}}return t.prototype.activate=function(l){l.eventManager.addListener(m.UUIDEvent,this,this.handleEvent),l.eventManager.addListener(b.ComponentAdded,this,this.componentAdded),l.eventManager.addListener(b.ComponentRemoved,this,this.componentRemoved),"undefined"!=typeof dcl&&dcl.subscribe("uuidEvent")},t.prototype.deactivate=function(){"undefined"!=typeof dcl&&dcl.unsubscribe("uuidEvent")},t.prototype.onAddEntity=function(l){for(var y in l.components){var v=l.components[y];v instanceof g.OnUUIDEvent&&(this.handlerMap[v.uuid]=v)}},t.prototype.onRemoveEntity=function(l){for(var y in l.components){var v=l.components[y];v instanceof g.OnUUIDEvent&&delete this.handlerMap[v.uuid]}},t.prototype.componentAdded=function(l){if(l.entity.isAddedToEngine()){var y=l.entity.components[l.componentName];y instanceof g.OnUUIDEvent&&(this.handlerMap[y.uuid]=y)}},t.prototype.componentRemoved=function(l){l.entity.isAddedToEngine()&&l.component instanceof g.OnUUIDEvent&&delete this.handlerMap[l.component.uuid]},t.prototype.handleEvent=function(l){if(l.uuid in this.handlerMap){var y=this.handlerMap[l.uuid];y&&y.callback&&"call"in y.callback&&y.callback(l.payload)}},t}();y.UUIDEventSystem=A,y.uuidEventSystem=new A},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Vector2=void 0;var m=v(2),g=v(4),b=function(){function t(l,y){void 0===l&&(l=0),void 0===y&&(y=0),this.x=l,this.y=y}return t.Zero=function(){return new t(0,0)},t.One=function(){return new t(1,1)},t.Add=function(l,y){return new t(l.x,l.y).addInPlace(y)},t.FromArray=function(l,y){return void 0===y&&(y=0),new t(l[y],l[y+1])},t.FromArrayToRef=function(l,y,v){v.x=l[y],v.y=l[y+1]},t.CatmullRom=function(l,y,v,m,g){var b=g*g,C=g*b;return new t(.5*(2*y.x+(-l.x+v.x)*g+(2*l.x-5*y.x+4*v.x-m.x)*b+(-l.x+3*y.x-3*v.x+m.x)*C),.5*(2*y.y+(-l.y+v.y)*g+(2*l.y-5*y.y+4*v.y-m.y)*b+(-l.y+3*y.y-3*v.y+m.y)*C))},t.Clamp=function(l,y,v){var m=l.x;m=(m=m>v.x?v.x:m)<y.x?y.x:m;var g=l.y;return new t(m,g=(g=g>v.y?v.y:g)<y.y?y.y:g)},t.Hermite=function(l,y,v,m,g){var b=g*g,C=g*b,w=2*C-3*b+1,O=-2*C+3*b,x=C-2*b+g,A=C-b;return new t(l.x*w+v.x*O+y.x*x+m.x*A,l.y*w+v.y*O+y.y*x+m.y*A)},t.Lerp=function(l,y,v){return new t(l.x+(y.x-l.x)*v,l.y+(y.y-l.y)*v)},t.Dot=function(l,y){return l.x*y.x+l.y*y.y},t.Normalize=function(l){var y=new t(l.x,l.y);return y.normalize(),y},t.Minimize=function(l,y){return new t(l.x<y.x?l.x:y.x,l.y<y.y?l.y:y.y)},t.Maximize=function(l,y){return new t(l.x>y.x?l.x:y.x,l.y>y.y?l.y:y.y)},t.Transform=function(l,y){var v=t.Zero();return t.TransformToRef(l,y,v),v},t.TransformToRef=function(l,y,v){var m=y.m,g=l.x*m[0]+l.y*m[4]+m[12],b=l.x*m[1]+l.y*m[5]+m[13];v.x=g,v.y=b},t.PointInTriangle=function(l,y,v,m){var g=.5*(-v.y*m.x+y.y*(-v.x+m.x)+y.x*(v.y-m.y)+v.x*m.y),b=g<0?-1:1,C=(y.y*m.x-y.x*m.y+(m.y-y.y)*l.x+(y.x-m.x)*l.y)*b,w=(y.x*v.y-y.y*v.x+(y.y-v.y)*l.x+(v.x-y.x)*l.y)*b;return C>0&&w>0&&C+w<2*g*b},t.Distance=function(l,y){return Math.sqrt(t.DistanceSquared(l,y))},t.DistanceSquared=function(l,y){var v=l.x-y.x,m=l.y-y.y;return v*v+m*m},t.Center=function(l,y){var v=t.Add(l,y);return v.scaleInPlace(.5),v},t.DistanceOfPointFromSegment=function(l,y,v){var m=t.DistanceSquared(y,v);if(0===m)return t.Distance(l,y);var g=v.subtract(y),b=Math.max(0,Math.min(1,t.Dot(l.subtract(y),g)/m)),C=y.add(g.multiplyByFloats(b,b));return t.Distance(l,C)},t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+"}"},t.prototype.getClassName=function(){return"Vector2"},t.prototype.getHashCode=function(){return 397*(this.x||0)^(this.y||0)},t.prototype.toArray=function(l,y){return void 0===y&&(y=0),l[y]=this.x,l[y+1]=this.y,this},t.prototype.asArray=function(){var l=new Array;return this.toArray(l,0),l},t.prototype.copyFrom=function(l){return this.x=l.x,this.y=l.y,this},t.prototype.copyFromFloats=function(l,y){return this.x=l,this.y=y,this},t.prototype.set=function(l,y){return this.copyFromFloats(l,y)},t.prototype.add=function(l){return new t(this.x+l.x,this.y+l.y)},t.prototype.addToRef=function(l,y){return y.x=this.x+l.x,y.y=this.y+l.y,this},t.prototype.addInPlace=function(l){return this.x+=l.x,this.y+=l.y,this},t.prototype.addVector3=function(l){return new t(this.x+l.x,this.y+l.y)},t.prototype.subtract=function(l){return new t(this.x-l.x,this.y-l.y)},t.prototype.subtractToRef=function(l,y){return y.x=this.x-l.x,y.y=this.y-l.y,this},t.prototype.subtractInPlace=function(l){return this.x-=l.x,this.y-=l.y,this},t.prototype.multiplyInPlace=function(l){return this.x*=l.x,this.y*=l.y,this},t.prototype.multiply=function(l){return new t(this.x*l.x,this.y*l.y)},t.prototype.multiplyToRef=function(l,y){return y.x=this.x*l.x,y.y=this.y*l.y,this},t.prototype.multiplyByFloats=function(l,y){return new t(this.x*l,this.y*y)},t.prototype.divide=function(l){return new t(this.x/l.x,this.y/l.y)},t.prototype.divideToRef=function(l,y){return y.x=this.x/l.x,y.y=this.y/l.y,this},t.prototype.divideInPlace=function(l){return this.divideToRef(l,this)},t.prototype.negate=function(){return new t(-this.x,-this.y)},t.prototype.scaleInPlace=function(l){return this.x*=l,this.y*=l,this},t.prototype.scale=function(l){var y=new t(0,0);return this.scaleToRef(l,y),y},t.prototype.scaleToRef=function(l,y){return y.x=this.x*l,y.y=this.y*l,this},t.prototype.scaleAndAddToRef=function(l,y){return y.x+=this.x*l,y.y+=this.y*l,this},t.prototype.equals=function(l){return l&&this.x===l.x&&this.y===l.y},t.prototype.equalsWithEpsilon=function(l,y){return void 0===y&&(y=m.Epsilon),l&&g.Scalar.WithinEpsilon(this.x,l.x,y)&&g.Scalar.WithinEpsilon(this.y,l.y,y)},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.normalize=function(){var l=this.length();if(0===l)return this;var y=1/l;return this.x*=y,this.y*=y,this},t.prototype.clone=function(){return new t(this.x,this.y)},t}();y.Vector2=b},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__assign||function(){return(b=Object.assign||function(l){for(var y,v=1,m=arguments.length;v<m;v++)for(var g in y=arguments[v])Object.prototype.hasOwnProperty.call(y,g)&&(l[g]=y[g]);return l}).apply(this,arguments)},C=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.Input=y.GlobalPointerUp=y.GlobalPointerDown=y.PointerEventComponent=y.ActionButton=void 0;var w,O=v(11),x=v(6),A=v(0);!function(l){l.POINTER="POINTER",l.PRIMARY="PRIMARY",l.SECONDARY="SECONDARY",l.ANY="ANY"}(w=y.ActionButton||(y.ActionButton={}));var c=function(l){if(this.callback=l,!l||!("apply"in l)||!("call"in l))throw new Error("Callback is not a function");T.ensureInstance()};y.PointerEventComponent=c;var S=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}return g(e,l),C([A.Component("pointerDown")],e)}(c);y.GlobalPointerDown=S;var E=function(l){function e(){return null!==l&&l.apply(this,arguments)||this}return g(e,l),C([A.Component("pointerUp")],e)}(c);y.GlobalPointerUp=E;var f=function(l,y){this.fn=l,this.useRaycast=y},T=function(){function t(){var l,y;this.subscriptions=((l={})[w.POINTER]={BUTTON_DOWN:[],BUTTON_UP:[]},l[w.PRIMARY]={BUTTON_DOWN:[],BUTTON_UP:[]},l[w.SECONDARY]={BUTTON_DOWN:[],BUTTON_UP:[]},l[w.ANY]={BUTTON_DOWN:[],BUTTON_UP:[]},l),this.internalState=((y={})[w.POINTER]={BUTTON_DOWN:!1},y[w.PRIMARY]={BUTTON_DOWN:!1},y[w.SECONDARY]={BUTTON_DOWN:!1},y[w.ANY]={BUTTON_DOWN:!1},y)}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.isButtonPressed=function(l){return this.internalState[l]},t.prototype.subscribe=function(l,y,v,m){var g=this;return this.subscriptions[y][l].push(new f(m,v)),function(){return g.unsubscribe(l,y,m)}},t.prototype.unsubscribe=function(l,y,v){var m=this.getSubscriptionId(l,y,v);return m>-1&&this.subscriptions[y][l].splice(m,1)},t.prototype.handlePointerEvent=function(l){var y=this.getPointerById(l.buttonId),v=b(b({},l),{button:y,direction:(new x.Vector3).copyFrom(l.direction),origin:(new x.Vector3).copyFrom(l.origin),hit:void 0}),m=l.hit?b(b({},l.hit),{hitPoint:(new x.Vector3).copyFrom(l.hit.hitPoint),normal:(new x.Vector3).copyFrom(l.hit.normal),worldNormal:(new x.Vector3).copyFrom(l.hit.worldNormal)}):void 0;if(l.type===O.InputEventType.DOWN){this.internalState[y].BUTTON_DOWN=!0;for(var g=0;g<this.subscriptions[y].BUTTON_DOWN.length;g++)(C=this.subscriptions[y].BUTTON_DOWN[g]).useRaycast?v.hit=m:v.hit=void 0,C.fn(v);m&&m.entityId&&A.DisposableComponent.engine&&(T=(w=A.DisposableComponent.engine.entities[m.entityId])&&w.getComponentOrNull(S))&&(v.hit=m,T.callback(v))}else{for(this.internalState[y].BUTTON_DOWN=!1,g=0;g<this.subscriptions[y].BUTTON_UP.length;g++){var C;(C=this.subscriptions[y].BUTTON_UP[g]).useRaycast?v.hit=m:v.hit=void 0,C.fn(v)}var w,T;m&&m.entityId&&A.DisposableComponent.engine&&(T=(w=A.DisposableComponent.engine.entities[m.entityId])&&w.getComponentOrNull(E))&&(v.hit=m,T.callback(v))}},t.prototype.getSubscriptionId=function(l,y,v){for(var m=0;m<this.subscriptions[y][l].length;m++)if(this.subscriptions[y][l][m].fn===v)return m;return-1},t.prototype.getPointerById=function(l){return 0===l?w.POINTER:1===l?w.PRIMARY:w.SECONDARY},t}();y.Input=T},function(l,y,v){"use strict";var m=this&&this.__read||function(l,y){var v="function"==typeof Symbol&&l[Symbol.iterator];if(!v)return l;var m,g,b=v.call(l),C=[];try{for(;(void 0===y||y-- >0)&&!(m=b.next()).done;)C.push(m.value)}catch(l){g={error:l}}finally{try{m&&!m.done&&(v=b.return)&&v.call(b)}finally{if(g)throw g.error}}return C},g=this&&this.__spread||function(){for(var l=[],y=0;y<arguments.length;y++)l=l.concat(m(arguments[y]));return l};Object.defineProperty(y,"__esModule",{value:!0}),y.Engine=void 0;var b=v(7),C=v(0),w=v(8),O=v(21),x=v(1),A=v(14),S=function(){function t(l){this.eventManager=new w.EventManager,this.systems=[],this.entityLists={},this.addedSystems=[],this._entities={},this._disposableComponents={},this._componentGroups={},this.simpleSystems=[],this.eventManager.addListener(b.ComponentAdded,this,this.componentAddedHandler),this.eventManager.addListener(b.ComponentRemoved,this,this.componentRemovedHandler),this.rootEntity=l,this.firstPersonCameraEntity=new A.Entity,this.firstPersonCameraEntity.uuid="FirstPersonCameraEntityReference",this.addEntity(this.firstPersonCameraEntity),this.avatarEntity=new A.Entity,this.avatarEntity.uuid="AvatarEntityReference",this.addEntity(this.avatarEntity)}return Object.defineProperty(t.prototype,"entities",{get:function(){return this._entities},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"disposableComponents",{get:function(){return this._disposableComponents},enumerable:!1,configurable:!0}),t.prototype.addEntity=function(l){var y=l.getParent();if(l.isAddedToEngine())return l;for(var v in l.eventManager=this.eventManager,l.engine=this,this._entities[l.uuid]=l,this.checkRequirementsAndAdd(l),y?y.isAddedToEngine()||y===this.rootEntity||x.log("Engine: warning, added an entity with a parent not present in the engine. Parent id: "+y.uuid):l.setParent(this.rootEntity),l.alive=!0,l.children){var m=l.children[v];m&&(m.isAddedToEngine()||this.addEntity(m))}return l},t.prototype.removeEntity=function(l){var y=l.uuid;if(l.isAddedToEngine()){for(var v in l.components){var m=this._componentGroups[v];if(m)for(var g in m)m[g].removeEntity(l);delete this.entityLists[v][y]}for(var b=0;b<this.simpleSystems.length;b++){var C=this.simpleSystems[b];C.onRemoveEntity&&C.onRemoveEntity(l)}for(var b in l.children){var w=l.children[b];w&&this.removeEntity(w)}return l.alive=!1,l.eventManager=null,delete this._entities[y],!0}for(var v in x.log("Engine: Trying to remove non existent entity from engine."),l.isAddedToEngine()?x.log("Engine: Entity id: "+y):x.log('Engine: Entity "'+l.uuid+'" has not been added to any engine yet.'),x.log("Engine: Entity's components:"),l.components)x.log(v);return!1},t.prototype.addSystem=function(l,y){if(void 0===y&&(y=0),-1!==this.addedSystems.indexOf(l))return x.log("Engine: Trying to add a system that is already added. Aborting"),l;if(this.systems.length>0)for(var v=0;v<this.systems.length;v++){var m=this.systems[v],g=v===this.systems.length-1;if(m.priority>y){this.addedSystems.push(l),this.systems.splice(v,0,{system:l,priority:y});break}if(g){this.addedSystems.push(l),this.systems.splice(v+1,0,{system:l,priority:y});break}}else this.addedSystems.push(l),this.systems.splice(1,0,{system:l,priority:y});return this.registerSystem(l),l},t.prototype.removeSystem=function(l){var y=this.addedSystems.indexOf(l);if(-1!==y){l.active=!1,l.deactivate&&l.deactivate(),this.addedSystems.splice(y,1);for(var v=0;v<this.systems.length;v++)this.systems[v].system===l&&this.systems.splice(v,1);return!0}return!1},t.prototype.update=function(l){for(var y in this.systems){var v=this.systems[y].system;if(v.active&&v.update)try{v.update(l)}catch(l){x.error(l)}}return this},t.prototype.getEntitiesWithComponent=function(l){var y="string"==typeof l?l:C.getComponentName(l);return y in this.entityLists?this.entityLists[y]:this.entityLists[y]={}},t.prototype.registerComponent=function(l){var y=C.getComponentId(l),v=C.getComponentName(l),m=C.getComponentClassId(l);this._disposableComponents[y]=l,null!==m&&(this.eventManager.fireEvent(new C.DisposableComponentCreated(y,v,m)),this.eventManager.fireEvent(new C.DisposableComponentUpdated(y,l)))},t.prototype.disposeComponent=function(l){var y=C.getComponentId(l);return delete this._disposableComponents[y]&&(this.eventManager.fireEvent(new C.DisposableComponentRemoved(y)),l.onDispose&&l.onDispose(),!0)},t.prototype.updateComponent=function(l){this.eventManager.fireEvent(new C.DisposableComponentUpdated(C.getComponentId(l),l))},t.prototype.getComponentGroup=function(){for(var l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];var v=void 0;if(l.length>0&&(S=this._componentGroups[C.getComponentName(l[0])]))for(var m=l.slice(),b=0;b<S.length;b++){var w=S[b];if(m.length===w.requires.length){for(var x=0;x<m.length&&-1!==w.requires.indexOf(m[x]);x++)x===m.length-1&&(v=w);if(v)break}}if(v)return v;(v=new(O.ComponentGroup.bind.apply(O.ComponentGroup,g([void 0],l)))).active=!0;var A=v.requiresNames;for(b=0;b<A.length;b++){var S,E=A[b];(S=this._componentGroups[E])||(this._componentGroups[E]=S=[]),-1===S.indexOf(v)&&S.push(v)}for(var T in this._entities)this.checkRequirements(this._entities[T],v);return v},t.prototype.removeComponentGroup=function(l){if(l.active){l.active=!1;for(var y=l.requiresNames,v=0;v<y.length;v++){var m=y[v],g=this._componentGroups[m];if(g){var b=g.indexOf(l);-1!==b&&g.splice(b,1)}}return!0}return!1},t.prototype.registerSystem=function(l){l.active=!0,l.activate&&l.activate(this),this.simpleSystems.push(l)},t.prototype.checkRequirementsAndAdd=function(l){if(l.isAddedToEngine()){for(var y in l.components){y in this.entityLists||(this.entityLists[y]={}),this.entityLists[y][l.uuid]=l;var v=this._componentGroups[y];if(v)for(var m in v)this.checkRequirements(l,v[m])}for(var g=0;g<this.simpleSystems.length;g++){var b=this.simpleSystems[g];b.onAddEntity&&b.onAddEntity(l)}}},t.prototype.checkRequirements=function(l,y){y.meetsRequirements(l)?y.hasEntity(l)||y.addEntity(l):y.hasEntity(l)&&y.removeEntity(l)},t.prototype.componentAddedHandler=function(l){var y,v=l.entity,m=l.componentName;if(v.isAddedToEngine()){this.entityLists[m]?this.entityLists[m][v.uuid]=v:this.entityLists[m]=((y={})[v.uuid]=v,y);var g=this._componentGroups[m];if(g)for(var b in g)this.checkRequirements(v,g[b])}},t.prototype.componentRemovedHandler=function(l){var y=l.entity,v=l.componentName;if(y.isAddedToEngine()){delete this.entityLists[v][y.uuid];var m=this._componentGroups[v];if(m)for(var g in m)this.checkRequirements(y,m[g])}},t}();y.Engine=S},function(l,y,v){"use strict";var m;Object.defineProperty(y,"__esModule",{value:!0}),y.UIValue=y.UIValueType=void 0,function(l){l[l.PERCENT=0]="PERCENT",l[l.PIXELS=1]="PIXELS"}(m=y.UIValueType||(y.UIValueType={}));var g=function(){function t(l){if(this.type=m.PIXELS,"string"==typeof l){var y=l;y.indexOf("px")>-1?this.type=m.PIXELS:y.indexOf("%")>-1&&(this.type=m.PERCENT),this.value=parseFloat(y)}else this.value=l}return t.prototype.toString=function(){var l=this.value.toString();return this.type===m.PERCENT?l+="%":l+="px",l},t}();y.UIValue=g},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.ComponentGroup=void 0;var m=v(0),g=function(){function t(){for(var l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];if(this.entities=[],this.active=!1,this._requiresNames=[],!l)throw new Error("ComponentGroup: Could not load the requires list");if(!(l instanceof Array))throw new Error("ComponentGroup: requires list is not an Array");Object.defineProperty(this,"requires",{get:function(){return l.slice()}}),Object.defineProperty(this,"requiresNames",{get:function(){return this._requiresNames.slice()}});for(var n=function(y){var g=l[y],b=null;if(!g)throw new Error("ComponentGroup: the required component at location "+y+" is invalid");try{b=m.getComponentName(g)}catch(l){throw new Error("ComponentGroup: the required component at location "+y+" is not registered as a @Component. Remember to provide the class of the component, not the name")}if(v._requiresNames.some((function(l){return l===b})))throw new Error("ComponentGroup: the required component list has a repeated name "+b);v._requiresNames.push(b)},v=this,g=0;g<l.length;g++)n(g)}return t.prototype.hasEntity=function(l){return!!l.isAddedToEngine()&&-1!==this.entities.indexOf(l)},t.prototype.addEntity=function(l){if(!l.isAddedToEngine())throw new TypeError("ComponentGroup: Cannot add a entity that is not added to the engine");-1===this.entities.indexOf(l)&&this.entities.push(l)},t.prototype.removeEntity=function(l){var y=this.entities.indexOf(l);-1!==y&&this.entities.splice(y,1)},t.prototype.componentRemoved=function(l,y){-1!==this._requiresNames.indexOf(y)&&this.removeEntity(l)},t.prototype.meetsRequirements=function(l){for(var y=0;y<this._requiresNames.length;y++)if(!(this._requiresNames[y]in l.components))return!1;return!0},t}();y.ComponentGroup=g},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.executeTask=void 0;var m=v(1),g=Promise.resolve().then.bind(Promise.resolve());y.executeTask=function(l){var y=g(l);return y.isComplete=!1,y.then((function(l){y.isComplete=!0,y.result=l,y.didFail=!1})).catch((function(l){y.isComplete=!0,y.error=l,y.didFail=!0,m.error("executeTask: FAILED "+l.toString(),l)})),y}},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Vector4=void 0;var m=v(2),g=v(4),b=v(3),C=function(){function t(l,y,v,m){this.x=l,this.y=y,this.z=v,this.w=m}return t.Add=function(l,y){return new t(l.x,l.y,l.z,l.w).addInPlace(y)},t.FromArray=function(l,y){return void 0===y&&(y=0),new t(l[y],l[y+1],l[y+2],l[y+3])},t.FromArrayToRef=function(l,y,v){v.x=l[y],v.y=l[y+1],v.z=l[y+2],v.w=l[y+3]},t.FromFloatArrayToRef=function(l,y,v){t.FromArrayToRef(l,y,v)},t.FromFloatsToRef=function(l,y,v,m,g){g.x=l,g.y=y,g.z=v,g.w=m},t.Zero=function(){return new t(0,0,0,0)},t.One=function(){return new t(1,1,1,1)},t.Normalize=function(l){var y=t.Zero();return t.NormalizeToRef(l,y),y},t.NormalizeToRef=function(l,y){y.copyFrom(l),y.normalize()},t.Minimize=function(l,y){var v=new t(l.x,l.y,l.z,l.w);return v.minimizeInPlace(y),v},t.Maximize=function(l,y){var v=new t(l.x,l.y,l.z,l.w);return v.maximizeInPlace(y),v},t.Distance=function(l,y){return Math.sqrt(t.DistanceSquared(l,y))},t.DistanceSquared=function(l,y){var v=l.x-y.x,m=l.y-y.y,g=l.z-y.z,b=l.w-y.w;return v*v+m*m+g*g+b*b},t.Center=function(l,y){var v=t.Add(l,y);return v.scaleInPlace(.5),v},t.TransformNormal=function(l,y){var v=t.Zero();return t.TransformNormalToRef(l,y,v),v},t.TransformNormalToRef=function(l,y,v){var m=y.m,g=l.x*m[0]+l.y*m[4]+l.z*m[8],b=l.x*m[1]+l.y*m[5]+l.z*m[9],C=l.x*m[2]+l.y*m[6]+l.z*m[10];v.x=g,v.y=b,v.z=C,v.w=l.w},t.TransformNormalFromFloatsToRef=function(l,y,v,m,g,b){var C=g.m;b.x=l*C[0]+y*C[4]+v*C[8],b.y=l*C[1]+y*C[5]+v*C[9],b.z=l*C[2]+y*C[6]+v*C[10],b.w=m},t.prototype.toString=function(){return"{X: "+this.x+" Y:"+this.y+" Z:"+this.z+" W:"+this.w+"}"},t.prototype.getClassName=function(){return"Vector4"},t.prototype.getHashCode=function(){var l=this.x||0;return 397*(l=397*(l=397*l^(this.y||0))^(this.z||0))^(this.w||0)},t.prototype.asArray=function(){var l=new Array;return this.toArray(l,0),l},t.prototype.toArray=function(l,y){return void 0===y&&(y=0),l[y]=this.x,l[y+1]=this.y,l[y+2]=this.z,l[y+3]=this.w,this},t.prototype.addInPlace=function(l){return this.x+=l.x,this.y+=l.y,this.z+=l.z,this.w+=l.w,this},t.prototype.add=function(l){return new t(this.x+l.x,this.y+l.y,this.z+l.z,this.w+l.w)},t.prototype.addToRef=function(l,y){return y.x=this.x+l.x,y.y=this.y+l.y,y.z=this.z+l.z,y.w=this.w+l.w,this},t.prototype.subtractInPlace=function(l){return this.x-=l.x,this.y-=l.y,this.z-=l.z,this.w-=l.w,this},t.prototype.subtract=function(l){return new t(this.x-l.x,this.y-l.y,this.z-l.z,this.w-l.w)},t.prototype.subtractToRef=function(l,y){return y.x=this.x-l.x,y.y=this.y-l.y,y.z=this.z-l.z,y.w=this.w-l.w,this},t.prototype.subtractFromFloats=function(l,y,v,m){return new t(this.x-l,this.y-y,this.z-v,this.w-m)},t.prototype.subtractFromFloatsToRef=function(l,y,v,m,g){return g.x=this.x-l,g.y=this.y-y,g.z=this.z-v,g.w=this.w-m,this},t.prototype.negate=function(){return new t(-this.x,-this.y,-this.z,-this.w)},t.prototype.scaleInPlace=function(l){return this.x*=l,this.y*=l,this.z*=l,this.w*=l,this},t.prototype.scale=function(l){return new t(this.x*l,this.y*l,this.z*l,this.w*l)},t.prototype.scaleToRef=function(l,y){return y.x=this.x*l,y.y=this.y*l,y.z=this.z*l,y.w=this.w*l,this},t.prototype.scaleAndAddToRef=function(l,y){return y.x+=this.x*l,y.y+=this.y*l,y.z+=this.z*l,y.w+=this.w*l,this},t.prototype.equals=function(l){return l&&this.x===l.x&&this.y===l.y&&this.z===l.z&&this.w===l.w},t.prototype.equalsWithEpsilon=function(l,y){return void 0===y&&(y=m.Epsilon),l&&g.Scalar.WithinEpsilon(this.x,l.x,y)&&g.Scalar.WithinEpsilon(this.y,l.y,y)&&g.Scalar.WithinEpsilon(this.z,l.z,y)&&g.Scalar.WithinEpsilon(this.w,l.w,y)},t.prototype.equalsToFloats=function(l,y,v,m){return this.x===l&&this.y===y&&this.z===v&&this.w===m},t.prototype.multiplyInPlace=function(l){return this.x*=l.x,this.y*=l.y,this.z*=l.z,this.w*=l.w,this},t.prototype.multiply=function(l){return new t(this.x*l.x,this.y*l.y,this.z*l.z,this.w*l.w)},t.prototype.multiplyToRef=function(l,y){return y.x=this.x*l.x,y.y=this.y*l.y,y.z=this.z*l.z,y.w=this.w*l.w,this},t.prototype.multiplyByFloats=function(l,y,v,m){return new t(this.x*l,this.y*y,this.z*v,this.w*m)},t.prototype.divide=function(l){return new t(this.x/l.x,this.y/l.y,this.z/l.z,this.w/l.w)},t.prototype.divideToRef=function(l,y){return y.x=this.x/l.x,y.y=this.y/l.y,y.z=this.z/l.z,y.w=this.w/l.w,this},t.prototype.divideInPlace=function(l){return this.divideToRef(l,this)},t.prototype.minimizeInPlace=function(l){return l.x<this.x&&(this.x=l.x),l.y<this.y&&(this.y=l.y),l.z<this.z&&(this.z=l.z),l.w<this.w&&(this.w=l.w),this},t.prototype.maximizeInPlace=function(l){return l.x>this.x&&(this.x=l.x),l.y>this.y&&(this.y=l.y),l.z>this.z&&(this.z=l.z),l.w>this.w&&(this.w=l.w),this},t.prototype.floor=function(){return new t(Math.floor(this.x),Math.floor(this.y),Math.floor(this.z),Math.floor(this.w))},t.prototype.fract=function(){return new t(this.x-Math.floor(this.x),this.y-Math.floor(this.y),this.z-Math.floor(this.z),this.w-Math.floor(this.w))},t.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},t.prototype.normalize=function(){var l=this.length();return 0===l?this:this.scaleInPlace(1/l)},t.prototype.toVector3=function(){return new b.Vector3(this.x,this.y,this.z)},t.prototype.clone=function(){return new t(this.x,this.y,this.z,this.w)},t.prototype.copyFrom=function(l){return this.x=l.x,this.y=l.y,this.z=l.z,this.w=l.w,this},t.prototype.copyFromFloats=function(l,y,v,m){return this.x=l,this.y=y,this.z=v,this.w=m,this},t.prototype.set=function(l,y,v,m){return this.copyFromFloats(l,y,v,m)},t.prototype.setAll=function(l){return this.x=this.y=this.z=this.w=l,this},t}();y.Vector4=C},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Angle=void 0;var m=function(){function t(l){this._radians=l,this._radians<0&&(this._radians+=2*Math.PI)}return t.BetweenTwoPoints=function(l,y){var v=y.subtract(l);return new t(Math.atan2(v.y,v.x))},t.FromRadians=function(l){return new t(l)},t.FromDegrees=function(l){return new t(l*Math.PI/180)},t.prototype.degrees=function(){return 180*this._radians/Math.PI},t.prototype.radians=function(){return this._radians},t}();y.Angle=m},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Arc2=void 0;var m=v(24),g=v(17),b=v(2);y.Arc2=function(l,y,v){this.startPoint=l,this.midPoint=y,this.endPoint=v;var C=Math.pow(y.x,2)+Math.pow(y.y,2),w=(Math.pow(l.x,2)+Math.pow(l.y,2)-C)/2,O=(C-Math.pow(v.x,2)-Math.pow(v.y,2))/2,x=(l.x-y.x)*(y.y-v.y)-(y.x-v.x)*(l.y-y.y);this.centerPoint=new g.Vector2((w*(y.y-v.y)-O*(l.y-y.y))/x,((l.x-y.x)*O-(y.x-v.x)*w)/x),this.radius=this.centerPoint.subtract(this.startPoint).length(),this.startAngle=m.Angle.BetweenTwoPoints(this.centerPoint,this.startPoint);var A=this.startAngle.degrees(),S=m.Angle.BetweenTwoPoints(this.centerPoint,this.midPoint).degrees(),E=m.Angle.BetweenTwoPoints(this.centerPoint,this.endPoint).degrees();S-A>180&&(S-=360),S-A<-180&&(S+=360),E-S>180&&(E-=360),E-S<-180&&(E+=360),this.orientation=S-A<0?b.Orientation.CW:b.Orientation.CCW,this.angle=m.Angle.FromDegrees(this.orientation===b.Orientation.CW?A-E:E-A)}},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Color4=void 0;var m=v(4),g=v(2),b=function(){function t(l,y,v,m){void 0===l&&(l=0),void 0===y&&(y=0),void 0===v&&(v=0),void 0===m&&(m=1),this.r=l,this.g=y,this.b=v,this.a=m}return t.FromHexString=function(l){if("#"!==l.substring(0,1)||9!==l.length)return new t(0,0,0,0);var y=parseInt(l.substring(1,3),16),v=parseInt(l.substring(3,5),16),m=parseInt(l.substring(5,7),16),g=parseInt(l.substring(7,9),16);return t.FromInts(y,v,m,g)},t.Lerp=function(l,y,v){var m=new t(0,0,0,0);return t.LerpToRef(l,y,v,m),m},t.LerpToRef=function(l,y,v,m){m.r=l.r+(y.r-l.r)*v,m.g=l.g+(y.g-l.g)*v,m.b=l.b+(y.b-l.b)*v,m.a=l.a+(y.a-l.a)*v},t.Red=function(){return new t(1,0,0,1)},t.Green=function(){return new t(0,1,0,1)},t.Blue=function(){return new t(0,0,1,1)},t.Black=function(){return new t(0,0,0,1)},t.White=function(){return new t(1,1,1,1)},t.Purple=function(){return new t(.5,0,.5,1)},t.Magenta=function(){return new t(1,0,1,1)},t.Yellow=function(){return new t(1,1,0,1)},t.Gray=function(){return new t(.5,.5,.5,1)},t.Teal=function(){return new t(0,1,1,1)},t.Clear=function(){return new t(0,0,0,0)},t.FromColor3=function(l,y){return void 0===y&&(y=1),new t(l.r,l.g,l.b,y)},t.FromArray=function(l,y){return void 0===y&&(y=0),new t(l[y],l[y+1],l[y+2],l[y+3])},t.FromInts=function(l,y,v,m){return new t(l/255,y/255,v/255,m/255)},t.CheckColors4=function(l,y){if(l.length===3*y){for(var v=[],m=0;m<l.length;m+=3){var g=m/3*4;v[g]=l[m],v[g+1]=l[m+1],v[g+2]=l[m+2],v[g+3]=1}return v}return l},t.prototype.addInPlace=function(l){return this.r+=l.r,this.g+=l.g,this.b+=l.b,this.a+=l.a,this},t.prototype.asArray=function(){var l=new Array;return this.toArray(l,0),l},t.prototype.toArray=function(l,y){return void 0===y&&(y=0),l[y]=this.r,l[y+1]=this.g,l[y+2]=this.b,l[y+3]=this.a,this},t.prototype.add=function(l){return new t(this.r+l.r,this.g+l.g,this.b+l.b,this.a+l.a)},t.prototype.subtract=function(l){return new t(this.r-l.r,this.g-l.g,this.b-l.b,this.a-l.a)},t.prototype.subtractToRef=function(l,y){return y.r=this.r-l.r,y.g=this.g-l.g,y.b=this.b-l.b,y.a=this.a-l.a,this},t.prototype.scale=function(l){return new t(this.r*l,this.g*l,this.b*l,this.a*l)},t.prototype.scaleToRef=function(l,y){return y.r=this.r*l,y.g=this.g*l,y.b=this.b*l,y.a=this.a*l,this},t.prototype.scaleAndAddToRef=function(l,y){return y.r+=this.r*l,y.g+=this.g*l,y.b+=this.b*l,y.a+=this.a*l,this},t.prototype.clampToRef=function(l,y,v){return void 0===l&&(l=0),void 0===y&&(y=1),v.r=m.Scalar.Clamp(this.r,l,y),v.g=m.Scalar.Clamp(this.g,l,y),v.b=m.Scalar.Clamp(this.b,l,y),v.a=m.Scalar.Clamp(this.a,l,y),this},t.prototype.multiply=function(l){return new t(this.r*l.r,this.g*l.g,this.b*l.b,this.a*l.a)},t.prototype.multiplyToRef=function(l,y){return y.r=this.r*l.r,y.g=this.g*l.g,y.b=this.b*l.b,y.a=this.a*l.a,y},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+" A:"+this.a+"}"},t.prototype.getClassName=function(){return"Color4"},t.prototype.getHashCode=function(){var l=this.r||0;return 397*(l=397*(l=397*l^(this.g||0))^(this.b||0))^(this.a||0)},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a)},t.prototype.copyFrom=function(l){return this.r=l.r,this.g=l.g,this.b=l.b,this.a=l.a,this},t.prototype.copyFromFloats=function(l,y,v,m){return this.r=l,this.g=y,this.b=v,this.a=m,this},t.prototype.set=function(l,y,v,m){return this.copyFromFloats(l,y,v,m)},t.prototype.toHexString=function(){var l=255*this.r|0,y=255*this.g|0,v=255*this.b|0,g=255*this.a|0;return"#"+m.Scalar.ToHex(l)+m.Scalar.ToHex(y)+m.Scalar.ToHex(v)+m.Scalar.ToHex(g)},t.prototype.toLinearSpace=function(){var l=new t;return this.toLinearSpaceToRef(l),l},t.prototype.toLinearSpaceToRef=function(l){return l.r=Math.pow(this.r,g.ToLinearSpace),l.g=Math.pow(this.g,g.ToLinearSpace),l.b=Math.pow(this.b,g.ToLinearSpace),l.a=this.a,this},t.prototype.toGammaSpace=function(){var l=new t;return this.toGammaSpaceToRef(l),l},t.prototype.toGammaSpaceToRef=function(l){return l.r=Math.pow(this.r,g.ToGammaSpace),l.g=Math.pow(this.g,g.ToGammaSpace),l.b=Math.pow(this.b,g.ToGammaSpace),l.a=this.a,this},t}();y.Color4=b},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Plane=void 0;var m=v(3),g=v(13),b=v(9),C=function(){function t(l,y,v,g){this.normal=new m.Vector3(l,y,v),this.d=g}return t.FromArray=function(l){return new t(l[0],l[1],l[2],l[3])},t.FromPoints=function(l,y,v){var m=new t(0,0,0,0);return m.copyFromPoints(l,y,v),m},t.FromPositionAndNormal=function(l,y){var v=new t(0,0,0,0);return y.normalize(),v.normal=y,v.d=-(y.x*l.x+y.y*l.y+y.z*l.z),v},t.SignedDistanceToPlaneFromPositionAndNormal=function(l,y,v){var g=-(y.x*l.x+y.y*l.y+y.z*l.z);return m.Vector3.Dot(v,y)+g},t.prototype.asArray=function(){return[this.normal.x,this.normal.y,this.normal.z,this.d]},t.prototype.clone=function(){return new t(this.normal.x,this.normal.y,this.normal.z,this.d)},t.prototype.getClassName=function(){return"Plane"},t.prototype.getHashCode=function(){return 397*this.normal.getHashCode()^(this.d||0)},t.prototype.normalize=function(){var l=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y+this.normal.z*this.normal.z),y=0;return 0!==l&&(y=1/l),this.normal.x*=y,this.normal.y*=y,this.normal.z*=y,this.d*=y,this},t.prototype.transform=function(l){var y=b.MathTmp.Matrix[0];g.Matrix.TransposeToRef(l,y);var v=y.m,m=this.normal.x,C=this.normal.y,w=this.normal.z,O=this.d;return new t(m*v[0]+C*v[1]+w*v[2]+O*v[3],m*v[4]+C*v[5]+w*v[6]+O*v[7],m*v[8]+C*v[9]+w*v[10]+O*v[11],m*v[12]+C*v[13]+w*v[14]+O*v[15])},t.prototype.dotCoordinate=function(l){return this.normal.x*l.x+this.normal.y*l.y+this.normal.z*l.z+this.d},t.prototype.copyFromPoints=function(l,y,v){var m,g=y.x-l.x,b=y.y-l.y,C=y.z-l.z,w=v.x-l.x,O=v.y-l.y,x=v.z-l.z,A=b*x-C*O,S=C*w-g*x,E=g*O-b*w,T=Math.sqrt(A*A+S*S+E*E);return m=0!==T?1/T:0,this.normal.x=A*m,this.normal.y=S*m,this.normal.z=E*m,this.d=-(this.normal.x*l.x+this.normal.y*l.y+this.normal.z*l.z),this},t.prototype.isFrontFacingTo=function(l,y){return m.Vector3.Dot(this.normal,l)<=y},t.prototype.signedDistanceTo=function(l){return m.Vector3.Dot(l,this.normal)+this.d},t}();y.Plane=C},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__assign||function(){return(b=Object.assign||function(l){for(var y,v=1,m=arguments.length;v<m;v++)for(var g in y=arguments[v])Object.prototype.hasOwnProperty.call(y,g)&&(l[g]=y[g]);return l}).apply(this,arguments)},C=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.AnimationState=void 0;var w=v(0),O=v(1),x={looping:!0,speed:1,weight:1,layer:0},A=function(l){function e(y,v){void 0===v&&(v=x);var m=l.call(this)||this;return m.isAnimationClip=!0,m.looping=x.looping,m.weight=x.weight,m.playing=!1,m.shouldReset=!1,m.speed=x.speed,m.name=O.newId("AnimClip"),m.layer=x.layer,m.clip=y,m.setParams(b({},v)),m}return g(e,l),e.prototype.setParams=function(l){return this.looping=void 0!==l.looping?l.looping:this.looping,this.speed=l.speed||this.speed,this.weight=l.weight||this.weight,this.layer=l.layer||this.layer,this},e.prototype.toJSON=function(){var y=JSON.parse(JSON.stringify(l.prototype.toJSON.call(this)));return this.shouldReset&&(this.shouldReset=!1),y},e.prototype.play=function(l){var y;void 0===l&&(l=!1),null===(y=this.owner)||void 0===y||y.play(this,l)},e.prototype.pause=function(){var l;null===(l=this.owner)||void 0===l||l.pause(this)},e.prototype.reset=function(){this.shouldReset=!0},e.prototype.stop=function(){var l;null===(l=this.owner)||void 0===l||l.stop(this)},C([w.ObservableComponent.readonly],e.prototype,"clip",void 0),C([w.ObservableComponent.field],e.prototype,"looping",void 0),C([w.ObservableComponent.field],e.prototype,"weight",void 0),C([w.ObservableComponent.field],e.prototype,"playing",void 0),C([w.ObservableComponent.field],e.prototype,"shouldReset",void 0),C([w.ObservableComponent.field],e.prototype,"speed",void 0),C([w.ObservableComponent.readonly],e.prototype,"name",void 0),e}(w.ObservableComponent);y.AnimationState=A},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.PhysicsCast=void 0;var m,g=v(6),b=v(1),C=v(30);!function(l){l.HitFirst="rqhf",l.HitAll="rqha"}(m||(m={}));var w=function(){function t(){this.queries={}}return Object.defineProperty(t,"instance",{get:function(){return t.ensureInstance(),t._instance},enumerable:!1,configurable:!0}),t.ensureInstance=function(){t._instance||(t._instance=new t)},t.prototype.getRayFromCamera=function(l){var y=C.Camera.instance.rotation,v=g.Matrix.Identity();y.toRotationMatrix(v);var m=g.Vector3.TransformCoordinates(g.Vector3.Forward(),v);return{origin:C.Camera.instance.position,direction:m,distance:l}},t.prototype.getRayFromPositions=function(l,y){var v=y.subtract(l),m=v.length();return{origin:l,direction:v.normalize(),distance:m}},t.prototype.hitFirst=function(l,y,v){var g="number"==typeof v?m.HitFirst+v:b.uuid();this.queries[g]=y,dcl&&dcl.query("raycast",{queryId:g,queryType:"HitFirst",ray:l})},t.prototype.hitAll=function(l,y,v){var g="number"==typeof v?m.HitAll+v:b.uuid();this.queries[g]=y,dcl&&dcl.query("raycast",{queryId:g,queryType:"HitAll",ray:l})},t.prototype.hitFirstAvatar=function(l,y){b.log("not implemented yet")},t.prototype.hitAllAvatars=function(l,y){b.log("not implemented yet")},t.prototype.handleRaycastHitFirstResponse=function(l){this.queries[l.payload.queryId](l.payload.payload),delete this.queries[l.payload.queryId]},t.prototype.handleRaycastHitAllResponse=function(l){this.queries[l.payload.queryId](l.payload.payload),delete this.queries[l.payload.queryId]},t}();y.PhysicsCast=w},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Camera=void 0;var m=v(6),g=v(11),b=function(){function t(){var l=this;this.position=new m.Vector3,this.rotation=new m.Quaternion,this.feetPosition=new m.Vector3,this.worldPosition=new m.Vector3,this.lastEventPosition={x:0,y:0,z:0},this.lastEventWorldPosition={x:0,y:0,z:0},this.lastEventRotation={x:0,y:0,z:0,w:1},this._playerHeight=1.6,this._cameraMode=g.CameraMode.FirstPerson,"undefined"!=typeof dcl&&(dcl.subscribe("positionChanged"),dcl.subscribe("rotationChanged"),dcl.subscribe("cameraModeChanged"),dcl.onEvent((function(y){switch(y.type){case"positionChanged":l.positionChanged(y.data);break;case"rotationChanged":l.rotationChanged(y.data);break;case"cameraModeChanged":l.cameraModeChanged(y.data)}}))),Object.defineProperty(this.position,"x",{get:function(){return l.lastEventPosition.x}}),Object.defineProperty(this.position,"y",{get:function(){return l.lastEventPosition.y}}),Object.defineProperty(this.position,"z",{get:function(){return l.lastEventPosition.z}}),Object.defineProperty(this.worldPosition,"x",{get:function(){return l.lastEventWorldPosition.x}}),Object.defineProperty(this.worldPosition,"y",{get:function(){return l.lastEventWorldPosition.y}}),Object.defineProperty(this.worldPosition,"z",{get:function(){return l.lastEventWorldPosition.z}}),Object.defineProperty(this.feetPosition,"x",{get:function(){return l.lastEventPosition.x}}),Object.defineProperty(this.feetPosition,"y",{get:function(){return l.lastEventPosition.y-l.playerHeight}}),Object.defineProperty(this.feetPosition,"z",{get:function(){return l.lastEventPosition.z}}),Object.defineProperty(this.rotation,"x",{get:function(){return l.lastEventRotation.x}}),Object.defineProperty(this.rotation,"y",{get:function(){return l.lastEventRotation.y}}),Object.defineProperty(this.rotation,"z",{get:function(){return l.lastEventRotation.z}}),Object.defineProperty(this.rotation,"w",{get:function(){return l.lastEventRotation.w}})}return Object.defineProperty(t,"instance",{get:function(){return t._instance||(t._instance=new t),t._instance},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"playerHeight",{get:function(){return this._playerHeight},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cameraMode",{get:function(){return this._cameraMode},enumerable:!1,configurable:!0}),t.prototype.positionChanged=function(l){this.lastEventPosition=l.position,this.lastEventWorldPosition=l.cameraPosition,this._playerHeight=l.playerHeight},t.prototype.rotationChanged=function(l){this.lastEventRotation=l.quaternion},t.prototype.cameraModeChanged=function(l){this._cameraMode=l.cameraMode},t}();y.Camera=b},function(l,y,v){"use strict";var m=this&&this.__createBinding||(Object.create?function(l,y,v,m){void 0===m&&(m=v),Object.defineProperty(l,m,{enumerable:!0,get:function(){return y[v]}})}:function(l,y,v,m){void 0===m&&(m=v),l[m]=y[v]}),g=this&&this.__exportStar||function(l,y){for(var v in l)"default"===v||Object.prototype.hasOwnProperty.call(y,v)||m(y,l,v)};Object.defineProperty(y,"__esModule",{value:!0}),y.engine=void 0,g(v(32),y),g(v(19),y),g(v(0),y),g(v(21),y),g(v(14),y),g(v(7),y),g(v(22),y),g(v(1),y),g(v(15),y),g(v(20),y),g(v(8),y),g(v(33),y);var b=v(10),C=v(34),w=v(19),O=new(v(14).Entity)("scene");O.uuid="0";var x=new w.Engine(O);y.engine=x,v(0).DisposableComponent.engine=x,"undefined"!=typeof dcl&&(x.addSystem(new C.DecentralandSynchronizationSystem(dcl),1/0),b._initEventObservables(dcl));var A=v(16);x.addSystem(A.uuidEventSystem),x.addSystem(A.pointerEventSystem),x.addSystem(A.raycastEventSystem),g(v(6),y),g(v(11),y),g(v(5),y),g(v(16),y),g(v(10),y),g(v(30),y),g(v(28),y),g(v(18),y),g(v(43),y),g(v(44),y),g(v(45),y),g(v(46),y),g(v(47),y),g(v(48),y),g(v(29),y)},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Attachable=void 0;var m=function(){function t(){}return t.AVATAR={getEntityRepresentation:function(l){return l.avatarEntity}},t.FIRST_PERSON_CAMERA={getEntityRepresentation:function(l){return l.firstPersonCameraEntity}},t}();y.Attachable=m},function(l,y,v){"use strict";var m;Object.defineProperty(y,"__esModule",{value:!0}),y.teleportTo=void 0,y.teleportTo=function(l){var y;y=[l],void 0===m&&"undefined"!=typeof dcl&&(m=dcl.loadModule("@decentraland/UserActionModule")),void 0!==m&&"undefined"!=typeof dcl&&m.then((function(l){dcl.callRpc(l.rpcHandle,"requestTeleport",y)}))}},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.DecentralandSynchronizationSystem=void 0;var m=v(0),g=v(7),b=v(10),C=function(){function t(l){this.dcl=l,this.cachedComponents={}}return t.prototype.activate=function(l){var y=this;this.engine=l,l.eventManager.addListener(g.ComponentAdded,this,this.componentAdded),l.eventManager.addListener(g.ComponentRemoved,this,this.componentRemoved),l.eventManager.addListener(m.DisposableComponentCreated,this,this.disposableComponentCreated),l.eventManager.addListener(m.DisposableComponentRemoved,this,this.disposableComponentRemoved),l.eventManager.addListener(m.DisposableComponentUpdated,this,this.disposableComponentUpdated),l.eventManager.addListener(g.ParentChanged,this,this.parentChanged);var v=l.rootEntity.uuid;this.dcl.addEntity(v),this.dcl.onUpdate((function(v){l.update(v),y.presentEntities()})),this.dcl.onEvent((function(y){var v=y.data;switch(y.type){case"uuidEvent":l.eventManager.fireEvent(new b.UUIDEvent(v.uuid,v.payload));break;case"raycastResponse":("HitFirst"===v.queryType||"HitAll"===v.queryType)&&l.eventManager.fireEvent(new b.RaycastResponse(v));break;case"pointerEvent":l.eventManager.fireEvent(new b.PointerEvent(v.payload))}}))},t.prototype.onAddEntity=function(l){if(l&&l.isAddedToEngine()){var y=l.uuid,v=l.getParent();for(var g in this.dcl.addEntity(y),v&&this.dcl.setParent(y,v.uuid),this.cachedComponents[y]={},l.components){var b=l.components[g],C=m.getComponentClassId(b);if(null!==C)if(m.isDisposableComponent(b))this.dcl.attachEntityComponent(l.uuid,g,m.getComponentId(b));else{var w=JSON.stringify(b);this.dcl.updateEntityComponent(y,g,C,w),this.cachedComponents[y][g]=w}}}},t.prototype.onRemoveEntity=function(l){if(l.isAddedToEngine()){var y=l.uuid;this.dcl.removeEntity(y),delete this.cachedComponents[y]}},t.prototype.presentEntities=function(){for(var l in this.engine.entities){var y=this.engine.entities[l];for(var v in y.components){var g=y.components[v],b=m.getComponentClassId(g);if(null!==b&&!m.isDisposableComponent(g)){var C=this.getJsonIfDirty(y.uuid,v,g);C&&(this.dcl.updateEntityComponent(y.uuid,v,b,C),this.clearDirty(y.uuid,v,g,C))}}}for(var w in this.engine.disposableComponents)(g=this.engine.disposableComponents[w])instanceof m.ObservableComponent&&g.dirty&&(this.dcl.componentUpdated(w,JSON.stringify(g)),g.dirty=!1)},t.prototype.componentAdded=function(l){if(l.entity.isAddedToEngine()){var y=l.entity.components[l.componentName];if(m.isDisposableComponent(y))this.dcl.attachEntityComponent(l.entity.uuid,l.componentName,m.getComponentId(y));else if(null!==l.classId){var v=JSON.stringify(y);this.dcl.updateEntityComponent(l.entity.uuid,l.componentName,l.classId,v),this.cachedComponents[l.entity.uuid][l.componentName]=v}}},t.prototype.componentRemoved=function(l){l.entity.isAddedToEngine()&&(this.dcl.removeEntityComponent(l.entity.uuid,l.componentName),delete this.cachedComponents[l.entity.uuid][l.componentName])},t.prototype.disposableComponentCreated=function(l){this.dcl.componentCreated(l.componentId,l.componentName,l.classId)},t.prototype.disposableComponentRemoved=function(l){this.dcl.componentDisposed(l.componentId)},t.prototype.disposableComponentUpdated=function(l){this.dcl.componentUpdated(l.componentId,JSON.stringify(l.component))},t.prototype.parentChanged=function(l){this.dcl.setParent(l.entity.uuid,l.parent?l.parent.uuid:"0")},t.prototype.getJsonIfDirty=function(l,y,v){var m=JSON.stringify(v);return m!==this.cachedComponents[l][y]&&m},t.prototype.clearDirty=function(l,y,v,m){this.cachedComponents[l][y]=m},t}();y.DecentralandSynchronizationSystem=C},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Axis=void 0;var m=v(3),g=function(){function t(){}return t.X=new m.Vector3(1,0,0),t.Y=new m.Vector3(0,1,0),t.Z=new m.Vector3(0,0,1),t}();y.Axis=g},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.BezierCurve=void 0;var m=function(){function t(){}return t.Interpolate=function(l,y,v,m,g){for(var b=1-3*m+3*y,C=3*m-6*y,w=3*y,O=l,x=0;x<5;x++){var A=O*O;O-=1/(3*b*A+2*C*O+w)*(b*(A*O)+C*A+w*O-l),O=Math.min(1,Math.max(0,O))}return 3*Math.pow(1-O,2)*O*v+3*(1-O)*Math.pow(O,2)*g+Math.pow(O,3)},t}();y.BezierCurve=m},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Color3=void 0;var m=v(2),g=v(26),b=v(4),C=function(){function t(l,y,v){void 0===l&&(l=0),void 0===y&&(y=0),void 0===v&&(v=0),this.r=l,this.g=y,this.b=v}return t.FromHexString=function(l){if("#"!==l.substring(0,1)||7!==l.length)return new t(0,0,0);var y=parseInt(l.substring(1,3),16),v=parseInt(l.substring(3,5),16),m=parseInt(l.substring(5,7),16);return t.FromInts(y,v,m)},t.FromArray=function(l,y){return void 0===y&&(y=0),new t(l[y],l[y+1],l[y+2])},t.FromInts=function(l,y,v){return new t(l/255,y/255,v/255)},t.Lerp=function(l,y,v){var m=new t(0,0,0);return t.LerpToRef(l,y,v,m),m},t.LerpToRef=function(l,y,v,m){m.r=l.r+(y.r-l.r)*v,m.g=l.g+(y.g-l.g)*v,m.b=l.b+(y.b-l.b)*v},t.Red=function(){return new t(1,0,0)},t.Green=function(){return new t(0,1,0)},t.Blue=function(){return new t(0,0,1)},t.Black=function(){return new t(0,0,0)},t.White=function(){return new t(1,1,1)},t.Purple=function(){return new t(.5,0,.5)},t.Magenta=function(){return new t(1,0,1)},t.Yellow=function(){return new t(1,1,0)},t.Gray=function(){return new t(.5,.5,.5)},t.Teal=function(){return new t(0,1,1)},t.Random=function(){return new t(Math.random(),Math.random(),Math.random())},t.prototype.toString=function(){return"{R: "+this.r+" G:"+this.g+" B:"+this.b+"}"},t.prototype.getClassName=function(){return"Color3"},t.prototype.getHashCode=function(){var l=this.r||0;return 397*(l=397*l^(this.g||0))^(this.b||0)},t.prototype.toArray=function(l,y){return void 0===y&&(y=0),l[y]=this.r,l[y+1]=this.g,l[y+2]=this.b,this},t.prototype.toColor4=function(l){return void 0===l&&(l=1),new g.Color4(this.r,this.g,this.b,l)},t.prototype.asArray=function(){var l=new Array;return this.toArray(l,0),l},t.prototype.toLuminance=function(){return.3*this.r+.59*this.g+.11*this.b},t.prototype.multiply=function(l){return new t(this.r*l.r,this.g*l.g,this.b*l.b)},t.prototype.multiplyToRef=function(l,y){return y.r=this.r*l.r,y.g=this.g*l.g,y.b=this.b*l.b,this},t.prototype.equals=function(l){return l&&this.r===l.r&&this.g===l.g&&this.b===l.b},t.prototype.equalsFloats=function(l,y,v){return this.r===l&&this.g===y&&this.b===v},t.prototype.scale=function(l){return new t(this.r*l,this.g*l,this.b*l)},t.prototype.scaleToRef=function(l,y){return y.r=this.r*l,y.g=this.g*l,y.b=this.b*l,this},t.prototype.scaleAndAddToRef=function(l,y){return y.r+=this.r*l,y.g+=this.g*l,y.b+=this.b*l,this},t.prototype.clampToRef=function(l,y,v){return void 0===l&&(l=0),void 0===y&&(y=1),v.r=b.Scalar.Clamp(this.r,l,y),v.g=b.Scalar.Clamp(this.g,l,y),v.b=b.Scalar.Clamp(this.b,l,y),this},t.prototype.add=function(l){return new t(this.r+l.r,this.g+l.g,this.b+l.b)},t.prototype.addToRef=function(l,y){return y.r=this.r+l.r,y.g=this.g+l.g,y.b=this.b+l.b,this},t.prototype.subtract=function(l){return new t(this.r-l.r,this.g-l.g,this.b-l.b)},t.prototype.subtractToRef=function(l,y){return y.r=this.r-l.r,y.g=this.g-l.g,y.b=this.b-l.b,this},t.prototype.clone=function(){return new t(this.r,this.g,this.b)},t.prototype.copyFrom=function(l){return this.r=l.r,this.g=l.g,this.b=l.b,this},t.prototype.copyFromFloats=function(l,y,v){return this.r=l,this.g=y,this.b=v,this},t.prototype.set=function(l,y,v){return this.copyFromFloats(l,y,v)},t.prototype.toHexString=function(){var l=255*this.r|0,y=255*this.g|0,v=255*this.b|0;return"#"+b.Scalar.ToHex(l)+b.Scalar.ToHex(y)+b.Scalar.ToHex(v)},t.prototype.toLinearSpace=function(){var l=new t;return this.toLinearSpaceToRef(l),l},t.prototype.toLinearSpaceToRef=function(l){return l.r=Math.pow(this.r,m.ToLinearSpace),l.g=Math.pow(this.g,m.ToLinearSpace),l.b=Math.pow(this.b,m.ToLinearSpace),this},t.prototype.toGammaSpace=function(){var l=new t;return this.toGammaSpaceToRef(l),l},t.prototype.toGammaSpaceToRef=function(l){return l.r=Math.pow(this.r,m.ToGammaSpace),l.g=Math.pow(this.g,m.ToGammaSpace),l.b=Math.pow(this.b,m.ToGammaSpace),this},t.prototype.toJSON=function(){return{r:this.r,g:this.g,b:this.b}},t}();y.Color3=C},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Curve3=void 0;var m=v(3),g=function(){function t(l){this._length=0,this._points=l,this._length=this._computeLength(l)}return t.CreateQuadraticBezier=function(l,y,v,g){g=g>2?g:3;for(var b=new Array,a=function(l,y,v,m){return(1-l)*(1-l)*y+2*l*(1-l)*v+l*l*m},C=0;C<=g;C++)b.push(new m.Vector3(a(C/g,l.x,y.x,v.x),a(C/g,l.y,y.y,v.y),a(C/g,l.z,y.z,v.z)));return new t(b)},t.CreateCubicBezier=function(l,y,v,g,b){b=b>3?b:4;for(var C=new Array,p=function(l,y,v,m,g){return(1-l)*(1-l)*(1-l)*y+3*l*(1-l)*(1-l)*v+3*l*l*(1-l)*m+l*l*l*g},w=0;w<=b;w++)C.push(new m.Vector3(p(w/b,l.x,y.x,v.x,g.x),p(w/b,l.y,y.y,v.y,g.y),p(w/b,l.z,y.z,v.z,g.z)));return new t(C)},t.CreateHermiteSpline=function(l,y,v,g,b){for(var C=new Array,w=1/b,O=0;O<=b;O++)C.push(m.Vector3.Hermite(l,y,v,g,O*w));return new t(C)},t.CreateCatmullRomSpline=function(l,y,v){var g=new Array,b=1/y,C=0;if(v){for(var w=l.length,O=0;O<w;O++){C=0;for(var x=0;x<y;x++)g.push(m.Vector3.CatmullRom(l[O%w],l[(O+1)%w],l[(O+2)%w],l[(O+3)%w],C)),C+=b}g.push(g[0])}else{var A=new Array;for(A.push(l[0].clone()),Array.prototype.push.apply(A,l),A.push(l[l.length-1].clone()),O=0,O=0;O<A.length-3;O++)for(C=0,x=0;x<y;x++)g.push(m.Vector3.CatmullRom(A[O],A[O+1],A[O+2],A[O+3],C)),C+=b;O--,g.push(m.Vector3.CatmullRom(A[O],A[O+1],A[O+2],A[O+3],C))}return new t(g)},t.prototype.getPoints=function(){return this._points},t.prototype.length=function(){return this._length},t.prototype.continue=function(l){for(var y=this._points[this._points.length-1],v=this._points.slice(),m=l.getPoints(),g=1;g<m.length;g++)v.push(m[g].subtract(m[0]).add(y));return new t(v)},t.prototype._computeLength=function(l){for(var y=0,v=1;v<l.length;v++)y+=l[v].subtract(l[v-1]).length();return y},t}();y.Curve3=g},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Frustum=void 0;var m=v(27),g=function(){function t(){}return t.GetPlanes=function(l){for(var y=[],v=0;v<6;v++)y.push(new m.Plane(0,0,0,0));return t.GetPlanesToRef(l,y),y},t.GetNearPlaneToRef=function(l,y){var v=l.m;y.normal.x=v[3]+v[2],y.normal.y=v[7]+v[6],y.normal.z=v[11]+v[10],y.d=v[15]+v[14],y.normalize()},t.GetFarPlaneToRef=function(l,y){var v=l.m;y.normal.x=v[3]-v[2],y.normal.y=v[7]-v[6],y.normal.z=v[11]-v[10],y.d=v[15]-v[14],y.normalize()},t.GetLeftPlaneToRef=function(l,y){var v=l.m;y.normal.x=v[3]+v[0],y.normal.y=v[7]+v[4],y.normal.z=v[11]+v[8],y.d=v[15]+v[12],y.normalize()},t.GetRightPlaneToRef=function(l,y){var v=l.m;y.normal.x=v[3]-v[0],y.normal.y=v[7]-v[4],y.normal.z=v[11]-v[8],y.d=v[15]-v[12],y.normalize()},t.GetTopPlaneToRef=function(l,y){var v=l.m;y.normal.x=v[3]-v[1],y.normal.y=v[7]-v[5],y.normal.z=v[11]-v[9],y.d=v[15]-v[13],y.normalize()},t.GetBottomPlaneToRef=function(l,y){var v=l.m;y.normal.x=v[3]+v[1],y.normal.y=v[7]+v[5],y.normal.z=v[11]+v[9],y.d=v[15]+v[13],y.normalize()},t.GetPlanesToRef=function(l,y){t.GetNearPlaneToRef(l,y[0]),t.GetFarPlaneToRef(l,y[1]),t.GetLeftPlaneToRef(l,y[2]),t.GetRightPlaneToRef(l,y[3]),t.GetTopPlaneToRef(l,y[4]),t.GetBottomPlaneToRef(l,y[5])},t}();y.Frustum=g},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Path2=void 0;var m=v(17),g=v(25),b=v(2),C=function(){function t(l,y){this.closed=!1,this._points=new Array,this._length=0,this._points.push(new m.Vector2(l,y))}return t.StartingAt=function(l,y){return new t(l,y)},t.prototype.addLineTo=function(l,y){if(this.closed)return this;var v=new m.Vector2(l,y),g=this._points[this._points.length-1];return this._points.push(v),this._length+=v.subtract(g).length(),this},t.prototype.addArcTo=function(l,y,v,C,w){if(void 0===w&&(w=36),this.closed)return this;var O=this._points[this._points.length-1],x=new m.Vector2(l,y),A=new m.Vector2(v,C),S=new g.Arc2(O,x,A),E=S.angle.radians()/w;S.orientation===b.Orientation.CW&&(E*=-1);for(var T=S.startAngle.radians()+E,R=0;R<w;R++){var I=Math.cos(T)*S.radius+S.centerPoint.x,P=Math.sin(T)*S.radius+S.centerPoint.y;this.addLineTo(I,P),T+=E}return this},t.prototype.close=function(){return this.closed=!0,this},t.prototype.length=function(){var l=this._length;if(!this.closed){var y=this._points[this._points.length-1];l+=this._points[0].subtract(y).length()}return l},t.prototype.getPoints=function(){return this._points},t.prototype.getPointAtLengthPosition=function(l){if(l<0||l>1)return m.Vector2.Zero();for(var y=l*this.length(),v=0,g=0;g<this._points.length;g++){var b=(g+1)%this._points.length,C=this._points[g],w=this._points[b].subtract(C),O=w.length()+v;if(y>=v&&y<=O){var x=w.normalize(),A=y-v;return new m.Vector2(C.x+x.x*A,C.y+x.y*A)}v=O}return m.Vector2.Zero()},t}();y.Path2=C},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Path3D=void 0;var m=v(3),g=v(2),b=v(4),C=function(){function t(l,y,v){void 0===y&&(y=null),this.path=l,this._curve=new Array,this._distances=new Array,this._tangents=new Array,this._normals=new Array,this._binormals=new Array;for(var m=0;m<l.length;m++)this._curve[m]=l[m].clone();this._raw=v||!1,this._compute(y)}return t.prototype.getCurve=function(){return this._curve},t.prototype.getTangents=function(){return this._tangents},t.prototype.getNormals=function(){return this._normals},t.prototype.getBinormals=function(){return this._binormals},t.prototype.getDistances=function(){return this._distances},t.prototype.update=function(l,y){void 0===y&&(y=null);for(var v=0;v<l.length;v++)this._curve[v].x=l[v].x,this._curve[v].y=l[v].y,this._curve[v].z=l[v].z;return this._compute(y),this},t.prototype._compute=function(l){var y=this._curve.length;this._tangents[0]=this._getFirstNonNullVector(0),this._raw||this._tangents[0].normalize(),this._tangents[y-1]=this._curve[y-1].subtract(this._curve[y-2]),this._raw||this._tangents[y-1].normalize();var v,g,b,C,w=this._tangents[0],O=this._normalVector(this._curve[0],w,l);this._normals[0]=O,this._raw||this._normals[0].normalize(),this._binormals[0]=m.Vector3.Cross(w,this._normals[0]),this._raw||this._binormals[0].normalize(),this._distances[0]=0;for(var x=1;x<y;x++)v=this._getLastNonNullVector(x),x<y-1&&(g=this._getFirstNonNullVector(x),this._tangents[x]=v.add(g),this._tangents[x].normalize()),this._distances[x]=this._distances[x-1]+v.length(),b=this._tangents[x],C=this._binormals[x-1],this._normals[x]=m.Vector3.Cross(C,b),this._raw||this._normals[x].normalize(),this._binormals[x]=m.Vector3.Cross(b,this._normals[x]),this._raw||this._binormals[x].normalize()},t.prototype._getFirstNonNullVector=function(l){for(var y=1,v=this._curve[l+y].subtract(this._curve[l]);0===v.length()&&l+y+1<this._curve.length;)y++,v=this._curve[l+y].subtract(this._curve[l]);return v},t.prototype._getLastNonNullVector=function(l){for(var y=1,v=this._curve[l].subtract(this._curve[l-y]);0===v.length()&&l>y+1;)y++,v=this._curve[l].subtract(this._curve[l-y]);return v},t.prototype._normalVector=function(l,y,v){var C,w,O=y.length();(0===O&&(O=1),null==v)?(w=b.Scalar.WithinEpsilon(Math.abs(y.y)/O,1,g.Epsilon)?b.Scalar.WithinEpsilon(Math.abs(y.x)/O,1,g.Epsilon)?b.Scalar.WithinEpsilon(Math.abs(y.z)/O,1,g.Epsilon)?m.Vector3.Zero():new m.Vector3(0,0,1):new m.Vector3(1,0,0):new m.Vector3(0,-1,0),C=m.Vector3.Cross(y,w)):(C=m.Vector3.Cross(y,v),m.Vector3.CrossToRef(C,y,C));return C.normalize(),C},t}();y.Path3D=C},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.Size=void 0;var m=function(){function t(l,y){this.width=l,this.height=y}return Object.defineProperty(t.prototype,"surface",{get:function(){return this.width*this.height},enumerable:!1,configurable:!0}),t.Zero=function(){return new t(0,0)},t.Lerp=function(l,y,v){return new t(l.width+(y.width-l.width)*v,l.height+(y.height-l.height)*v)},t.prototype.toString=function(){return"{W: "+this.width+", H: "+this.height+"}"},t.prototype.getClassName=function(){return"Size"},t.prototype.getHashCode=function(){return 397*(this.width||0)^(this.height||0)},t.prototype.copyFrom=function(l){this.width=l.width,this.height=l.height},t.prototype.copyFromFloats=function(l,y){return this.width=l,this.height=y,this},t.prototype.set=function(l,y){return this.copyFromFloats(l,y)},t.prototype.multiplyByFloats=function(l,y){return new t(this.width*l,this.height*y)},t.prototype.clone=function(){return new t(this.width,this.height)},t.prototype.equals=function(l){return!!l&&this.width===l.width&&this.height===l.height},t.prototype.add=function(l){return new t(this.width+l.width,this.height+l.height)},t.prototype.subtract=function(l){return new t(this.width-l.width,this.height-l.height)},t}();y.Size=m},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.AudioStream=y.AudioSource=y.AudioClip=void 0;var C=v(0),w=v(5),O=function(l){function e(y){var v=l.call(this)||this;return v.loop=!1,v.volume=1,v.url=y,v}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"url",void 0),b([C.ObservableComponent.field],e.prototype,"loop",void 0),b([C.ObservableComponent.field],e.prototype,"loadingCompleteEventId",void 0),b([C.ObservableComponent.field],e.prototype,"volume",void 0),b([C.DisposableComponent("engine.AudioClip",w.CLASS_ID.AUDIO_CLIP)],e)}(C.ObservableComponent);y.AudioClip=O;var x=function(l){function e(y){var v=l.call(this)||this;if(v.audioClip=y,v.loop=!1,v.volume=1,v.playing=!1,v.pitch=1,v.playedAtTimestamp=Date.now(),!(y instanceof O))throw new Error("Trying to create AudioSource(AudioClip) with an invalid AudioClip");return v.audioClipId=C.getComponentId(y),v}return g(e,l),e.prototype.playOnce=function(){return this.playing=!0,this.dirty=!0,this.playedAtTimestamp=Date.now(),this.data.nonce=Math.random(),this},b([C.ObservableComponent.readonly],e.prototype,"audioClipId",void 0),b([C.ObservableComponent.field],e.prototype,"loop",void 0),b([C.ObservableComponent.field],e.prototype,"volume",void 0),b([C.ObservableComponent.field],e.prototype,"playing",void 0),b([C.ObservableComponent.field],e.prototype,"pitch",void 0),b([C.ObservableComponent.field],e.prototype,"playedAtTimestamp",void 0),b([C.Component("engine.AudioSource",w.CLASS_ID.AUDIO_SOURCE)],e)}(C.ObservableComponent);y.AudioSource=x;var A=function(l){function e(y){var v=l.call(this)||this;return v.playing=!1,v.volume=1,v.url=y,v.playing=!0,v}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"url",void 0),b([C.ObservableComponent.field],e.prototype,"playing",void 0),b([C.ObservableComponent.field],e.prototype,"volume",void 0),b([C.Component("engine.AudioStream",w.CLASS_ID.AUDIO_STREAM)],e)}(C.ObservableComponent);y.AudioStream=A},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.Gizmos=y.OnGizmoEvent=y.Gizmo=void 0;var C=v(0),w=v(5);!function(l){l.MOVE="MOVE",l.ROTATE="ROTATE",l.SCALE="SCALE",l.NONE="NONE"}(y.Gizmo||(y.Gizmo={}));var O=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.type="gizmoEvent",y}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.gizmoEvent",w.CLASS_ID.UUID_CALLBACK)],e)}(w.OnUUIDEvent);y.OnGizmoEvent=O;var x=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.position=!0,y.rotation=!0,y.scale=!0,y.cycle=!0,y.localReference=!1,y}return g(e,l),b([C.ObservableComponent.field],e.prototype,"position",void 0),b([C.ObservableComponent.field],e.prototype,"rotation",void 0),b([C.ObservableComponent.field],e.prototype,"scale",void 0),b([C.ObservableComponent.field],e.prototype,"cycle",void 0),b([C.ObservableComponent.field],e.prototype,"selectedGizmo",void 0),b([C.ObservableComponent.field],e.prototype,"localReference",void 0),b([C.Component("engine.gizmos",w.CLASS_ID.GIZMOS)],e)}(C.ObservableComponent);y.Gizmos=x},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.UIScrollRect=y.UIImage=y.UIInputText=y.UIText=y.UIButton=y.UIContainerStack=y.UIStackOrientation=y.UIContainerRect=y.UICanvas=y.UIWorldSpace=y.UIFullScreen=y.UIShape=void 0;var C=v(0),w=v(5),O=v(6),x=function(l){function e(y){var v=l.call(this)||this;return v.name=null,v.visible=!0,v.opacity=1,v.hAlign="center",v.vAlign="center",v.width="100px",v.height="50px",v.positionX="0px",v.positionY="0px",v.isPointerBlocker=!0,y&&(v._parent=y,v.data.parentComponent=C.getComponentId(y)),v}return g(e,l),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentComponent",{get:function(){return this.data.parentComponent},enumerable:!1,configurable:!0}),b([C.ObservableComponent.field],e.prototype,"name",void 0),b([C.ObservableComponent.field],e.prototype,"visible",void 0),b([C.ObservableComponent.field],e.prototype,"opacity",void 0),b([C.ObservableComponent.field],e.prototype,"hAlign",void 0),b([C.ObservableComponent.field],e.prototype,"vAlign",void 0),b([C.ObservableComponent.uiValue],e.prototype,"width",void 0),b([C.ObservableComponent.uiValue],e.prototype,"height",void 0),b([C.ObservableComponent.uiValue],e.prototype,"positionX",void 0),b([C.ObservableComponent.uiValue],e.prototype,"positionY",void 0),b([C.ObservableComponent.field],e.prototype,"isPointerBlocker",void 0),e}(C.ObservableComponent);y.UIShape=x;var A=function(l){function e(){return l.call(this,null)||this}return g(e,l),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_FULLSCREEN_SHAPE)],e)}(x);y.UIFullScreen=A;var S=function(l){function e(){return l.call(this,null)||this}return g(e,l),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_WORLD_SPACE_SHAPE)],e)}(x);y.UIWorldSpace=S;var E=function(l){function e(){return l.call(this,null)||this}return g(e,l),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_SCREEN_SPACE_SHAPE)],e)}(x);y.UICanvas=E;var T,R=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.adaptWidth=!1,y.adaptHeight=!1,y.thickness=0,y.color=O.Color4.Clear(),y.alignmentUsesSize=!0,y}return g(e,l),b([C.ObservableComponent.field],e.prototype,"adaptWidth",void 0),b([C.ObservableComponent.field],e.prototype,"adaptHeight",void 0),b([C.ObservableComponent.field],e.prototype,"thickness",void 0),b([C.ObservableComponent.field],e.prototype,"color",void 0),b([C.ObservableComponent.field],e.prototype,"alignmentUsesSize",void 0),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_CONTAINER_RECT)],e)}(x);y.UIContainerRect=R,function(l){l[l.VERTICAL=0]="VERTICAL",l[l.HORIZONTAL=1]="HORIZONTAL"}(T=y.UIStackOrientation||(y.UIStackOrientation={}));var I=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.adaptWidth=!0,y.adaptHeight=!0,y.color=O.Color4.Clear(),y.stackOrientation=T.VERTICAL,y.spacing=0,y}return g(e,l),b([C.ObservableComponent.field],e.prototype,"adaptWidth",void 0),b([C.ObservableComponent.field],e.prototype,"adaptHeight",void 0),b([C.ObservableComponent.field],e.prototype,"color",void 0),b([C.ObservableComponent.field],e.prototype,"stackOrientation",void 0),b([C.ObservableComponent.field],e.prototype,"spacing",void 0),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_CONTAINER_STACK)],e)}(x);y.UIContainerStack=I;var P=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.fontSize=10,y.fontWeight="normal",y.thickness=0,y.cornerRadius=0,y.color=O.Color4.White(),y.background=O.Color4.White(),y.paddingTop=0,y.paddingRight=0,y.paddingBottom=0,y.paddingLeft=0,y.shadowBlur=0,y.shadowOffsetX=0,y.shadowOffsetY=0,y.shadowColor=O.Color4.Black(),y.text="button",y}return g(e,l),b([C.ObservableComponent.field],e.prototype,"fontSize",void 0),b([C.ObservableComponent.field],e.prototype,"fontWeight",void 0),b([C.ObservableComponent.field],e.prototype,"thickness",void 0),b([C.ObservableComponent.field],e.prototype,"cornerRadius",void 0),b([C.ObservableComponent.field],e.prototype,"color",void 0),b([C.ObservableComponent.field],e.prototype,"background",void 0),b([C.ObservableComponent.field],e.prototype,"paddingTop",void 0),b([C.ObservableComponent.field],e.prototype,"paddingRight",void 0),b([C.ObservableComponent.field],e.prototype,"paddingBottom",void 0),b([C.ObservableComponent.field],e.prototype,"paddingLeft",void 0),b([C.ObservableComponent.field],e.prototype,"shadowBlur",void 0),b([C.ObservableComponent.field],e.prototype,"shadowOffsetX",void 0),b([C.ObservableComponent.field],e.prototype,"shadowOffsetY",void 0),b([C.ObservableComponent.field],e.prototype,"shadowColor",void 0),b([C.ObservableComponent.field],e.prototype,"text",void 0),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_BUTTON_SHAPE)],e)}(x);y.UIButton=P;var M=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.outlineWidth=0,y.outlineColor=O.Color4.White(),y.color=O.Color4.White(),y.fontSize=10,y.fontAutoSize=!1,y.fontWeight="normal",y.value="",y.lineSpacing=0,y.lineCount=0,y.adaptWidth=!1,y.adaptHeight=!1,y.textWrapping=!1,y.shadowBlur=0,y.shadowOffsetX=0,y.shadowOffsetY=0,y.shadowColor=O.Color4.Black(),y.hTextAlign="left",y.vTextAlign="bottom",y.paddingTop=0,y.paddingRight=0,y.paddingBottom=0,y.paddingLeft=0,y}return g(e,l),b([C.ObservableComponent.field],e.prototype,"outlineWidth",void 0),b([C.ObservableComponent.field],e.prototype,"outlineColor",void 0),b([C.ObservableComponent.field],e.prototype,"color",void 0),b([C.ObservableComponent.field],e.prototype,"fontSize",void 0),b([C.ObservableComponent.field],e.prototype,"fontAutoSize",void 0),b([C.ObservableComponent.field],e.prototype,"fontWeight",void 0),b([C.ObservableComponent.component],e.prototype,"font",void 0),b([C.ObservableComponent.field],e.prototype,"value",void 0),b([C.ObservableComponent.field],e.prototype,"lineSpacing",void 0),b([C.ObservableComponent.field],e.prototype,"lineCount",void 0),b([C.ObservableComponent.field],e.prototype,"adaptWidth",void 0),b([C.ObservableComponent.field],e.prototype,"adaptHeight",void 0),b([C.ObservableComponent.field],e.prototype,"textWrapping",void 0),b([C.ObservableComponent.field],e.prototype,"shadowBlur",void 0),b([C.ObservableComponent.field],e.prototype,"shadowOffsetX",void 0),b([C.ObservableComponent.field],e.prototype,"shadowOffsetY",void 0),b([C.ObservableComponent.field],e.prototype,"shadowColor",void 0),b([C.ObservableComponent.field],e.prototype,"hTextAlign",void 0),b([C.ObservableComponent.field],e.prototype,"vTextAlign",void 0),b([C.ObservableComponent.field],e.prototype,"paddingTop",void 0),b([C.ObservableComponent.field],e.prototype,"paddingRight",void 0),b([C.ObservableComponent.field],e.prototype,"paddingBottom",void 0),b([C.ObservableComponent.field],e.prototype,"paddingLeft",void 0),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_TEXT_SHAPE)],e)}(x);y.UIText=M;var z=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.outlineWidth=0,y.outlineColor=O.Color4.Black(),y.color=O.Color4.Clear(),y.thickness=1,y.fontSize=10,y.fontWeight="normal",y.value="",y.placeholderColor=O.Color4.White(),y.placeholder="",y.margin=10,y.maxWidth=100,y.hTextAlign="left",y.vTextAlign="bottom",y.autoStretchWidth=!0,y.background=O.Color4.Black(),y.focusedBackground=O.Color4.Black(),y.textWrapping=!1,y.shadowBlur=0,y.shadowOffsetX=0,y.shadowOffsetY=0,y.shadowColor=O.Color4.White(),y.paddingTop=0,y.paddingRight=0,y.paddingBottom=0,y.paddingLeft=0,y.onTextSubmit=null,y.onChanged=null,y.onFocus=null,y.onBlur=null,y}return g(e,l),b([C.ObservableComponent.field],e.prototype,"outlineWidth",void 0),b([C.ObservableComponent.field],e.prototype,"outlineColor",void 0),b([C.ObservableComponent.field],e.prototype,"color",void 0),b([C.ObservableComponent.field],e.prototype,"thickness",void 0),b([C.ObservableComponent.field],e.prototype,"fontSize",void 0),b([C.ObservableComponent.field],e.prototype,"fontWeight",void 0),b([C.ObservableComponent.component],e.prototype,"font",void 0),b([C.ObservableComponent.field],e.prototype,"value",void 0),b([C.ObservableComponent.field],e.prototype,"placeholderColor",void 0),b([C.ObservableComponent.field],e.prototype,"placeholder",void 0),b([C.ObservableComponent.field],e.prototype,"margin",void 0),b([C.ObservableComponent.field],e.prototype,"maxWidth",void 0),b([C.ObservableComponent.field],e.prototype,"hTextAlign",void 0),b([C.ObservableComponent.field],e.prototype,"vTextAlign",void 0),b([C.ObservableComponent.field],e.prototype,"autoStretchWidth",void 0),b([C.ObservableComponent.field],e.prototype,"background",void 0),b([C.ObservableComponent.field],e.prototype,"focusedBackground",void 0),b([C.ObservableComponent.field],e.prototype,"textWrapping",void 0),b([C.ObservableComponent.field],e.prototype,"shadowBlur",void 0),b([C.ObservableComponent.field],e.prototype,"shadowOffsetX",void 0),b([C.ObservableComponent.field],e.prototype,"shadowOffsetY",void 0),b([C.ObservableComponent.field],e.prototype,"shadowColor",void 0),b([C.ObservableComponent.field],e.prototype,"paddingTop",void 0),b([C.ObservableComponent.field],e.prototype,"paddingRight",void 0),b([C.ObservableComponent.field],e.prototype,"paddingBottom",void 0),b([C.ObservableComponent.field],e.prototype,"paddingLeft",void 0),b([w.OnUUIDEvent.uuidEvent],e.prototype,"onTextSubmit",void 0),b([w.OnUUIDEvent.uuidEvent],e.prototype,"onChanged",void 0),b([w.OnUUIDEvent.uuidEvent],e.prototype,"onFocus",void 0),b([w.OnUUIDEvent.uuidEvent],e.prototype,"onBlur",void 0),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_INPUT_TEXT_SHAPE)],e)}(x);y.UIInputText=z;var D=function(l){function e(y,v){var m=l.call(this,y)||this;return m.sourceLeft=0,m.sourceTop=0,m.sourceWidth=1,m.sourceHeight=1,m.paddingTop=0,m.paddingRight=0,m.paddingBottom=0,m.paddingLeft=0,m.sizeInPixels=!0,m.onClick=null,m.source=v,m}return g(e,l),b([C.ObservableComponent.field],e.prototype,"sourceLeft",void 0),b([C.ObservableComponent.field],e.prototype,"sourceTop",void 0),b([C.ObservableComponent.field],e.prototype,"sourceWidth",void 0),b([C.ObservableComponent.field],e.prototype,"sourceHeight",void 0),b([C.ObservableComponent.component],e.prototype,"source",void 0),b([C.ObservableComponent.field],e.prototype,"paddingTop",void 0),b([C.ObservableComponent.field],e.prototype,"paddingRight",void 0),b([C.ObservableComponent.field],e.prototype,"paddingBottom",void 0),b([C.ObservableComponent.field],e.prototype,"paddingLeft",void 0),b([C.ObservableComponent.field],e.prototype,"sizeInPixels",void 0),b([w.OnUUIDEvent.uuidEvent],e.prototype,"onClick",void 0),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_IMAGE_SHAPE)],e)}(x);y.UIImage=D;var F=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.valueX=0,y.valueY=0,y.borderColor=O.Color4.White(),y.backgroundColor=O.Color4.Clear(),y.isHorizontal=!1,y.isVertical=!1,y.paddingTop=0,y.paddingRight=0,y.paddingBottom=0,y.paddingLeft=0,y.onChanged=null,y}return g(e,l),b([C.ObservableComponent.field],e.prototype,"valueX",void 0),b([C.ObservableComponent.field],e.prototype,"valueY",void 0),b([C.ObservableComponent.field],e.prototype,"borderColor",void 0),b([C.ObservableComponent.field],e.prototype,"backgroundColor",void 0),b([C.ObservableComponent.field],e.prototype,"isHorizontal",void 0),b([C.ObservableComponent.field],e.prototype,"isVertical",void 0),b([C.ObservableComponent.field],e.prototype,"paddingTop",void 0),b([C.ObservableComponent.field],e.prototype,"paddingRight",void 0),b([C.ObservableComponent.field],e.prototype,"paddingBottom",void 0),b([C.ObservableComponent.field],e.prototype,"paddingLeft",void 0),b([w.OnUUIDEvent.uuidEvent],e.prototype,"onChanged",void 0),b([C.DisposableComponent("engine.shape",w.CLASS_ID.UI_SLIDER_SHAPE)],e)}(x);y.UIScrollRect=F},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.AvatarShape=void 0;var C=v(0),w=v(5),O=function(l){function e(){var y=null!==l&&l.apply(this,arguments)||this;return y.useDummyModel=!1,y.talking=!1,y}var y;return g(e,l),y=e,e.Dummy=function(){var l=new y;return l.useDummyModel=!0,l},b([C.ObservableComponent.field],e.prototype,"id",void 0),b([C.ObservableComponent.field],e.prototype,"name",void 0),b([C.ObservableComponent.field],e.prototype,"expressionTriggerId",void 0),b([C.ObservableComponent.field],e.prototype,"expressionTriggerTimestamp",void 0),b([C.ObservableComponent.field],e.prototype,"bodyShape",void 0),b([C.ObservableComponent.field],e.prototype,"wearables",void 0),b([C.ObservableComponent.field],e.prototype,"skinColor",void 0),b([C.ObservableComponent.field],e.prototype,"hairColor",void 0),b([C.ObservableComponent.field],e.prototype,"eyeColor",void 0),b([C.ObservableComponent.field],e.prototype,"useDummyModel",void 0),b([C.ObservableComponent.field],e.prototype,"talking",void 0),y=b([C.Component("engine.avatarShape",w.CLASS_ID.AVATAR_SHAPE)],e)}(C.ObservableComponent);y.AvatarShape=O},function(l,y,v){"use strict";var m,g=this&&this.__extends||(m=function(l,y){return(m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)},function(l,y){function n(){this.constructor=l}m(l,y),l.prototype=null===y?Object.create(y):(n.prototype=y.prototype,new n)}),b=this&&this.__decorate||function(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C};Object.defineProperty(y,"__esModule",{value:!0}),y.OnPointerUp=y.OnPointerDown=y.OnClick=y.OnChanged=y.OnEnter=y.OnBlur=y.OnTextSubmit=y.OnFocus=void 0;var C=v(0),w=v(16),O=v(5),x=function(l){function e(y){var v=l.call(this,y)||this;return v.type="onFocus",w.uuidEventSystem.handlerMap[v.uuid]=v,v}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.onFocus",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnUUIDEvent);y.OnFocus=x;var A=function(l){function e(y){var v=l.call(this,y)||this;return v.type="onTextSubmit",w.uuidEventSystem.handlerMap[v.uuid]=v,v}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.onTextSubmit",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnUUIDEvent);y.OnTextSubmit=A;var S=function(l){function e(y){var v=l.call(this,y)||this;return v.type="onBlur",w.uuidEventSystem.handlerMap[v.uuid]=v,v}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.onBlur",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnUUIDEvent);y.OnBlur=S;var E=function(l){function e(y){var v=l.call(this,y)||this;return v.type="onEnter",w.uuidEventSystem.handlerMap[v.uuid]=v,v}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.onEnter",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnUUIDEvent);y.OnEnter=E;var T=function(l){function e(y){var v=l.call(this,y)||this;return v.type="onChange",w.uuidEventSystem.handlerMap[v.uuid]=v,v}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.onChange",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnUUIDEvent);y.OnChanged=T;var R=function(l){function e(y,v){var m=l.call(this,y)||this;return m.type="onClick",w.uuidEventSystem.handlerMap[m.uuid]=m,v&&(m.showFeedback=!(!1===v.showFeedback),v.button&&(m.button=v.button),v.hoverText&&(m.hoverText=v.hoverText),v.distance&&(m.distance=v.distance)),m}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.onClick",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnPointerUUIDEvent);y.OnClick=R;var I=function(l){function e(y,v){var m=l.call(this,y)||this;return m.type="pointerDown",w.uuidEventSystem.handlerMap[m.uuid]=m,v&&(m.showFeedback=!(!1===v.showFeedback),v.button&&(m.button=v.button),v.hoverText&&(m.hoverText=v.hoverText),v.distance&&(m.distance=v.distance)),m}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.pointerDown",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnPointerUUIDEvent);y.OnPointerDown=I;var P=function(l){function e(y,v){var m=l.call(this,y)||this;return m.type="pointerUp",w.uuidEventSystem.handlerMap[m.uuid]=m,v&&(m.showFeedback=!(!1===v.showFeedback),v.button&&(m.button=v.button),v.hoverText&&(m.hoverText=v.hoverText),v.distance&&(m.distance=v.distance)),m}return g(e,l),b([C.ObservableComponent.readonly],e.prototype,"type",void 0),b([C.Component("engine.pointerUp",O.CLASS_ID.UUID_CALLBACK)],e)}(O.OnPointerUUIDEvent);y.OnPointerUp=P},function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.MessageBus=y.getMessageObserver=void 0;var m=v(15),g=v(1),b=null,C=null,w=null;function p(){return w||(w=new m.Observable),w}y.getMessageObserver=p;var O=function(){function t(){var l=this;this.messageQueue=[],this.connected=!1,this.flushing=!1,function(){if(!C){(C=dcl.loadModule("@decentraland/CommunicationsController")).then((function(l){b=l}));var l=p();dcl.subscribe("comms"),dcl.onEvent((function(y){"comms"===y.type&&l.notifyObservers(y.data)}))}return C}().then((function(y){l.connected=!0,l.flush()}))}return t.prototype.on=function(l,y){return p().add((function(v){try{var m=JSON.parse(v.message);m.message===l&&y(m.payload,v.sender)}catch(v){dcl.error("Error parsing comms message "+v.message,v)}}))},t.prototype.sendRaw=function(l){this.messageQueue.push(l),this.connected&&this.flush()},t.prototype.emit=function(l,y){var v=JSON.stringify({message:l,payload:y});this.sendRaw(v),p().notifyObservers({message:v,sender:"self"})},t.prototype.flush=function(){var l=this;if(0!==this.messageQueue.length&&this.connected&&b&&!this.flushing){var y=this.messageQueue.shift();this.flushing=!0,dcl.callRpc(b.rpcHandle,"send",[y]).then((function(y){l.flushing=!1,l.flush()}),(function(y){l.flushing=!1,g.error("Error flushing MessageBus",y)}))}},t}();y.MessageBus=O}]));var loader,getGlobalThis=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==this)return this;throw new Error("Unable to locate global `this`")},globalObject=getGlobalThis();!function(l){"use strict";var y=[],v={baseUrl:""},m={};function o(l,y,v){return void 0===v&&(v=[]),{name:l,dclamd:1,handlers:v,context:y,exports:{}}}function f(l,g,b){var C=arguments.length;function s(){var v,g;m[l]?(v=m[l].handlers,g=m[l].context):m[l]=o(l);var C=m[l];C.exports="function"==typeof b?b.apply(null,y.slice.call(arguments,0))||m[l].exports||{}:b,C.dclamd=2,C.context=g;for(var w=0,O=v?v.length:0;w<O;w++)v[w](C.exports)}1===C?(b=l,g=["require","exports","module"],l=null):2===C&&("[object Array]"===v.toString.call(l)?(b=g,g=l,l=null):(b=g,g=["require","exports","module"])),l?(m[l]||(m[l]=o(l)),d(l),m[l].dependencies=g.map((function(y){return h(y,l)})),u(g,s,l)):y.push([g,b])}function d(l){var y,v=l.split("/");if("index"===v[v.length-1]&&v.length>1){v.pop();var g=v.join("/"),b=m[g];m[g]=m[l],b&&(m[g].context=b.context,(y=m[g].handlers).push.apply(y,b.handlers))}}function u(l,y,v){var g=[],b=0,C=!1;if("string"==typeof l){if(m[l]&&2===m[l].dclamd)return m[l];throw new Error(l+" has not been defined. Please include it as a dependency in "+v+"'s define()")}for(var w=l.length,d=function(O){switch(l[O]){case"require":var d=function(l,y){return u(l,y,v)};d.toUrl=function(l){return h(l,v)},g[O]=d,b++;break;case"exports":g[O]=m[v].exports,b++;break;case"module":g[O]={id:v,uri:h(v)},b++;break;default:!function(l,y){if(!m[l]||!m[l].dependencies)return!1;var v=m[l].dependencies,g=[l,"require","exports","module"];if(-1!==g.indexOf(y))return!0;for(var b=v.filter((function(l){return-1===g.indexOf(l)}));b.length>0;){if(-1!==b.indexOf(y))return!0;var C=b.shift();g.push(C);var w=m[C];if(w&&w.dependencies)for(var O=0;O<w.dependencies.length;O++){var x=w.dependencies[O];-1===g.indexOf(x)&&-1===b.indexOf(x)&&b.push(x)}}return!1}(l[O],v)?p(l[O],(function(l){g[O]=l,++b===w&&y&&(C=!0,y.apply(null,g))}),v):(g[O]=m[l[O]].exports,b++)}},O=0;O<w;O++)d(O);!C&&b===w&&y&&y.apply(null,g)}function c(l,v){return function(){return dcl.callRpc(l,v.name,y.slice.call(arguments,0))}}function p(l,y,v){if(l=v?h(l,v):l,m[l])1===m[l].dclamd?y&&m[l].handlers.push(y):y&&y(m[l].exports);else{var g=m[l]=o(l,v,[y]);0===l.indexOf("@")&&"undefined"!=typeof dcl&&dcl.loadModule(l).then((function(l){var y={};for(var v in l.methods){var m=l.methods[v];y[m.name]=c(l.rpcHandle,m)}g.dclamd=2,g.exports=y;var b=g.handlers;for(v=0;v<b.length;v++)b[v](y)}))}}function h(l,y){var m=!1;switch(l){case"require":case"exports":case"module":return l}var g=(y||v.baseUrl).split("/");g.pop();for(var b=l.split("/"),C=b.length;--C;)switch(b[0]){case"..":g.pop();case".":case"":b.shift(),m=!0}return(g.length&&m?g.join("/")+"/":"")+b.join("/")}l.config=function(l){if("object"==typeof l)for(var y in l)l.hasOwnProperty(y)&&(v[y]=l[y])},l.define=f,function(l){l.amd={}}(f=l.define||(l.define={})),l.require=u,"undefined"!=typeof dcl&&dcl.onStart((function(){var l=[];for(var y in m)m[y]&&1===m[y].dclamd&&l.push(m[y]);if(l.length)throw new Error("These modules didn't load: "+l.map((function(l){return l.name})).join(", "))})),u.toUrl=h}(loader||(loader={})),globalObject.define=loader.define,globalObject.dclamd=loader,function(global,l){"object"==typeof exports&&"undefined"!=typeof module?l(exports):"function"==typeof define&&define.amd?define("colyseus.js",["exports"],l):l((global="undefined"!=typeof globalThis?globalThis:global||self).Colyseus={})}(this,(function(l){"use strict";ArrayBuffer.isView||(ArrayBuffer.isView=function(l){return null!==l&&"object"==typeof l&&l.buffer instanceof ArrayBuffer}),"undefined"==typeof globalThis&&"undefined"!=typeof window&&(window.globalThis=window)
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */;var extendStatics=function(l,y){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)};function __extends(l,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function __(){this.constructor=l}extendStatics(l,y),l.prototype=null===y?Object.create(y):(__.prototype=y.prototype,new __)}function __awaiter(l,y,v,m){return new(v||(v=Promise))((function(g,b){function fulfilled(l){try{step(m.next(l))}catch(l){b(l)}}function rejected(l){try{step(m.throw(l))}catch(l){b(l)}}function step(l){var y;l.done?g(l.value):(y=l.value,y instanceof v?y:new v((function(l){l(y)}))).then(fulfilled,rejected)}step((m=m.apply(l,y||[])).next())}))}function __generator(l,y){var v,m,g,b,C={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return b={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function verb(b){return function(w){return function(b){if(v)throw new TypeError("Generator is already executing.");for(;C;)try{if(v=1,m&&(g=2&b[0]?m.return:b[0]?m.throw||((g=m.return)&&g.call(m),0):m.next)&&!(g=g.call(m,b[1])).done)return g;switch(m=0,g&&(b=[2&b[0],g.value]),b[0]){case 0:case 1:g=b;break;case 4:return C.label++,{value:b[1],done:!1};case 5:C.label++,m=b[1],b=[0];continue;case 7:b=C.ops.pop(),C.trys.pop();continue;default:if(!((g=(g=C.trys).length>0&&g[g.length-1])||6!==b[0]&&2!==b[0])){C=0;continue}if(3===b[0]&&(!g||b[1]>g[0]&&b[1]<g[3])){C.label=b[1];break}if(6===b[0]&&C.label<g[1]){C.label=g[1],g=b;break}if(g&&C.label<g[2]){C.label=g[2],C.ops.push(b);break}g[2]&&C.ops.pop(),C.trys.pop();continue}b=y.call(l,C)}catch(l){b=[6,l],m=0}finally{v=g=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,w])}}}function apply(l,y){y.statusMessage=l.statusText,y.statusCode=l.status,y.data=l.body}function send(l,y,v){var m,g,b=(v=v||{}).body;return v.method=l,v.headers=v.headers||{},b instanceof FormData||b&&"object"==typeof b&&(v.headers["content-type"]="application/json",v.body=JSON.stringify(b)),v.withCredentials&&(v.credentials="include"),v.timeout&&(g=new AbortController,v.signal=g.signal,m=setTimeout(g.abort,v.timeout)),new Promise(((l,C)=>{fetch(y,v).then(((y,g)=>{clearTimeout(m),apply(y,y),g=y.status>=400?C:l,(b=y.headers.get("content-type"))&&~b.indexOf("application/json")?y.text().then((l=>{try{y.data=JSON.parse(l,v.reviver),g(y)}catch(l){l.headers=y.headers,apply(y,l),C(l)}})):g(y)})).catch((l=>{l.timeout=g&&g.signal.aborted,C(l)}))}))}var y=send.bind(send,"GET"),v=send.bind(send,"POST"),m=send.bind(send,"PATCH"),g=send.bind(send,"DELETE"),b=y,C=m,w=v,O=send.bind(send,"PUT"),x=send,A={del:g,get:b,patch:C,post:w,put:O,send:x},S=Object.freeze(Object.assign(Object.create(null),A,{default:A,del:g,get:b,patch:C,post:w,put:O,send:x})),E=function(l){function ServerError(y,v){var m=l.call(this,v)||this;return m.name="ServerError",m.code=y,m}return __extends(ServerError,l),ServerError}(Error);function Decoder(l,y){if(this._offset=y,l instanceof ArrayBuffer)this._buffer=l,this._view=new DataView(this._buffer);else{if(!ArrayBuffer.isView(l))throw new Error("Invalid argument");this._buffer=l.buffer,this._view=new DataView(this._buffer,l.byteOffset,l.byteLength)}}function utf8Write(l,y,v){for(var m=0,g=0,b=v.length;g<b;g++)(m=v.charCodeAt(g))<128?l.setUint8(y++,m):m<2048?(l.setUint8(y++,192|m>>6),l.setUint8(y++,128|63&m)):m<55296||m>=57344?(l.setUint8(y++,224|m>>12),l.setUint8(y++,128|m>>6&63),l.setUint8(y++,128|63&m)):(g++,m=65536+((1023&m)<<10|1023&v.charCodeAt(g)),l.setUint8(y++,240|m>>18),l.setUint8(y++,128|m>>12&63),l.setUint8(y++,128|m>>6&63),l.setUint8(y++,128|63&m))}function _encode(l,y,v){var m=typeof v,g=0,b=0,C=0,w=0,O=0,x=0;if("string"===m){if((O=function(l){for(var y=0,v=0,m=0,g=l.length;m<g;m++)(y=l.charCodeAt(m))<128?v+=1:y<2048?v+=2:y<55296||y>=57344?v+=3:(m++,v+=4);return v}(v))<32)l.push(160|O),x=1;else if(O<256)l.push(217,O),x=2;else if(O<65536)l.push(218,O>>8,O),x=3;else{if(!(O<4294967296))throw new Error("String too long");l.push(219,O>>24,O>>16,O>>8,O),x=5}return y.push({_str:v,_length:O,_offset:l.length}),x+O}if("number"===m)return Math.floor(v)===v&&isFinite(v)?v>=0?v<128?(l.push(v),1):v<256?(l.push(204,v),2):v<65536?(l.push(205,v>>8,v),3):v<4294967296?(l.push(206,v>>24,v>>16,v>>8,v),5):(C=v/Math.pow(2,32)>>0,w=v>>>0,l.push(207,C>>24,C>>16,C>>8,C,w>>24,w>>16,w>>8,w),9):v>=-32?(l.push(v),1):v>=-128?(l.push(208,v),2):v>=-32768?(l.push(209,v>>8,v),3):v>=-2147483648?(l.push(210,v>>24,v>>16,v>>8,v),5):(C=Math.floor(v/Math.pow(2,32)),w=v>>>0,l.push(211,C>>24,C>>16,C>>8,C,w>>24,w>>16,w>>8,w),9):(l.push(203),y.push({_float:v,_length:8,_offset:l.length}),9);if("object"===m){if(null===v)return l.push(192),1;if(Array.isArray(v)){if((O=v.length)<16)l.push(144|O),x=1;else if(O<65536)l.push(220,O>>8,O),x=3;else{if(!(O<4294967296))throw new Error("Array too large");l.push(221,O>>24,O>>16,O>>8,O),x=5}for(g=0;g<O;g++)x+=_encode(l,y,v[g]);return x}if(v instanceof Date){var A=v.getTime();return C=Math.floor(A/Math.pow(2,32)),w=A>>>0,l.push(215,0,C>>24,C>>16,C>>8,C,w>>24,w>>16,w>>8,w),10}if(v instanceof ArrayBuffer){if((O=v.byteLength)<256)l.push(196,O),x=2;else if(O<65536)l.push(197,O>>8,O),x=3;else{if(!(O<4294967296))throw new Error("Buffer too large");l.push(198,O>>24,O>>16,O>>8,O),x=5}return y.push({_bin:v,_length:O,_offset:l.length}),x+O}if("function"==typeof v.toJSON)return _encode(l,y,v.toJSON());var S=[],E="",T=Object.keys(v);for(g=0,b=T.length;g<b;g++)"function"!=typeof v[E=T[g]]&&S.push(E);if((O=S.length)<16)l.push(128|O),x=1;else if(O<65536)l.push(222,O>>8,O),x=3;else{if(!(O<4294967296))throw new Error("Object too large");l.push(223,O>>24,O>>16,O>>8,O),x=5}for(g=0;g<O;g++)x+=_encode(l,y,E=S[g]),x+=_encode(l,y,v[E]);return x}if("boolean"===m)return l.push(v?195:194),1;if("undefined"===m)return l.push(212,0,0),3;throw new Error("Could not encode")}function encode(l){var y=[],v=[],m=_encode(y,v,l),g=new ArrayBuffer(m),b=new DataView(g),C=0,w=0,O=-1;v.length>0&&(O=v[0]._offset);for(var x,A=0,S=0,E=0,T=y.length;E<T;E++)if(b.setUint8(w+E,y[E]),E+1===O){if(A=(x=v[C])._length,S=w+O,x._bin)for(var R=new Uint8Array(x._bin),I=0;I<A;I++)b.setUint8(S+I,R[I]);else x._str?utf8Write(b,S,x._str):void 0!==x._float&&b.setFloat64(S,x._float);w+=A,v[++C]&&(O=v[C]._offset)}return g}Decoder.prototype._array=function(l){for(var y=new Array(l),v=0;v<l;v++)y[v]=this._parse();return y},Decoder.prototype._map=function(l){for(var y={},v=0;v<l;v++)y[this._parse()]=this._parse();return y},Decoder.prototype._str=function(l){var y=function(l,y,v){for(var m="",g=0,b=y,C=y+v;b<C;b++){var w=l.getUint8(b);if(0!=(128&w))if(192!=(224&w))if(224!=(240&w)){if(240!=(248&w))throw new Error("Invalid byte "+w.toString(16));(g=(7&w)<<18|(63&l.getUint8(++b))<<12|(63&l.getUint8(++b))<<6|(63&l.getUint8(++b))<<0)>=65536?(g-=65536,m+=String.fromCharCode(55296+(g>>>10),56320+(1023&g))):m+=String.fromCharCode(g)}else m+=String.fromCharCode((15&w)<<12|(63&l.getUint8(++b))<<6|(63&l.getUint8(++b))<<0);else m+=String.fromCharCode((31&w)<<6|63&l.getUint8(++b));else m+=String.fromCharCode(w)}return m}(this._view,this._offset,l);return this._offset+=l,y},Decoder.prototype._bin=function(l){var y=this._buffer.slice(this._offset,this._offset+l);return this._offset+=l,y},Decoder.prototype._parse=function(){var l,y=this._view.getUint8(this._offset++),v=0,m=0,g=0,b=0;if(y<192)return y<128?y:y<144?this._map(15&y):y<160?this._array(15&y):this._str(31&y);if(y>223)return-1*(255-y+1);switch(y){case 192:return null;case 194:return!1;case 195:return!0;case 196:return v=this._view.getUint8(this._offset),this._offset+=1,this._bin(v);case 197:return v=this._view.getUint16(this._offset),this._offset+=2,this._bin(v);case 198:return v=this._view.getUint32(this._offset),this._offset+=4,this._bin(v);case 199:return v=this._view.getUint8(this._offset),m=this._view.getInt8(this._offset+1),this._offset+=2,[m,this._bin(v)];case 200:return v=this._view.getUint16(this._offset),m=this._view.getInt8(this._offset+2),this._offset+=3,[m,this._bin(v)];case 201:return v=this._view.getUint32(this._offset),m=this._view.getInt8(this._offset+4),this._offset+=5,[m,this._bin(v)];case 202:return l=this._view.getFloat32(this._offset),this._offset+=4,l;case 203:return l=this._view.getFloat64(this._offset),this._offset+=8,l;case 204:return l=this._view.getUint8(this._offset),this._offset+=1,l;case 205:return l=this._view.getUint16(this._offset),this._offset+=2,l;case 206:return l=this._view.getUint32(this._offset),this._offset+=4,l;case 207:return g=this._view.getUint32(this._offset)*Math.pow(2,32),b=this._view.getUint32(this._offset+4),this._offset+=8,g+b;case 208:return l=this._view.getInt8(this._offset),this._offset+=1,l;case 209:return l=this._view.getInt16(this._offset),this._offset+=2,l;case 210:return l=this._view.getInt32(this._offset),this._offset+=4,l;case 211:return g=this._view.getInt32(this._offset)*Math.pow(2,32),b=this._view.getUint32(this._offset+4),this._offset+=8,g+b;case 212:return m=this._view.getInt8(this._offset),this._offset+=1,0===m?void(this._offset+=1):[m,this._bin(1)];case 213:return m=this._view.getInt8(this._offset),this._offset+=1,[m,this._bin(2)];case 214:return m=this._view.getInt8(this._offset),this._offset+=1,[m,this._bin(4)];case 215:return m=this._view.getInt8(this._offset),this._offset+=1,0===m?(g=this._view.getInt32(this._offset)*Math.pow(2,32),b=this._view.getUint32(this._offset+4),this._offset+=8,new Date(g+b)):[m,this._bin(8)];case 216:return m=this._view.getInt8(this._offset),this._offset+=1,[m,this._bin(16)];case 217:return v=this._view.getUint8(this._offset),this._offset+=1,this._str(v);case 218:return v=this._view.getUint16(this._offset),this._offset+=2,this._str(v);case 219:return v=this._view.getUint32(this._offset),this._offset+=4,this._str(v);case 220:return v=this._view.getUint16(this._offset),this._offset+=2,this._array(v);case 221:return v=this._view.getUint32(this._offset),this._offset+=4,this._array(v);case 222:return v=this._view.getUint16(this._offset),this._offset+=2,this._map(v);case 223:return v=this._view.getUint32(this._offset),this._offset+=4,this._map(v)}throw new Error("Could not parse")};var T,R,I=globalThis.WebSocket||function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")},P=function(){function WebSocketTransport(l){this.events=l}return WebSocketTransport.prototype.send=function(l){l instanceof ArrayBuffer?this.ws.send(l):Array.isArray(l)&&this.ws.send(new Uint8Array(l).buffer)},WebSocketTransport.prototype.connect=function(l){this.ws=new I(l,this.protocols),this.ws.binaryType="arraybuffer",this.ws.onopen=this.events.onopen,this.ws.onmessage=this.events.onmessage,this.ws.onclose=this.events.onclose,this.ws.onerror=this.events.onerror},WebSocketTransport.prototype.close=function(l,y){this.ws.close(l,y)},WebSocketTransport}(),M=function(){function Connection(){this.events={},this.transport=new P(this.events)}return Connection.prototype.send=function(l){this.transport.send(l)},Connection.prototype.connect=function(l){this.transport.connect(l)},Connection.prototype.close=function(l,y){this.transport.close(l,y)},Connection}(),z={};function registerSerializer(l,y){z[l]=y}function getSerializer(l){var y=z[l];if(!y)throw new Error("missing serializer: "+l);return y}l.Protocol=void 0,(T=l.Protocol||(l.Protocol={}))[T.HANDSHAKE=9]="HANDSHAKE",T[T.JOIN_ROOM=10]="JOIN_ROOM",T[T.ERROR=11]="ERROR",T[T.LEAVE_ROOM=12]="LEAVE_ROOM",T[T.ROOM_DATA=13]="ROOM_DATA",T[T.ROOM_STATE=14]="ROOM_STATE",T[T.ROOM_STATE_PATCH=15]="ROOM_STATE_PATCH",T[T.ROOM_DATA_SCHEMA=16]="ROOM_DATA_SCHEMA",l.ErrorCode=void 0,(R=l.ErrorCode||(l.ErrorCode={}))[R.MATCHMAKE_NO_HANDLER=4210]="MATCHMAKE_NO_HANDLER",R[R.MATCHMAKE_INVALID_CRITERIA=4211]="MATCHMAKE_INVALID_CRITERIA",R[R.MATCHMAKE_INVALID_ROOM_ID=4212]="MATCHMAKE_INVALID_ROOM_ID",R[R.MATCHMAKE_UNHANDLED=4213]="MATCHMAKE_UNHANDLED",R[R.MATCHMAKE_EXPIRED=4214]="MATCHMAKE_EXPIRED",R[R.AUTH_FAILED=4215]="AUTH_FAILED",R[R.APPLICATION_ERROR=4216]="APPLICATION_ERROR";let createNanoEvents=()=>({events:{},emit(l,...y){(this.events[l]||[]).forEach((l=>l(...y)))},on(l,y){return(this.events[l]=this.events[l]||[]).push(y),()=>this.events[l]=(this.events[l]||[]).filter((l=>l!==y))}});var D=function(){function EventEmitter(){this.handlers=[]}return EventEmitter.prototype.register=function(l,y){return this.handlers.push(l),this},EventEmitter.prototype.invoke=function(){for(var l=this,y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];this.handlers.forEach((function(v){return v.apply(l,y)}))},EventEmitter.prototype.invokeAsync=function(){for(var l=this,y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];return Promise.all(this.handlers.map((function(v){return v.apply(l,y)})))},EventEmitter.prototype.remove=function(l){var y=this.handlers.indexOf(l);this.handlers[y]=this.handlers[this.handlers.length-1],this.handlers.pop()},EventEmitter.prototype.clear=function(){this.handlers=[]},EventEmitter}();function createSignal(){var l=new D;function register(y){return l.register(y,null===this)}return register.once=function(y){var callback=function(){for(var v=[],m=0;m<arguments.length;m++)v[m]=arguments[m];y.apply(this,v),l.remove(callback)};l.register(callback)},register.remove=function(y){return l.remove(y)},register.invoke=function(){for(var y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];return l.invoke.apply(l,y)},register.invokeAsync=function(){for(var y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];return l.invokeAsync.apply(l,y)},register.clear=function(){return l.clear()},register}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var F,N=function(l){var y={exports:{}};return function(l,y){!function(l){
/*! *****************************************************************************
        Copyright (c) Microsoft Corporation.

        Permission to use, copy, modify, and/or distribute this software for any
        purpose with or without fee is hereby granted.

        THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
        REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
        AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
        INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
        LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
        OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
        PERFORMANCE OF THIS SOFTWARE.
        ***************************************************************************** */
var extendStatics=function(l,y){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(l,y){l.__proto__=y}||function(l,y){for(var v in y)Object.prototype.hasOwnProperty.call(y,v)&&(l[v]=y[v])})(l,y)};function __extends(l,y){if("function"!=typeof y&&null!==y)throw new TypeError("Class extends value "+String(y)+" is not a constructor or null");function __(){this.constructor=l}extendStatics(l,y),l.prototype=null===y?Object.create(y):(__.prototype=y.prototype,new __)}function __decorate(l,y,v,m){var g,b=arguments.length,C=b<3?y:null===m?m=Object.getOwnPropertyDescriptor(y,v):m;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)C=Reflect.decorate(l,y,v,m);else for(var w=l.length-1;w>=0;w--)(g=l[w])&&(C=(b<3?g(C):b>3?g(y,v,C):g(y,v))||C);return b>3&&C&&Object.defineProperty(y,v,C),C}function __spreadArray(l,y){for(var v=0,m=y.length,g=l.length;v<m;v++,g++)l[g]=y[v];return l}var y,v=255,m=213;l.OPERATION=void 0,(y=l.OPERATION||(l.OPERATION={}))[y.ADD=128]="ADD",y[y.REPLACE=0]="REPLACE",y[y.DELETE=64]="DELETE",y[y.DELETE_AND_ADD=192]="DELETE_AND_ADD",y[y.TOUCH=1]="TOUCH",y[y.CLEAR=10]="CLEAR";var g=function(){function Root(){this.refs=new Map,this.refCounts={},this.deletedRefs=new Set,this.nextUniqueId=0}return Root.prototype.getNextUniqueId=function(){return this.nextUniqueId++},Root.prototype.addRef=function(l,y,v){void 0===v&&(v=!0),this.refs.set(l,y),v&&(this.refCounts[l]=(this.refCounts[l]||0)+1)},Root.prototype.removeRef=function(l){this.refCounts[l]=this.refCounts[l]-1,this.deletedRefs.add(l)},Root.prototype.clearRefs=function(){this.refs.clear(),this.deletedRefs.clear(),this.refCounts={}},Root.prototype.garbageCollectDeletedRefs=function(){var l=this;this.deletedRefs.forEach((function(y){if(l.refCounts[y]<=0){var v=l.refs.get(y);if(v instanceof k)for(var m in v._definition.schema)"string"!=typeof v._definition.schema[m]&&v[m]&&v[m].$changes&&l.removeRef(v[m].$changes.refId);else{var g=v.$changes.parent._definition,b=g.schema[g.fieldsByIndex[v.$changes.parentIndex]];"function"==typeof Object.values(b)[0]&&Array.from(v.values()).forEach((function(y){return l.removeRef(y.$changes.refId)}))}l.refs.delete(y),delete l.refCounts[y]}})),this.deletedRefs.clear()},Root}(),b=function(){function ChangeTree(l,y,v){this.changed=!1,this.changes=new Map,this.allChanges=new Set,this.caches={},this.currentCustomOperation=0,this.ref=l,this.setParent(y,v)}return ChangeTree.prototype.setParent=function(l,y,v){var m=this;if(this.indexes||(this.indexes=this.ref instanceof k?this.ref._definition.indexes:{}),this.parent=l,this.parentIndex=v,y)if(this.root=y,this.ref instanceof k){var g=this.ref._definition;for(var b in g.schema){var C=this.ref[b];if(C&&C.$changes){var w=g.indexes[b];C.$changes.setParent(this.ref,y,w)}}}else"object"==typeof this.ref&&this.ref.forEach((function(l,y){if(l instanceof k){var v=l.$changes,g=m.ref.$changes.indexes[y];v.setParent(m.ref,m.root,g)}}))},ChangeTree.prototype.operation=function(l){this.changes.set(--this.currentCustomOperation,l)},ChangeTree.prototype.change=function(y,v){void 0===v&&(v=l.OPERATION.ADD);var m="number"==typeof y?y:this.indexes[y];this.assertValidIndex(m,y);var g=this.changes.get(m);g&&g.op!==l.OPERATION.DELETE&&g.op!==l.OPERATION.TOUCH||this.changes.set(m,{op:g&&g.op===l.OPERATION.DELETE?l.OPERATION.DELETE_AND_ADD:v,index:m}),this.allChanges.add(m),this.changed=!0,this.touchParents()},ChangeTree.prototype.touch=function(y){var v="number"==typeof y?y:this.indexes[y];this.assertValidIndex(v,y),this.changes.has(v)||this.changes.set(v,{op:l.OPERATION.TOUCH,index:v}),this.allChanges.add(v),this.touchParents()},ChangeTree.prototype.touchParents=function(){this.parent&&this.parent.$changes.touch(this.parentIndex)},ChangeTree.prototype.getType=function(l){if(this.ref._definition)return(y=this.ref._definition).schema[y.fieldsByIndex[l]];var y,v=(y=this.parent._definition).schema[y.fieldsByIndex[this.parentIndex]];return Object.values(v)[0]},ChangeTree.prototype.getChildrenFilter=function(){var l=this.parent._definition.childFilters;return l&&l[this.parentIndex]},ChangeTree.prototype.getValue=function(l){return this.ref.getByIndex(l)},ChangeTree.prototype.delete=function(y){var v="number"==typeof y?y:this.indexes[y];if(void 0!==v){var m=this.getValue(v);this.changes.set(v,{op:l.OPERATION.DELETE,index:v}),this.allChanges.delete(v),delete this.caches[v],m&&m.$changes&&(m.$changes.parent=void 0),this.changed=!0,this.touchParents()}else console.warn("@colyseus/schema "+this.ref.constructor.name+": trying to delete non-existing index: "+y+" ("+v+")")},ChangeTree.prototype.discard=function(y,v){var m=this;void 0===y&&(y=!1),void 0===v&&(v=!1),this.ref instanceof k||this.changes.forEach((function(y){if(y.op===l.OPERATION.DELETE){var v=m.ref.getIndex(y.index);delete m.indexes[v]}})),this.changes.clear(),this.changed=y,v&&this.allChanges.clear(),this.currentCustomOperation=0},ChangeTree.prototype.discardAll=function(){var l=this;this.changes.forEach((function(y){var v=l.getValue(y.index);v&&v.$changes&&v.$changes.discardAll()})),this.discard()},ChangeTree.prototype.cache=function(l,y){this.caches[l]=y},ChangeTree.prototype.clone=function(){return new ChangeTree(this.ref,this.parent,this.root)},ChangeTree.prototype.ensureRefId=function(){void 0===this.refId&&(this.refId=this.root.getNextUniqueId())},ChangeTree.prototype.assertValidIndex=function(l,y){if(void 0===l)throw new Error('ChangeTree: missing index for field "'+y+'"')},ChangeTree}(),DEFAULT_SORT=function(l,y){var v=l.toString(),m=y.toString();return v<m?-1:v>m?1:0};function getArrayProxy(l){return l.$proxy=!0,new Proxy(l,{get:function(l,y){return"symbol"==typeof y||isNaN(y)?l[y]:l.at(y)},set:function(l,y,v){if("symbol"==typeof y||isNaN(y))l[y]=v;else{var m=Array.from(l.$items.keys()),g=parseInt(m[y]||y);null==v?l.deleteAt(g):l.setAt(g,v)}return!0},deleteProperty:function(l,y){return"number"==typeof y?l.deleteAt(y):delete l[y],!0}})}var C=function(){function ArraySchema(){for(var l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];this.$changes=new b(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,this.push.apply(this,l)}return ArraySchema.is=function(l){return Array.isArray(l)},Object.defineProperty(ArraySchema.prototype,"length",{get:function(){return this.$items.size},set:function(l){0===l?this.clear():this.splice(l,this.length-l)},enumerable:!1,configurable:!0}),ArraySchema.prototype.push=function(){for(var l,y=this,v=[],m=0;m<arguments.length;m++)v[m]=arguments[m];return v.forEach((function(v){l=y.$refId++,y.setAt(l,v)})),l},ArraySchema.prototype.pop=function(){var l=Array.from(this.$indexes.values()).pop();if(void 0!==l){this.$changes.delete(l),this.$indexes.delete(l);var y=this.$items.get(l);return this.$items.delete(l),y}},ArraySchema.prototype.at=function(l){var y=Array.from(this.$items.keys())[l];return this.$items.get(y)},ArraySchema.prototype.setAt=function(y,v){var m,g;void 0!==v.$changes&&v.$changes.setParent(this,this.$changes.root,y);var b=null!==(g=null===(m=this.$changes.indexes[y])||void 0===m?void 0:m.op)&&void 0!==g?g:l.OPERATION.ADD;this.$changes.indexes[y]=y,this.$indexes.set(y,y),this.$items.set(y,v),this.$changes.change(y,b)},ArraySchema.prototype.deleteAt=function(l){var y=Array.from(this.$items.keys())[l];return void 0!==y&&this.$deleteAt(y)},ArraySchema.prototype.$deleteAt=function(l){return this.$changes.delete(l),this.$indexes.delete(l),this.$items.delete(l)},ArraySchema.prototype.clear=function(y){var v=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),y&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(l){v.$changes.root.removeRef(l.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:l.OPERATION.CLEAR}),this.$changes.touchParents()},ArraySchema.prototype.concat=function(){for(var l,y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];return new(ArraySchema.bind.apply(ArraySchema,__spreadArray([void 0],(l=Array.from(this.$items.values())).concat.apply(l,y))))},ArraySchema.prototype.join=function(l){return Array.from(this.$items.values()).join(l)},ArraySchema.prototype.reverse=function(){var l=this,y=Array.from(this.$items.keys());return Array.from(this.$items.values()).reverse().forEach((function(v,m){l.setAt(y[m],v)})),this},ArraySchema.prototype.shift=function(){var l=Array.from(this.$items.keys()).shift();if(void 0!==l){var y=this.$items.get(l);return this.$deleteAt(l),y}},ArraySchema.prototype.slice=function(l,y){return new(ArraySchema.bind.apply(ArraySchema,__spreadArray([void 0],Array.from(this.$items.values()).slice(l,y))))},ArraySchema.prototype.sort=function(l){var y=this;void 0===l&&(l=DEFAULT_SORT);var v=Array.from(this.$items.keys());return Array.from(this.$items.values()).sort(l).forEach((function(l,m){y.setAt(v[m],l)})),this},ArraySchema.prototype.splice=function(l,y){void 0===y&&(y=this.length-l);for(var v=[],m=2;m<arguments.length;m++)v[m-2]=arguments[m];for(var g=Array.from(this.$items.keys()),b=[],C=l;C<l+y;C++)b.push(this.$items.get(g[C])),this.$deleteAt(g[C]);return b},ArraySchema.prototype.unshift=function(){for(var l=this,y=[],v=0;v<arguments.length;v++)y[v]=arguments[v];var m=this.length,g=y.length,b=Array.from(this.$items.values());return y.forEach((function(y,v){l.setAt(v,y)})),b.forEach((function(y,v){l.setAt(g+v,y)})),m+g},ArraySchema.prototype.indexOf=function(l,y){return Array.from(this.$items.values()).indexOf(l,y)},ArraySchema.prototype.lastIndexOf=function(l,y){return void 0===y&&(y=this.length-1),Array.from(this.$items.values()).lastIndexOf(l,y)},ArraySchema.prototype.every=function(l,y){return Array.from(this.$items.values()).every(l,y)},ArraySchema.prototype.some=function(l,y){return Array.from(this.$items.values()).some(l,y)},ArraySchema.prototype.forEach=function(l,y){Array.from(this.$items.values()).forEach(l,y)},ArraySchema.prototype.map=function(l,y){return Array.from(this.$items.values()).map(l,y)},ArraySchema.prototype.filter=function(l,y){return Array.from(this.$items.values()).filter(l,y)},ArraySchema.prototype.reduce=function(l,y){return Array.from(this.$items.values()).reduce(l,y)},ArraySchema.prototype.reduceRight=function(l,y){return Array.from(this.$items.values()).reduceRight(l,y)},ArraySchema.prototype.find=function(l,y){return Array.from(this.$items.values()).find(l,y)},ArraySchema.prototype.findIndex=function(l,y){return Array.from(this.$items.values()).findIndex(l,y)},ArraySchema.prototype.fill=function(l,y,v){throw new Error("ArraySchema#fill() not implemented")},ArraySchema.prototype.copyWithin=function(l,y,v){throw new Error("ArraySchema#copyWithin() not implemented")},ArraySchema.prototype.toString=function(){return this.$items.toString()},ArraySchema.prototype.toLocaleString=function(){return this.$items.toLocaleString()},ArraySchema.prototype[Symbol.iterator]=function(){return Array.from(this.$items.values())[Symbol.iterator]()},ArraySchema.prototype[Symbol.unscopables]=function(){return this.$items[Symbol.unscopables]()},ArraySchema.prototype.entries=function(){return this.$items.entries()},ArraySchema.prototype.keys=function(){return this.$items.keys()},ArraySchema.prototype.values=function(){return this.$items.values()},ArraySchema.prototype.includes=function(l,y){return Array.from(this.$items.values()).includes(l,y)},ArraySchema.prototype.flatMap=function(l,y){throw new Error("ArraySchema#flatMap() is not supported.")},ArraySchema.prototype.flat=function(l){throw new Error("ArraySchema#flat() is not supported.")},ArraySchema.prototype.setIndex=function(l,y){this.$indexes.set(l,y)},ArraySchema.prototype.getIndex=function(l){return this.$indexes.get(l)},ArraySchema.prototype.getByIndex=function(l){return this.$items.get(this.$indexes.get(l))},ArraySchema.prototype.deleteByIndex=function(l){var y=this.$indexes.get(l);this.$items.delete(y),this.$indexes.delete(l)},ArraySchema.prototype.toArray=function(){return Array.from(this.$items.values())},ArraySchema.prototype.toJSON=function(){return this.toArray().map((function(l){return"function"==typeof l.toJSON?l.toJSON():l}))},ArraySchema.prototype.clone=function(l){return l?new(ArraySchema.bind.apply(ArraySchema,__spreadArray([void 0],Array.from(this.$items.values())))):new(ArraySchema.bind.apply(ArraySchema,__spreadArray([void 0],this.map((function(l){return l.$changes?l.clone():l})))))},ArraySchema.prototype.triggerAll=function(){k.prototype.triggerAll.apply(this)},ArraySchema}();function getMapProxy(l){return l.$proxy=!0,new Proxy(l,{get:function(l,y){return"symbol"!=typeof y&&void 0===l[y]?l.get(y):l[y]},set:function(l,y,v){return"symbol"!=typeof y&&-1===y.indexOf("$")&&"onAdd"!==y&&"onRemove"!==y&&"onChange"!==y?l.set(y,v):l[y]=v,!0},deleteProperty:function(l,y){return l.delete(y),!0}})}var w=function(){function MapSchema(l){var y=this;if(this.$changes=new b(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,l)if(l instanceof Map)l.forEach((function(l,v){return y.set(v,l)}));else for(var v in l)this.set(v,l[v])}return MapSchema.is=function(l){return void 0!==l.map},MapSchema.prototype[Symbol.iterator]=function(){return this.$items[Symbol.iterator]()},Object.defineProperty(MapSchema.prototype,Symbol.toStringTag,{get:function(){return this.$items[Symbol.toStringTag]},enumerable:!1,configurable:!0}),MapSchema.prototype.set=function(y,v){if(null==v)throw new Error("MapSchema#set('"+y+"', "+v+"): trying to set "+v+" value on '"+y+"'.");var m=void 0!==this.$changes.indexes[y],g=m?this.$changes.indexes[y]:this.$refId++,b=m?l.OPERATION.REPLACE:l.OPERATION.ADD,C=void 0!==v.$changes;return C&&v.$changes.setParent(this,this.$changes.root,g),m?C&&this.$items.get(y)!==v&&(b=l.OPERATION.ADD):(this.$changes.indexes[y]=g,this.$indexes.set(g,y)),this.$items.set(y,v),this.$changes.change(y,b),this},MapSchema.prototype.get=function(l){return this.$items.get(l)},MapSchema.prototype.delete=function(l){return this.$changes.delete(l),this.$items.delete(l)},MapSchema.prototype.clear=function(y){var v=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),y&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(l){v.$changes.root.removeRef(l.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:l.OPERATION.CLEAR}),this.$changes.touchParents()},MapSchema.prototype.has=function(l){return this.$items.has(l)},MapSchema.prototype.forEach=function(l){this.$items.forEach(l)},MapSchema.prototype.entries=function(){return this.$items.entries()},MapSchema.prototype.keys=function(){return this.$items.keys()},MapSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(MapSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),MapSchema.prototype.setIndex=function(l,y){this.$indexes.set(l,y)},MapSchema.prototype.getIndex=function(l){return this.$indexes.get(l)},MapSchema.prototype.getByIndex=function(l){return this.$items.get(this.$indexes.get(l))},MapSchema.prototype.deleteByIndex=function(l){var y=this.$indexes.get(l);this.$items.delete(y),this.$indexes.delete(l)},MapSchema.prototype.toJSON=function(){var l={};return this.forEach((function(y,v){l[v]="function"==typeof y.toJSON?y.toJSON():y})),l},MapSchema.prototype.clone=function(l){var y;return l?y=Object.assign(new MapSchema,this):(y=new MapSchema,this.forEach((function(l,v){l.$changes?y.set(v,l.clone()):y.set(v,l)}))),y},MapSchema.prototype.triggerAll=function(){k.prototype.triggerAll.apply(this)},MapSchema}(),O={};function registerType(l,y){O[l]=y}function getType(l){return O[l]}var x=function(){function SchemaDefinition(){this.indexes={},this.fieldsByIndex={},this.deprecated={},this.descriptors={}}return SchemaDefinition.create=function(l){var y=new SchemaDefinition;return y.schema=Object.assign({},l&&l.schema||{}),y.indexes=Object.assign({},l&&l.indexes||{}),y.fieldsByIndex=Object.assign({},l&&l.fieldsByIndex||{}),y.descriptors=Object.assign({},l&&l.descriptors||{}),y.deprecated=Object.assign({},l&&l.deprecated||{}),y},SchemaDefinition.prototype.addField=function(l,y){var v=this.getNextFieldIndex();this.fieldsByIndex[v]=l,this.indexes[l]=v,this.schema[l]=Array.isArray(y)?{array:y[0]}:y},SchemaDefinition.prototype.addFilter=function(l,y){return this.filters||(this.filters={},this.indexesWithFilters=[]),this.filters[this.indexes[l]]=y,this.indexesWithFilters.push(this.indexes[l]),!0},SchemaDefinition.prototype.addChildrenFilter=function(l,y){var v=this.indexes[l],m=this.schema[l];if(getType(Object.keys(m)[0]))return this.childFilters||(this.childFilters={}),this.childFilters[v]=y,!0;console.warn("@filterChildren: field '"+l+"' can't have children. Ignoring filter.")},SchemaDefinition.prototype.getChildrenFilter=function(l){return this.childFilters&&this.childFilters[this.indexes[l]]},SchemaDefinition.prototype.getNextFieldIndex=function(){return Object.keys(this.schema||{}).length},SchemaDefinition}();function hasFilter(l){return l._context&&l._context.useFilters}var A=function(){function Context(){this.types={},this.schemas=new Map,this.useFilters=!1}return Context.prototype.has=function(l){return this.schemas.has(l)},Context.prototype.get=function(l){return this.types[l]},Context.prototype.add=function(l,y){void 0===y&&(y=this.schemas.size),l._definition=x.create(l._definition),l._typeid=y,this.types[y]=l,this.schemas.set(l,y)},Context.create=function(l){return void 0===l&&(l=new Context),function(y){return type(y,l)}},Context}(),S=new A;function type(l,y){return void 0===y&&(y=S),function(v,m){var g=v.constructor;g._context=y,y.has(g)||y.add(g);var b=g._definition;if(b.addField(m,l),b.descriptors[m]){if(b.deprecated[m])return;try{throw new Error("@colyseus/schema: Duplicate '"+m+"' definition on '"+g.name+"'.\nCheck @type() annotation")}catch(l){var O=l.stack.split("\n")[4].trim();throw new Error(l.message+" "+O)}}var x=C.is(l),A=!x&&w.is(l);if("string"!=typeof l&&!k.is(l)){var S=Object.values(l)[0];"string"==typeof S||y.has(S)||y.add(S)}var E="_"+m;b.descriptors[E]={enumerable:!1,configurable:!1,writable:!0},b.descriptors[m]={get:function(){return this[E]},set:function(l){l!==this[E]&&(null!=l?(!x||l instanceof C||(l=new(C.bind.apply(C,__spreadArray([void 0],l)))),!A||l instanceof w||(l=new w(l)),void 0===l.$proxy&&(A?l=getMapProxy(l):x&&(l=getArrayProxy(l))),this.$changes.change(m),l.$changes&&l.$changes.setParent(this,this.$changes.root,this._definition.indexes[m])):this.$changes.delete(m),this[E]=l)},enumerable:!0,configurable:!0}}}function filter(l){return function(y,v){var m=y.constructor;m._definition.addFilter(v,l)&&(m._context.useFilters=!0)}}function filterChildren(l){return function(y,v){var m=y.constructor;m._definition.addChildrenFilter(v,l)&&(m._context.useFilters=!0)}}function deprecated(l,y){return void 0===l&&(l=!0),function(y,v){var m=y.constructor._definition;m.deprecated[v]=!0,l&&(m.descriptors[v]={get:function(){throw new Error(v+" is deprecated.")},set:function(l){},enumerable:!1,configurable:!0})}}function defineTypes(l,y,v){for(var m in void 0===v&&(v=l._context||S),y)type(y[m],v)(l.prototype,m);return l}function utf8Length(l){for(var y=0,v=0,m=0,g=l.length;m<g;m++)(y=l.charCodeAt(m))<128?v+=1:y<2048?v+=2:y<55296||y>=57344?v+=3:(m++,v+=4);return v}function utf8Write(l,y,v){for(var m=0,g=0,b=v.length;g<b;g++)(m=v.charCodeAt(g))<128?l[y++]=m:m<2048?(l[y++]=192|m>>6,l[y++]=128|63&m):m<55296||m>=57344?(l[y++]=224|m>>12,l[y++]=128|m>>6&63,l[y++]=128|63&m):(g++,m=65536+((1023&m)<<10|1023&v.charCodeAt(g)),l[y++]=240|m>>18,l[y++]=128|m>>12&63,l[y++]=128|m>>6&63,l[y++]=128|63&m)}function int8$1(l,y){l.push(255&y)}function uint8$1(l,y){l.push(255&y)}function int16$1(l,y){l.push(255&y),l.push(y>>8&255)}function uint16$1(l,y){l.push(255&y),l.push(y>>8&255)}function int32$1(l,y){l.push(255&y),l.push(y>>8&255),l.push(y>>16&255),l.push(y>>24&255)}function uint32$1(l,y){var v=y>>24,m=y>>16,g=y>>8,b=y;l.push(255&b),l.push(255&g),l.push(255&m),l.push(255&v)}function int64$1(l,y){var v=Math.floor(y/Math.pow(2,32));uint32$1(l,y>>>0),uint32$1(l,v)}function uint64$1(l,y){var v=y/Math.pow(2,32)>>0;uint32$1(l,y>>>0),uint32$1(l,v)}function float32$1(l,y){writeFloat32(l,y)}function float64$1(l,y){writeFloat64(l,y)}var E=new Int32Array(2),T=new Float32Array(E.buffer),R=new Float64Array(E.buffer);function writeFloat32(l,y){T[0]=y,int32$1(l,E[0])}function writeFloat64(l,y){R[0]=y,int32$1(l,E[0]),int32$1(l,E[1])}function boolean$1(l,y){return uint8$1(l,y?1:0)}function string$1(l,y){y||(y="");var v=utf8Length(y),m=0;if(v<32)l.push(160|v),m=1;else if(v<256)l.push(217),uint8$1(l,v),m=2;else if(v<65536)l.push(218),uint16$1(l,v),m=3;else{if(!(v<4294967296))throw new Error("String too long");l.push(219),uint32$1(l,v),m=5}return utf8Write(l,l.length,y),m+v}function number$1(l,y){return isNaN(y)?number$1(l,0):isFinite(y)?y!==(0|y)?(l.push(203),writeFloat64(l,y),9):y>=0?y<128?(uint8$1(l,y),1):y<256?(l.push(204),uint8$1(l,y),2):y<65536?(l.push(205),uint16$1(l,y),3):y<4294967296?(l.push(206),uint32$1(l,y),5):(l.push(207),uint64$1(l,y),9):y>=-32?(l.push(224|y+32),1):y>=-128?(l.push(208),int8$1(l,y),2):y>=-32768?(l.push(209),int16$1(l,y),3):y>=-2147483648?(l.push(210),int32$1(l,y),5):(l.push(211),int64$1(l,y),9):number$1(l,y>0?Number.MAX_SAFE_INTEGER:-Number.MAX_SAFE_INTEGER)}var I=Object.freeze({__proto__:null,utf8Write:utf8Write,int8:int8$1,uint8:uint8$1,int16:int16$1,uint16:uint16$1,int32:int32$1,uint32:uint32$1,int64:int64$1,uint64:uint64$1,float32:float32$1,float64:float64$1,writeFloat32:writeFloat32,writeFloat64:writeFloat64,boolean:boolean$1,string:string$1,number:number$1});function utf8Read(l,y,v){for(var m="",g=0,b=y,C=y+v;b<C;b++){var w=l[b];0!=(128&w)?192!=(224&w)?224!=(240&w)?240!=(248&w)?console.error("Invalid byte "+w.toString(16)):(g=(7&w)<<18|(63&l[++b])<<12|(63&l[++b])<<6|(63&l[++b])<<0)>=65536?(g-=65536,m+=String.fromCharCode(55296+(g>>>10),56320+(1023&g))):m+=String.fromCharCode(g):m+=String.fromCharCode((15&w)<<12|(63&l[++b])<<6|(63&l[++b])<<0):m+=String.fromCharCode((31&w)<<6|63&l[++b]):m+=String.fromCharCode(w)}return m}function int8(l,y){return uint8(l,y)<<24>>24}function uint8(l,y){return l[y.offset++]}function int16(l,y){return uint16(l,y)<<16>>16}function uint16(l,y){return l[y.offset++]|l[y.offset++]<<8}function int32(l,y){return l[y.offset++]|l[y.offset++]<<8|l[y.offset++]<<16|l[y.offset++]<<24}function uint32(l,y){return int32(l,y)>>>0}function float32(l,y){return readFloat32(l,y)}function float64(l,y){return readFloat64(l,y)}function int64(l,y){var v=uint32(l,y);return int32(l,y)*Math.pow(2,32)+v}function uint64(l,y){var v=uint32(l,y);return uint32(l,y)*Math.pow(2,32)+v}var P=new Int32Array(2),M=new Float32Array(P.buffer),z=new Float64Array(P.buffer);function readFloat32(l,y){return P[0]=int32(l,y),M[0]}function readFloat64(l,y){return P[0]=int32(l,y),P[1]=int32(l,y),z[0]}function boolean(l,y){return uint8(l,y)>0}function string(l,y){var v,m=l[y.offset++];m<192?v=31&m:217===m?v=uint8(l,y):218===m?v=uint16(l,y):219===m&&(v=uint32(l,y));var g=utf8Read(l,y.offset,v);return y.offset+=v,g}function stringCheck(l,y){var v=l[y.offset];return v<192&&v>160||217===v||218===v||219===v}function number(l,y){var v=l[y.offset++];return v<128?v:202===v?readFloat32(l,y):203===v?readFloat64(l,y):204===v?uint8(l,y):205===v?uint16(l,y):206===v?uint32(l,y):207===v?uint64(l,y):208===v?int8(l,y):209===v?int16(l,y):210===v?int32(l,y):211===v?int64(l,y):v>223?-1*(255-v+1):void 0}function numberCheck(l,y){var v=l[y.offset];return v<128||v>=202&&v<=211}function arrayCheck(l,y){return l[y.offset]<160}function switchStructureCheck(l,y){return l[y.offset-1]===v&&(l[y.offset]<128||l[y.offset]>=202&&l[y.offset]<=211)}var D=Object.freeze({__proto__:null,int8:int8,uint8:uint8,int16:int16,uint16:uint16,int32:int32,uint32:uint32,float32:float32,float64:float64,int64:int64,uint64:uint64,readFloat32:readFloat32,readFloat64:readFloat64,boolean:boolean,string:string,stringCheck:stringCheck,number:number,numberCheck:numberCheck,arrayCheck:arrayCheck,switchStructureCheck:switchStructureCheck}),F=function(){function CollectionSchema(l){var y=this;this.$changes=new b(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,l&&l.forEach((function(l){return y.add(l)}))}return CollectionSchema.is=function(l){return void 0!==l.collection},CollectionSchema.prototype.add=function(l){var y=this.$refId++;return void 0!==l.$changes&&l.$changes.setParent(this,this.$changes.root,y),this.$changes.indexes[y]=y,this.$indexes.set(y,y),this.$items.set(y,l),this.$changes.change(y),y},CollectionSchema.prototype.at=function(l){var y=Array.from(this.$items.keys())[l];return this.$items.get(y)},CollectionSchema.prototype.entries=function(){return this.$items.entries()},CollectionSchema.prototype.delete=function(l){for(var y,v,m=this.$items.entries();(v=m.next())&&!v.done;)if(l===v.value[1]){y=v.value[0];break}return void 0!==y&&(this.$changes.delete(y),this.$indexes.delete(y),this.$items.delete(y))},CollectionSchema.prototype.clear=function(y){var v=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),y&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(l){v.$changes.root.removeRef(l.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:l.OPERATION.CLEAR}),this.$changes.touchParents()},CollectionSchema.prototype.has=function(l){return Array.from(this.$items.values()).some((function(y){return y===l}))},CollectionSchema.prototype.forEach=function(l){var y=this;this.$items.forEach((function(v,m,g){return l(v,m,y)}))},CollectionSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(CollectionSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),CollectionSchema.prototype.setIndex=function(l,y){this.$indexes.set(l,y)},CollectionSchema.prototype.getIndex=function(l){return this.$indexes.get(l)},CollectionSchema.prototype.getByIndex=function(l){return this.$items.get(this.$indexes.get(l))},CollectionSchema.prototype.deleteByIndex=function(l){var y=this.$indexes.get(l);this.$items.delete(y),this.$indexes.delete(l)},CollectionSchema.prototype.toArray=function(){return Array.from(this.$items.values())},CollectionSchema.prototype.toJSON=function(){var l=[];return this.forEach((function(y,v){l.push("function"==typeof y.toJSON?y.toJSON():y)})),l},CollectionSchema.prototype.clone=function(l){var y;return l?y=Object.assign(new CollectionSchema,this):(y=new CollectionSchema,this.forEach((function(l){l.$changes?y.add(l.clone()):y.add(l)}))),y},CollectionSchema.prototype.triggerAll=function(){k.prototype.triggerAll.apply(this)},CollectionSchema}(),N=function(){function SetSchema(l){var y=this;this.$changes=new b(this),this.$items=new Map,this.$indexes=new Map,this.$refId=0,l&&l.forEach((function(l){return y.add(l)}))}return SetSchema.is=function(l){return void 0!==l.set},SetSchema.prototype.add=function(y){var v,m;if(this.has(y))return!1;var g=this.$refId++;void 0!==y.$changes&&y.$changes.setParent(this,this.$changes.root,g);var b=null!==(m=null===(v=this.$changes.indexes[g])||void 0===v?void 0:v.op)&&void 0!==m?m:l.OPERATION.ADD;return this.$changes.indexes[g]=g,this.$indexes.set(g,g),this.$items.set(g,y),this.$changes.change(g,b),g},SetSchema.prototype.entries=function(){return this.$items.entries()},SetSchema.prototype.delete=function(l){for(var y,v,m=this.$items.entries();(v=m.next())&&!v.done;)if(l===v.value[1]){y=v.value[0];break}return void 0!==y&&(this.$changes.delete(y),this.$indexes.delete(y),this.$items.delete(y))},SetSchema.prototype.clear=function(y){var v=this;this.$changes.discard(!0,!0),this.$changes.indexes={},this.$indexes.clear(),y&&"string"!=typeof this.$changes.getType()&&this.$items.forEach((function(l){v.$changes.root.removeRef(l.$changes.refId)})),this.$items.clear(),this.$changes.operation({index:0,op:l.OPERATION.CLEAR}),this.$changes.touchParents()},SetSchema.prototype.has=function(l){for(var y,v=this.$items.values(),m=!1;(y=v.next())&&!y.done;)if(l===y.value){m=!0;break}return m},SetSchema.prototype.forEach=function(l){var y=this;this.$items.forEach((function(v,m,g){return l(v,m,y)}))},SetSchema.prototype.values=function(){return this.$items.values()},Object.defineProperty(SetSchema.prototype,"size",{get:function(){return this.$items.size},enumerable:!1,configurable:!0}),SetSchema.prototype.setIndex=function(l,y){this.$indexes.set(l,y)},SetSchema.prototype.getIndex=function(l){return this.$indexes.get(l)},SetSchema.prototype.getByIndex=function(l){return this.$items.get(this.$indexes.get(l))},SetSchema.prototype.deleteByIndex=function(l){var y=this.$indexes.get(l);this.$items.delete(y),this.$indexes.delete(l)},SetSchema.prototype.toArray=function(){return Array.from(this.$items.values())},SetSchema.prototype.toJSON=function(){var l=[];return this.forEach((function(y,v){l.push("function"==typeof y.toJSON?y.toJSON():y)})),l},SetSchema.prototype.clone=function(l){var y;return l?y=Object.assign(new SetSchema,this):(y=new SetSchema,this.forEach((function(l){l.$changes?y.add(l.clone()):y.add(l)}))),y},SetSchema.prototype.triggerAll=function(){k.prototype.triggerAll.apply(this)},SetSchema}(),U=function(){function EventEmitter_(){this.handlers=[]}return EventEmitter_.prototype.register=function(l,y){return this.handlers.push(l),this},EventEmitter_.prototype.invoke=function(){for(var l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];this.handlers.forEach((function(y){return y.apply(void 0,l)}))},EventEmitter_.prototype.invokeAsync=function(){for(var l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];return Promise.all(this.handlers.map((function(y){return y.apply(void 0,l)})))},EventEmitter_.prototype.remove=function(l){var y=this.handlers.indexOf(l);this.handlers[y]=this.handlers[this.handlers.length-1],this.handlers.pop()},EventEmitter_.prototype.clear=function(){this.handlers=[]},EventEmitter_}(),$=function(){function ClientState(){this.refIds=new WeakSet,this.containerIndexes=new WeakMap}return ClientState.prototype.addRefId=function(l){this.refIds.has(l)||(this.refIds.add(l),this.containerIndexes.set(l,new Set))},ClientState.get=function(l){return void 0===l.$filterState&&(l.$filterState=new ClientState),l.$filterState},ClientState}(),L=function(l){function EncodeSchemaError(){return null!==l&&l.apply(this,arguments)||this}return __extends(EncodeSchemaError,l),EncodeSchemaError}(Error);function assertType(l,y,v,m){var g,b=!1;switch(y){case"number":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":case"int64":case"uint64":case"float32":case"float64":g="number",isNaN(l)&&console.log('trying to encode "NaN" in '+v.constructor.name+"#"+m);break;case"string":g="string",b=!0;break;case"boolean":return}if(typeof l!==g&&(!b||b&&null!==l)){var C="'"+JSON.stringify(l)+"'"+(l&&l.constructor&&" ("+l.constructor.name+")"||"");throw new L("a '"+g+"' was expected, but "+C+" was provided in "+v.constructor.name+"#"+m)}}function assertInstanceType(l,y,v,m){if(!(l instanceof y))throw new L("a '"+y.name+"' was expected, but '"+l.constructor.name+"' was provided in "+v.constructor.name+"#"+m)}function encodePrimitiveType(l,y,v,m,g){assertType(v,l,m,g);var b=I[l];if(!b)throw new L("a '"+l+"' was expected, but "+v+" was provided in "+m.constructor.name+"#"+g);b(y,v)}function decodePrimitiveType(l,y,v){return D[l](y,v)}var k=function(){function Schema(){for(var l=[],y=0;y<arguments.length;y++)l[y]=arguments[y];Object.defineProperties(this,{$changes:{value:new b(this,void 0,new g),enumerable:!1,writable:!0},$listeners:{value:{},enumerable:!1,writable:!0}});var v=this._definition.descriptors;v&&Object.defineProperties(this,v),l[0]&&this.assign(l[0])}return Schema.onError=function(l){console.error(l)},Schema.is=function(l){return l._definition&&void 0!==l._definition.schema},Schema.prototype.assign=function(l){return Object.assign(this,l),this},Object.defineProperty(Schema.prototype,"_definition",{get:function(){return this.constructor._definition},enumerable:!1,configurable:!0}),Schema.prototype.listen=function(l,y){var v=this;return this.$listeners[l]||(this.$listeners[l]=new U),this.$listeners[l].register(y),function(){return v.$listeners[l].remove(y)}},Schema.prototype.decode=function(y,m,g,b){void 0===m&&(m={offset:0}),void 0===g&&(g=this),void 0===b&&(b=new Map);var O=this.$changes.root,x=y.length,A=0,S=[];for(O.refs.set(A,this),b.set(A,S);m.offset<x;){var E=y[m.offset++];if(E!=v){var T=g.$changes,R=void 0!==g._definition,I=R?E>>6<<6:E;if(I!==l.OPERATION.CLEAR){var P=R?E%(I||255):number(y,m),M=R?g._definition.fieldsByIndex[P]:"",z=T.getType(P),D=void 0,U=void 0,$=void 0;if(R?U=g["_"+M]:(U=g.getByIndex(P),(I&l.OPERATION.ADD)===l.OPERATION.ADD?($=g instanceof w?string(y,m):P,g.setIndex(P,$)):$=g.getIndex(P)),(I&l.OPERATION.DELETE)===l.OPERATION.DELETE&&(I!==l.OPERATION.DELETE_AND_ADD&&g.deleteByIndex(P),U&&U.$changes&&O.removeRef(U.$changes.refId),D=null),void 0!==M){if(I===l.OPERATION.DELETE);else if(Schema.is(z)){var L=number(y,m);if(D=O.refs.get(L),I!==l.OPERATION.REPLACE){var k=this.getSchemaType(y,m,z);D||((D=this.createTypeInstance(k)).$changes.refId=L,U&&(D.onChange=U.onChange,D.onRemove=U.onRemove,D.$listeners=U.$listeners,U.$changes.refId&&L!==U.$changes.refId&&O.removeRef(U.$changes.refId))),O.addRef(L,D,D!==U)}}else if("string"==typeof z)D=decodePrimitiveType(z,y,m);else{var j=getType(Object.keys(z)[0]),V=number(y,m),H=O.refs.has(V)?U||O.refs.get(V):new j.constructor;if((D=H.clone(!0)).$changes.refId=V,U&&(D.onAdd=U.onAdd,D.onRemove=U.onRemove,D.onChange=U.onChange,U.$changes.refId&&V!==U.$changes.refId)){O.removeRef(U.$changes.refId);for(var B=[],q=U.entries(),W=void 0;(W=q.next())&&!W.done;){var G=W.value,J=G[0],Y=G[1];B.push({op:l.OPERATION.DELETE,field:J,value:void 0,previousValue:Y})}b.set(U.$changes.refId,B)}O.addRef(V,D,H!==U),j.getProxy&&(D=j.getProxy(D))}var X=U!==D;if(null!=D)if(D.$changes&&D.$changes.setParent(T.ref,T.root,P),g instanceof Schema)g[M]=D;else if(g instanceof w)J=$,g.$items.set(J,D);else if(g instanceof C)g.setAt(P,D);else if(g instanceof F){var Q=g.add(D);g.setIndex(P,Q)}else g instanceof N&&!1!==(Q=g.add(D))&&g.setIndex(P,Q);X&&S.push({op:I,field:M,dynamicIndex:$,value:D,previousValue:U})}else{console.warn("@colyseus/schema: definition mismatch");for(var K={offset:m.offset};m.offset<x&&(!switchStructureCheck(y,m)||(K.offset=m.offset+1,!O.refs.has(number(y,K))));)m.offset++}}else g.clear(!0)}else{A=number(y,m);var Z=O.refs.get(A);if(!Z)throw new Error('"refId" not found: '+A);g=Z,S=[],b.set(A,S)}}return this._triggerChanges(b),O.garbageCollectDeletedRefs(),b},Schema.prototype.encode=function(y,m,g){void 0===y&&(y=!1),void 0===m&&(m=[]),void 0===g&&(g=!1);for(var b=this.$changes,C=new WeakSet,O=[b],x=1,A=0;A<x;A++){var S=O[A],E=S.ref,T=E instanceof Schema;S.ensureRefId(),C.add(S),S!==b&&(S.changed||y)&&(uint8$1(m,v),number$1(m,S.refId));for(var R=y?Array.from(S.allChanges):Array.from(S.changes.values()),I=0,P=R.length;I<P;I++){var M=y?{op:l.OPERATION.ADD,index:R[I]}:R[I],z=M.index,D=T?E._definition.fieldsByIndex&&E._definition.fieldsByIndex[z]:z,F=m.length;if(M.op!==l.OPERATION.TOUCH)if(T)uint8$1(m,z|M.op);else{if(uint8$1(m,M.op),M.op===l.OPERATION.CLEAR)continue;number$1(m,z)}if(T||(M.op&l.OPERATION.ADD)!=l.OPERATION.ADD||E instanceof w&&string$1(m,S.ref.$indexes.get(z)),M.op!==l.OPERATION.DELETE){var N=S.getType(z),U=S.getValue(z);if(U&&U.$changes&&!C.has(U.$changes)&&(O.push(U.$changes),U.$changes.ensureRefId(),x++),M.op!==l.OPERATION.TOUCH){if(Schema.is(N))assertInstanceType(U,N,E,D),number$1(m,U.$changes.refId),(M.op&l.OPERATION.ADD)===l.OPERATION.ADD&&this.tryEncodeTypeId(m,N,U.constructor);else if("string"==typeof N)encodePrimitiveType(N,m,U,E,D);else{var $=getType(Object.keys(N)[0]);assertInstanceType(E["_"+D],$.constructor,E,D),number$1(m,U.$changes.refId)}g&&S.cache(z,m.slice(F))}}}y||g||S.discard()}return m},Schema.prototype.encodeAll=function(l){return this.encode(!0,[],l)},Schema.prototype.applyFilters=function(y,m){void 0===m&&(m=!1);for(var g=this,b=new Set,C=$.get(y),O=[this.$changes],x=1,A=[],_loop_1=function(S){var E=O[S];if(b.has(E.refId))return"continue";var T=E.ref,R=T instanceof Schema;uint8$1(A,v),number$1(A,E.refId);var P=C.refIds.has(E),M=m||!P;C.addRefId(E);var z=C.containerIndexes.get(E),D=M?Array.from(E.allChanges):Array.from(E.changes.values());!m&&R&&T._definition.indexesWithFilters&&T._definition.indexesWithFilters.forEach((function(y){!z.has(y)&&E.allChanges.has(y)&&(M?D.push(y):D.push({op:l.OPERATION.ADD,index:y}))}));for(var F=0,N=D.length;F<N;F++){var U=M?{op:l.OPERATION.ADD,index:D[F]}:D[F];if(U.op!==l.OPERATION.CLEAR){var $=U.index;if(U.op!==l.OPERATION.DELETE){var L=E.getValue($),k=E.getType($);if(R){if((j=T._definition.filters&&T._definition.filters[$])&&!j.call(T,y,L,g)){L&&L.$changes&&b.add(L.$changes.refId);continue}}else{var j,V=E.parent;if((j=E.getChildrenFilter())&&!j.call(V,y,T.$indexes.get($),L,g)){L&&L.$changes&&b.add(L.$changes.refId);continue}}if(L.$changes&&(O.push(L.$changes),x++),U.op!==l.OPERATION.TOUCH)if(U.op===l.OPERATION.ADD||R)A=A.concat(E.caches[$]),z.add($);else if(z.has($))A=A.concat(E.caches[$]);else{if(z.add($),uint8$1(A,l.OPERATION.ADD),number$1(A,$),T instanceof w){var H=E.ref.$indexes.get($);string$1(A,H)}L.$changes?number$1(A,L.$changes.refId):I[k](A,L)}else L.$changes&&!R&&(uint8$1(A,l.OPERATION.ADD),number$1(A,$),T instanceof w&&(H=E.ref.$indexes.get($),string$1(A,H)),number$1(A,L.$changes.refId))}else R?uint8$1(A,U.op|$):(uint8$1(A,U.op),number$1(A,$))}else uint8$1(A,U.op)}},S=0;S<x;S++)_loop_1(S);return A},Schema.prototype.clone=function(){var l=new this.constructor,y=this._definition.schema;for(var v in y)"object"==typeof this[v]&&"function"==typeof this[v].clone?l[v]=this[v].clone():l[v]=this[v];return l},Schema.prototype.triggerAll=function(){if(0!==this.$changes.root.refs.size){var l=new Map;Schema.prototype._triggerAllFillChanges.call(this,this,l);try{Schema.prototype._triggerChanges.call(this,l)}catch(l){Schema.onError(l)}}},Schema.prototype.toJSON=function(){var l=this._definition.schema,y=this._definition.deprecated,v={};for(var m in l)y[m]||null===this[m]||void 0===this[m]||(v[m]="function"==typeof this[m].toJSON?this[m].toJSON():this["_"+m]);return v},Schema.prototype.discardAllChanges=function(){this.$changes.discardAll()},Schema.prototype.getByIndex=function(l){return this[this._definition.fieldsByIndex[l]]},Schema.prototype.deleteByIndex=function(l){this[this._definition.fieldsByIndex[l]]=void 0},Schema.prototype.tryEncodeTypeId=function(l,y,v){y._typeid!==v._typeid&&(uint8$1(l,m),number$1(l,v._typeid))},Schema.prototype.getSchemaType=function(l,y,v){var g;return l[y.offset]===m&&(y.offset++,g=this.constructor._context.get(number(l,y))),g||v},Schema.prototype.createTypeInstance=function(l){var y=new l;return y.$changes.root=this.$changes.root,y},Schema.prototype._triggerAllFillChanges=function(y,v){if(!v.has(y.$changes.refId)){var m=[];if(v.set(y.$changes.refId||0,m),y instanceof Schema){var g=y._definition.schema;for(var b in g)void 0!==(A=y["_"+b])&&(m.push({op:l.OPERATION.ADD,field:b,value:A,previousValue:void 0}),void 0!==A.$changes&&Schema.prototype._triggerAllFillChanges.call(this,A,v))}else for(var C=y.entries(),w=void 0;(w=C.next())&&!w.done;){var O=w.value,x=O[0],A=O[1];m.push({op:l.OPERATION.ADD,field:x,dynamicIndex:x,value:A,previousValue:void 0}),void 0!==A.$changes&&Schema.prototype._triggerAllFillChanges.call(this,A,v)}}},Schema.prototype._triggerChanges=function(y){var v=this;y.forEach((function(y,m){var g,b,C,w,O,x,A,S,E,T,R,I;if(y.length>0){for(var P=v.$changes.root.refs.get(m),M=P instanceof Schema,z=0;z<y.length;z++){var D=y[z],F=P.$listeners&&P.$listeners[D.field];if(M||(D.op===l.OPERATION.ADD&&void 0===D.previousValue?null===(b=(g=P).onAdd)||void 0===b||b.call(g,D.value,null!==(C=D.dynamicIndex)&&void 0!==C?C:D.field):D.op===l.OPERATION.DELETE?void 0!==D.previousValue&&(null===(O=(w=P).onRemove)||void 0===O||O.call(w,D.previousValue,null!==(x=D.dynamicIndex)&&void 0!==x?x:D.field)):D.op===l.OPERATION.DELETE_AND_ADD?(void 0!==D.previousValue&&(null===(S=(A=P).onRemove)||void 0===S||S.call(A,D.previousValue,D.dynamicIndex)),null===(T=(E=P).onAdd)||void 0===T||T.call(E,D.value,D.dynamicIndex)):D.op!==l.OPERATION.REPLACE&&D.value===D.previousValue||null===(I=(R=P).onChange)||void 0===I||I.call(R,D.value,D.dynamicIndex)),(D.op&l.OPERATION.DELETE)===l.OPERATION.DELETE&&D.previousValue instanceof Schema&&D.previousValue.onRemove&&D.previousValue.onRemove(),F)try{F.invoke(D.value,D.previousValue)}catch(l){Schema.onError(l)}}if(M&&P.onChange)try{P.onChange(y)}catch(l){Schema.onError(l)}}}))},Schema._definition=x.create(),Schema}();function dumpChanges(l){for(var y=[l.$changes],v=1,m={},g=m,_loop_1=function(l){var v=y[l];v.changes.forEach((function(l){var y=v.ref,m=l.index,b=y._definition?y._definition.fieldsByIndex[m]:y.$indexes.get(m);g[b]=v.getValue(m)}))},b=0;b<v;b++)_loop_1(b);return m}var j=new A,V=function(l){function ReflectionField(){return null!==l&&l.apply(this,arguments)||this}return __extends(ReflectionField,l),__decorate([type("string",j)],ReflectionField.prototype,"name",void 0),__decorate([type("string",j)],ReflectionField.prototype,"type",void 0),__decorate([type("number",j)],ReflectionField.prototype,"referencedType",void 0),ReflectionField}(k),H=function(l){function ReflectionType(){var y=null!==l&&l.apply(this,arguments)||this;return y.fields=new C,y}return __extends(ReflectionType,l),__decorate([type("number",j)],ReflectionType.prototype,"id",void 0),__decorate([type([V],j)],ReflectionType.prototype,"fields",void 0),ReflectionType}(k),B=function(l){function Reflection(){var y=null!==l&&l.apply(this,arguments)||this;return y.types=new C,y}return __extends(Reflection,l),Reflection.encode=function(l){var y=l.constructor,v=new Reflection;v.rootType=y._typeid;var buildType=function(l,y){for(var m in y){var g=new V;g.name=m;var b=void 0;if("string"==typeof y[m])b=y[m];else{var C=y[m],w=void 0;k.is(C)?(b="ref",w=y[m]):"string"==typeof C[b=Object.keys(C)[0]]?b+=":"+C[b]:w=C[b],g.referencedType=w?w._typeid:-1}g.type=b,l.fields.push(g)}v.types.push(l)},m=y._context.types;for(var g in m){var b=new H;b.id=Number(g),buildType(b,m[g]._definition.schema)}return v.encodeAll()},Reflection.decode=function(l,y){var v=new A,m=new Reflection;m.decode(l,y);var g=m.types.reduce((function(l,y){var m=function(l){function _(){return null!==l&&l.apply(this,arguments)||this}return __extends(_,l),_}(k),g=y.id;return l[g]=m,v.add(m,g),l}),{});m.types.forEach((function(l){var y=g[l.id];l.fields.forEach((function(l){var m;if(void 0!==l.referencedType){var b=l.type,C=g[l.referencedType];if(!C){var w=l.type.split(":");b=w[0],C=w[1]}"ref"===b?type(C,v)(y.prototype,l.name):type(((m={})[b]=C,m),v)(y.prototype,l.name)}else type(l.type,v)(y.prototype,l.name)}))}));var b=g[m.rootType],C=new b;for(var w in b._definition.schema){var O=b._definition.schema[w];"string"!=typeof O&&(C[w]="function"==typeof O?new O:new(getType(Object.keys(O)[0]).constructor))}return C},__decorate([type([H],j)],Reflection.prototype,"types",void 0),__decorate([type("number",j)],Reflection.prototype,"rootType",void 0),Reflection}(k);registerType("map",{constructor:w,getProxy:getMapProxy}),registerType("array",{constructor:C,getProxy:getArrayProxy}),registerType("set",{constructor:N}),registerType("collection",{constructor:F}),l.ArraySchema=C,l.CollectionSchema=F,l.Context=A,l.MapSchema=w,l.Reflection=B,l.ReflectionField=V,l.ReflectionType=H,l.Schema=k,l.SchemaDefinition=x,l.SetSchema=N,l.decode=D,l.defineTypes=defineTypes,l.deprecated=deprecated,l.dumpChanges=dumpChanges,l.encode=I,l.filter=filter,l.filterChildren=filterChildren,l.hasFilter=hasFilter,l.registerType=registerType,l.type=type,Object.defineProperty(l,"__esModule",{value:!0})}(y)}(0,y.exports),y.exports}(),U=function(){function Room(l,y){var v=this;this.onStateChange=createSignal(),this.onError=createSignal(),this.onLeave=createSignal(),this.onJoin=createSignal(),this.hasJoined=!1,this.onMessageHandlers=createNanoEvents(),this.id=null,this.name=l,y&&(this.serializer=new(getSerializer("schema")),this.rootSchema=y,this.serializer.state=new y),this.onError((function(l,y){return console.warn("colyseus.js - onError => ("+l+") "+y)})),this.onLeave((function(){return v.removeAllListeners()}))}return Room.prototype.connect=function(l){var y=this;this.connection=new M,this.connection.events.onmessage=this.onMessageCallback.bind(this),this.connection.events.onclose=function(l){if(!y.hasJoined)return console.warn("Room connection was closed unexpectedly ("+l.code+"): "+l.reason),void y.onError.invoke(l.code,l.reason);y.onLeave.invoke(l.code),y.destroy()},this.connection.events.onerror=function(l){console.warn("Room, onError ("+l.code+"): "+l.reason),y.onError.invoke(l.code,l.reason)},this.connection.connect(l)},Room.prototype.leave=function(y){void 0===y&&(y=!0),this.connection?y?this.connection.send([l.Protocol.LEAVE_ROOM]):this.connection.close():this.onLeave.invoke(4e3)},Room.prototype.onMessage=function(l,y){return this.onMessageHandlers.on(this.getMessageHandlerKey(l),y)},Room.prototype.send=function(y,v){var m,g=[l.Protocol.ROOM_DATA];if("string"==typeof y?N.encode.string(g,y):N.encode.number(g,y),void 0!==v){var b=encode(v);(m=new Uint8Array(g.length+b.byteLength)).set(new Uint8Array(g),0),m.set(new Uint8Array(b),g.length)}else m=new Uint8Array(g);this.connection.send(m.buffer)},Object.defineProperty(Room.prototype,"state",{get:function(){return this.serializer.getState()},enumerable:!1,configurable:!0}),Room.prototype.removeAllListeners=function(){this.onJoin.clear(),this.onStateChange.clear(),this.onError.clear(),this.onLeave.clear(),this.onMessageHandlers.events={}},Room.prototype.onMessageCallback=function(y){var v=Array.from(new Uint8Array(y.data)),m=v[0];if(m===l.Protocol.JOIN_ROOM){var g=1;if(this.serializerId=function(l,y){for(var v=l[y++],m="",g=0,b=y,C=y+v;b<C;b++){var w=l[b];if(0!=(128&w))if(192!=(224&w))if(224!=(240&w)){if(240!=(248&w))throw new Error("Invalid byte "+w.toString(16));(g=(7&w)<<18|(63&l[++b])<<12|(63&l[++b])<<6|(63&l[++b])<<0)>=65536?(g-=65536,m+=String.fromCharCode(55296+(g>>>10),56320+(1023&g))):m+=String.fromCharCode(g)}else m+=String.fromCharCode((15&w)<<12|(63&l[++b])<<6|(63&l[++b])<<0);else m+=String.fromCharCode((31&w)<<6|63&l[++b]);else m+=String.fromCharCode(w)}return m}(v,g),g+=function(l){void 0===l&&(l="");for(var y=0,v=0,m=0,g=l.length;m<g;m++)(y=l.charCodeAt(m))<128?v+=1:y<2048?v+=2:y<55296||y>=57344?v+=3:(m++,v+=4);return v+1}(this.serializerId),!this.serializer){var b=getSerializer(this.serializerId);this.serializer=new b}v.length>g&&this.serializer.handshake&&this.serializer.handshake(v,{offset:g}),this.hasJoined=!0,this.onJoin.invoke(),this.connection.send([l.Protocol.JOIN_ROOM])}else if(m===l.Protocol.ERROR){var C={offset:1},w=N.decode.number(v,C),O=N.decode.string(v,C);this.onError.invoke(w,O)}else if(m===l.Protocol.LEAVE_ROOM)this.leave();else if(m===l.Protocol.ROOM_DATA_SCHEMA){var x={offset:1};(O=new(S=this.serializer.getState().constructor._context.get(N.decode.number(v,x)))).decode(v,x),this.dispatchMessage(S,O)}else if(m===l.Protocol.ROOM_STATE)v.shift(),this.setState(v);else if(m===l.Protocol.ROOM_STATE_PATCH)v.shift(),this.patch(v);else if(m===l.Protocol.ROOM_DATA){var A={offset:1},S=N.decode.stringCheck(v,A)?N.decode.string(v,A):N.decode.number(v,A);O=v.length>A.offset?function(l,y){void 0===y&&(y=0);var v=new Decoder(l,y),m=v._parse();if(v._offset!==l.byteLength)throw new Error(l.byteLength-v._offset+" trailing bytes");return m}(y.data,A.offset):void 0,this.dispatchMessage(S,O)}},Room.prototype.setState=function(l){this.serializer.setState(l),this.onStateChange.invoke(this.serializer.getState())},Room.prototype.patch=function(l){this.serializer.patch(l),this.onStateChange.invoke(this.serializer.getState())},Room.prototype.dispatchMessage=function(l,y){var v=this.getMessageHandlerKey(l);this.onMessageHandlers.events[v]?this.onMessageHandlers.emit(v,y):this.onMessageHandlers.events["*"]?this.onMessageHandlers.emit("*",l,y):console.warn("onMessage not registered for type '"+l+"'.")},Room.prototype.destroy=function(){this.serializer&&this.serializer.teardown()},Room.prototype.getMessageHandlerKey=function(l){switch(typeof l){case"function":return"$"+l._typeid;case"string":return l;case"number":return"i"+l;default:throw new Error("invalid message type.")}},Room}();function getStorage(){return F||(F="undefined"!=typeof cc&&cc.sys&&cc.sys.localStorage?cc.sys.localStorage:"undefined"!=typeof window&&window.localStorage?window.localStorage:{cache:{},setItem:function(l,y){this.cache[l]=y},getItem:function(l){this.cache[l]},removeItem:function(l){delete this.cache[l]}}),F}var $,L="colyseus-auth-token";l.Platform=void 0,($=l.Platform||(l.Platform={})).ios="ios",$.android="android";var k=function(){function Auth(l){var y,v,m=this;this._id=void 0,this.username=void 0,this.displayName=void 0,this.avatarUrl=void 0,this.isAnonymous=void 0,this.email=void 0,this.lang=void 0,this.location=void 0,this.timezone=void 0,this.metadata=void 0,this.devices=void 0,this.facebookId=void 0,this.twitterId=void 0,this.googleId=void 0,this.gameCenterId=void 0,this.steamId=void 0,this.friendIds=void 0,this.blockedUserIds=void 0,this.createdAt=void 0,this.updatedAt=void 0,this.token=void 0,this.endpoint=l.replace("ws","http"),y=function(l){return m.token=l},v=getStorage().getItem("colyseus-auth-token"),"undefined"!=typeof Promise&&v instanceof Promise?v.then((function(l){return y(l)})):y(v)}return Object.defineProperty(Auth.prototype,"hasToken",{get:function(){return!!this.token},enumerable:!1,configurable:!0}),Auth.prototype.login=function(l){return void 0===l&&(l={}),__awaiter(this,void 0,void 0,(function(){var y,v,m;return __generator(this,(function(g){switch(g.label){case 0:return y=Object.assign({},l),this.hasToken&&(y.token=this.token),[4,this.request("post","/auth",y)];case 1:for(m in v=g.sent(),this.token=v.token,L,b=this.token,getStorage().setItem("colyseus-auth-token",b),v)this.hasOwnProperty(m)&&(this[m]=v[m]);return this.registerPingService(),[2,this]}var b}))}))},Auth.prototype.save=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(l){switch(l.label){case 0:return[4,this.request("put","/auth",{},{username:this.username,displayName:this.displayName,avatarUrl:this.avatarUrl,lang:this.lang,location:this.location,timezone:this.timezone})];case 1:return l.sent(),[2,this]}}))}))},Auth.prototype.getFriends=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(l){switch(l.label){case 0:return[4,this.request("get","/friends/all")];case 1:return[2,l.sent()]}}))}))},Auth.prototype.getOnlineFriends=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(l){switch(l.label){case 0:return[4,this.request("get","/friends/online")];case 1:return[2,l.sent()]}}))}))},Auth.prototype.getFriendRequests=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(l){switch(l.label){case 0:return[4,this.request("get","/friends/requests")];case 1:return[2,l.sent()]}}))}))},Auth.prototype.sendFriendRequest=function(l){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:return[4,this.request("post","/friends/requests",{userId:l})];case 1:return[2,y.sent()]}}))}))},Auth.prototype.acceptFriendRequest=function(l){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:return[4,this.request("put","/friends/requests",{userId:l})];case 1:return[2,y.sent()]}}))}))},Auth.prototype.declineFriendRequest=function(l){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:return[4,this.request("del","/friends/requests",{userId:l})];case 1:return[2,y.sent()]}}))}))},Auth.prototype.blockUser=function(l){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:return[4,this.request("post","/friends/block",{userId:l})];case 1:return[2,y.sent()]}}))}))},Auth.prototype.unblockUser=function(l){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(y){switch(y.label){case 0:return[4,this.request("put","/friends/block",{userId:l})];case 1:return[2,y.sent()]}}))}))},Auth.prototype.request=function(l,y,v,m,g){return void 0===v&&(v={}),void 0===g&&(g={}),__awaiter(this,void 0,void 0,(function(){var b,C,w,O;return __generator(this,(function(x){switch(x.label){case 0:for(C in g.Accept="application/json",this.hasToken&&(g.Authorization="Bearer "+this.token),b=[],v)b.push(C+"="+v[C]);return w=b.length>0?"?"+b.join("&"):"",O={headers:g},m&&(O.body=m),[4,S[l](""+this.endpoint+y+w,O)];case 1:return[2,x.sent().data]}}))}))},Auth.prototype.logout=function(){this.token=void 0,getStorage().removeItem("colyseus-auth-token"),this.unregisterPingService()},Auth.prototype.registerPingService=function(l){var y=this;void 0===l&&(l=15e3),this.unregisterPingService(),this.keepOnlineInterval=setInterval((function(){return y.request("get","/auth")}),l)},Auth.prototype.unregisterPingService=function(){clearInterval(this.keepOnlineInterval)},Auth}(),j=function(l){function MatchMakeError(y,v){var m=l.call(this,y)||this;return m.code=v,Object.setPrototypeOf(m,MatchMakeError.prototype),m}return __extends(MatchMakeError,l),MatchMakeError}(Error),V="undefined"!=typeof window&&void 0!==window.location?window.location.protocol.replace("http","ws")+"//"+window.location.hostname+(window.location.port&&":"+window.location.port):"ws://127.0.0.1:2567",H=function(){function Client(l){void 0===l&&(l=V),this.endpoint=l}return Object.defineProperty(Client.prototype,"auth",{get:function(){return this._auth||(this._auth=new k(this.endpoint)),this._auth},enumerable:!1,configurable:!0}),Client.prototype.joinOrCreate=function(l,y,v){return void 0===y&&(y={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){switch(m.label){case 0:return[4,this.createMatchMakeRequest("joinOrCreate",l,y,v)];case 1:return[2,m.sent()]}}))}))},Client.prototype.create=function(l,y,v){return void 0===y&&(y={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){switch(m.label){case 0:return[4,this.createMatchMakeRequest("create",l,y,v)];case 1:return[2,m.sent()]}}))}))},Client.prototype.join=function(l,y,v){return void 0===y&&(y={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){switch(m.label){case 0:return[4,this.createMatchMakeRequest("join",l,y,v)];case 1:return[2,m.sent()]}}))}))},Client.prototype.joinById=function(l,y,v){return void 0===y&&(y={}),__awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){switch(m.label){case 0:return[4,this.createMatchMakeRequest("joinById",l,y,v)];case 1:return[2,m.sent()]}}))}))},Client.prototype.reconnect=function(l,y,v){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(m){switch(m.label){case 0:return[4,this.createMatchMakeRequest("joinById",l,{sessionId:y},v)];case 1:return[2,m.sent()]}}))}))},Client.prototype.getAvailableRooms=function(l){return void 0===l&&(l=""),__awaiter(this,void 0,void 0,(function(){var y;return __generator(this,(function(v){switch(v.label){case 0:return y=this.endpoint.replace("ws","http")+"/matchmake/"+l,[4,b(y,{headers:{Accept:"application/json"}})];case 1:return[2,v.sent().data]}}))}))},Client.prototype.consumeSeatReservation=function(l,y){return __awaiter(this,void 0,void 0,(function(){var v;return __generator(this,(function(m){return(v=this.createRoom(l.room.name,y)).id=l.room.roomId,v.sessionId=l.sessionId,v.connect(this.buildEndpoint(l.room,{sessionId:v.sessionId})),[2,new Promise((function(l,y){var onError=function(l,v){return y(new E(l,v))};v.onError.once(onError),v.onJoin.once((function(){v.onError.remove(onError),l(v)}))}))]}))}))},Client.prototype.createMatchMakeRequest=function(l,y,v,m){return void 0===v&&(v={}),__awaiter(this,void 0,void 0,(function(){var g,b;return __generator(this,(function(C){switch(C.label){case 0:return g=this.endpoint.replace("ws","http")+"/matchmake/"+l+"/"+y,this._auth&&this._auth.hasToken&&(v.token=this._auth.token),[4,w(g,{headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(v)})];case 1:if((b=C.sent().data).error)throw new j(b.error,b.code);return[2,this.consumeSeatReservation(b,m)]}}))}))},Client.prototype.createRoom=function(l,y){return new U(l,y)},Client.prototype.buildEndpoint=function(l,y){void 0===y&&(y={});var v=[];for(var m in y)y.hasOwnProperty(m)&&v.push(m+"="+y[m]);return this.endpoint+"/"+l.processId+"/"+l.roomId+"?"+v.join("&")},Client}(),B=function(){function SchemaSerializer(){}return SchemaSerializer.prototype.setState=function(l){this.state.decode(l)},SchemaSerializer.prototype.getState=function(){return this.state},SchemaSerializer.prototype.patch=function(l){this.state.decode(l)},SchemaSerializer.prototype.teardown=function(){var l,y;null===(y=null===(l=this.state)||void 0===l?void 0:l.$changes)||void 0===y||y.root.clearRefs()},SchemaSerializer.prototype.handshake=function(l,y){this.state?(new N.Reflection).decode(l,y):this.state=N.Reflection.decode(l,y)},SchemaSerializer}(),q=function(){function NoneSerializer(){}return NoneSerializer.prototype.setState=function(l){},NoneSerializer.prototype.getState=function(){return null},NoneSerializer.prototype.patch=function(l){},NoneSerializer.prototype.teardown=function(){},NoneSerializer.prototype.handshake=function(l){},NoneSerializer}();registerSerializer("schema",B),registerSerializer("none",q),l.Auth=k,l.Client=H,l.Room=U,l.SchemaSerializer=B,l.registerSerializer=registerSerializer,Object.defineProperty(l,"__esModule",{value:!0})}));var __read=this&&this.__read||function(l,y){var v="function"==typeof Symbol&&l[Symbol.iterator];if(!v)return l;var m,g,b=v.call(l),C=[];try{for(;(void 0===y||y-- >0)&&!(m=b.next()).done;)C.push(m.value)}catch(l){g={error:l}}finally{try{m&&!m.done&&(v=b.return)&&v.call(b)}finally{if(g)throw g.error}}return C},__awaiter=this&&this.__awaiter||function(l,y,v,m){return new(v||(v=Promise))((function(g,b){function fulfilled(l){try{step(m.next(l))}catch(l){b(l)}}function rejected(l){try{step(m.throw(l))}catch(l){b(l)}}function step(l){var y;l.done?g(l.value):(y=l.value,y instanceof v?y:new v((function(l){l(y)}))).then(fulfilled,rejected)}step((m=m.apply(l,y||[])).next())}))},__generator=this&&this.__generator||function(l,y){var v,m,g,b,C={label:0,sent:function(){if(1&g[0])throw g[1];return g[1]},trys:[],ops:[]};return b={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(b[Symbol.iterator]=function(){return this}),b;function verb(b){return function(w){return function(b){if(v)throw new TypeError("Generator is already executing.");for(;C;)try{if(v=1,m&&(g=2&b[0]?m.return:b[0]?m.throw||((g=m.return)&&g.call(m),0):m.next)&&!(g=g.call(m,b[1])).done)return g;switch(m=0,g&&(b=[2&b[0],g.value]),b[0]){case 0:case 1:g=b;break;case 4:return C.label++,{value:b[1],done:!1};case 5:C.label++,m=b[1],b=[0];continue;case 7:b=C.ops.pop(),C.trys.pop();continue;default:if(!((g=(g=C.trys).length>0&&g[g.length-1])||6!==b[0]&&2!==b[0])){C=0;continue}if(3===b[0]&&(!g||b[1]>g[0]&&b[1]<g[3])){C.label=b[1];break}if(6===b[0]&&C.label<g[1]){C.label=g[1],g=b;break}if(g&&C.label<g[2]){C.label=g[2],C.ops.push(b);break}g[2]&&C.ops.pop(),C.trys.pop();continue}b=y.call(l,C)}catch(l){b=[6,l],m=0}finally{v=g=0}if(5&b[0])throw b[1];return{value:b[0]?b[1]:void 0,done:!0}}([b,w])}}};define("metas/voxters-pet/src/voxter/voxter",["require","exports"],(function(l,y){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.createVoxter=void 0;var v=[0,2,9,13,10055,10056,10057],m=v.reduce((function(l,y){var v=new GLTFShape("metas/voxters-pet/models/"+y+".glb");return v.isPointerBlocker=!1,v.withCollisions=!1,l[y]=v,l}),{});function getAvailableOrDefault(l){return~v.indexOf(l)?l:0}y.createVoxter=function(l,y,v,g,b,C,w,O){var x={onClick:null},A={currentModel:getAvailableOrDefault(b)},S=new Entity,E=m[A.currentModel];S.addComponent(E),S.addComponent(new Transform({scale:new Vector3(.25,.25,.25),position:new Vector3(2,1,2)})),engine.addEntity(S);var T=new AudioClip("metas/voxters-pet/sounds/nyan_short.mp3"),R=new AudioSource(T);R.loop=!0,R.playing=!1;var I=!1;return{reproduce:function(){R.playing=!0,R.loop=!0},stop:function(){R.playing=!1},onClick:function(l){if(!I){I=!0;var y=new Entity,v=new BoxShape;v.withCollisions=!1,v.isPointerBlocker=!0,y.addComponent(v);var m=new Material;y.addComponent(m),y.addComponent(new Transform({position:new Vector3(1,1,0),scale:new Vector3(4.5,3,.5)})),m.albedoColor=new Color4(1,0,0,0),y.setParent(S),y.addComponent(new OnPointerDown((function(){x.onClick&&x.onClick()}),{hoverText:"switch"}))}x.onClick=l},applyDna:function(l){A.currentModel=getAvailableOrDefault(l),S.addComponentOrReplace(m[A.currentModel])},getEntity:function(){return S},setPosition:function(l){S.getComponent(Transform).position.copyFrom(l)},dispose:function(){S.setParent(null),engine.removeEntity(S)},lookAt:function(l){S.getComponent(Transform).lookAt(l)},update:function(l){}}}})),define("metas/voxters-pet/src/lib/decoder",["require","exports"],(function(l,y){"use strict";function decode(l,y){for(var v=[],m=0,g=1;m<y.length;)v.push(Math.floor(l/g)%y[m]),g*=y[m],m++;return v}function getDna(l){var v=l.eyeIndex,m=l.mouthIndex,g=l.eyeColorIndex,b=l.headIndex;return encode(y.propertySizes,[v,m,g,b])}function encode(l,y){for(var v=0,m=0,g=1;v<l.length;)m+=y[v]*g,g*=l[v],v++;return m}function getMetadataFromIndexes(l){var v=l.eyeIndex,m=l.mouthIndex,g=l.eyeColorIndex,b=l.headIndex,C=getDna({eyeIndex:v,mouthIndex:m,eyeColorIndex:g,headIndex:b}),w={name:"Voxter "+C,description:"Voxter creature of the metaverse",image:"https://mana-fever.com/voxters/v1/image/"+C+"_350.png",attributes:[{trait_type:"Eyes",display_type:"number",value:v},{trait_type:"Eyes author",value:getAuthor(v)},{trait_type:"Eyes color",value:["Red","Pink","Yellow","White","Green","Turquoise","Blue"][g]},{trait_type:"Mouth",value:m},{trait_type:"Mouth author",value:getAuthor(m)}]};return b&&(w.attributes=w.attributes.concat([{trait_type:"Head accessory",value:b},{trait_type:"Head accessory author",value:y.authors[b]}])),w;function getAuthor(l){return y.authors[Math.floor(l/8)]}}var v;Object.defineProperty(y,"__esModule",{value:!0}),y.getMetadataFromIndexes=y.getMetadataFromDna=y.getEncoder=y.encode=y.getDna=y.maximumNumber=y.decode=y.COLOR=y.authors=y.properties=y.propertySizes=void 0,y.propertySizes=[64,64,7,9],y.properties=["eye","mouth","eye_color","head"],y.authors=["mana-fever.com","dapp-craft.com"],(v=y.COLOR||(y.COLOR={}))[v.RED=0]="RED",v[v.PINK=1]="PINK",v[v.YELLOW=2]="YELLOW",v[v.WHITE=3]="WHITE",v[v.GREEN=4]="GREEN",v[v.TURQUOISE=5]="TURQUOISE",v[v.BLUE=6]="BLUE",y.decode=decode,y.maximumNumber=function(l){for(var y=0,v=1;y<l.length;)v*=l[y],y++;return v-1},y.getDna=getDna,y.encode=encode,y.getEncoder=function(l,y){return function(v){var m=decode(v,y);return l.reduce((function(l,y,v){return l[y]=m[v],l}),{})}},y.getMetadataFromDna=function(l){var v=__read(decode(l,y.propertySizes),4);return getMetadataFromIndexes({eyeIndex:v[0],mouthIndex:v[1],eyeColorIndex:v[2],headIndex:v[3]})},y.getMetadataFromIndexes=getMetadataFromIndexes})),define("metas/voxters-pet/src/voxters-pet",["require","exports","@decentraland/Identity","@decentraland/EnvironmentAPI","@decentraland/ParcelIdentity","metas/voxters-pet/src/voxter/voxter","colyseus.js"],(function(l,y,v,m,g,b,C){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.initializeVoxtersPet=void 0,y.initializeVoxtersPet=function(){return __awaiter(void 0,void 0,void 0,(function(){var l,y,O,x,A,S,E,T,R,I,P,M,z;return __generator(this,(function(D){switch(D.label){case 0:return[4,v.getUserData()];case 1:return l=D.sent(),[4,m.getCurrentRealm()];case 2:return y=null===(z=D.sent())||void 0===z?void 0:z.displayName,[4,g.getParcel()];case 3:return(O=D.sent()).cid,x=O.land,A=x.sceneJsonData,S=!~(y||"").indexOf("localhost"),E=S?"wss://mana-fever.com/nyan-pet/":"ws://localhost:2567",[4,new C.Client(""+E).joinOrCreate("nyan-lobby",{realm:y,user:l,land:A.scene.base})];case 4:return T=D.sent(),R={},T.onMessage("hasVoxter",(function(l){var y={x:1,y:1,z:1};setInterval((function(){var l,v;l=y,v=serializeAndFloorVector3(Camera.instance.position),(l.x!==v.x||l.z!==v.z||l.y!==v.y)&&(y=serializeAndFloorVector3(Camera.instance.position),T.send(1,y))}),300)})),T.state.supporters.onAdd=function(l,y){var v=l.toJSON(),m=v.playerPosition,g=v.tokenId,C=v.name,w=m.x,O=m.y,x=m.z;R[y]={playerPosition:new Vector3(w,O,x),voxter:b.createVoxter(C,w,O,x,g)},y===T.sessionId&&R[y].voxter.onClick((function(){T.send("switch",100)})),l.playerPosition.onChange=function(l){var v=l.reduce((function(l,y){return l[y.field]=y.value,l}),{});Object.assign(R[y].playerPosition,v)},l.onChange=function(l){var v=l.find((function(l){return"tokenId"===l.field}));v&&R[y].voxter.applyDna(v.value)}},T.state.supporters.onRemove=function(l,y){R[y].voxter.dispose(),delete R[y]},I=0,P={moving:!1,reproducing:!1},M=function(l){I+=l,Object.values(R).forEach((function(y){var v,m,g,b=y.playerPosition,C=b.x,w=b.y,O=b.z,x=new Vector3(C,w+.75,O),A=y.voxter.getEntity().getComponent(Transform),S=x.subtract(A.position).normalize().multiplyByFloats(9*l,9*l,9*l),E=new Vector3(0,.01*Math.cos(3*I),0),T=A.position.add(S).add(E);v=x,(m=T.x-v.x)*m-(g=v.z-v.z)*g>1?(P.moving=!0,y.voxter.setPosition(T)):(P.moving=!1,y.voxter.setPosition(A.position.add(E))),A.rotation=Quaternion.Slerp(A.rotation,Quaternion.LookRotation(x.subtract(A.position)),2*l),P.moving&&!P.reproducing?P.reproducing=!0:!P.moving&&P.reproducing&&(P.reproducing=!1)}))},engine.addSystem(new w(M)),[2]}}))}))};var w=function(){function UpdateSystem(l){this.callback=l,engine.addSystem(this)}return UpdateSystem.prototype.update=function(l){this.callback(l)},UpdateSystem.prototype.dispose=function(){this.callback=null,engine.removeSystem(this)},UpdateSystem}();function serializeAndFloorVector3(l){return{x:Math.floor(l.x),y:Math.floor(l.y),z:Math.floor(l.z)}}})),define("src/game",["require","exports","metas/voxters-pet/src/voxters-pet"],(function(l,y,v){"use strict";Object.defineProperty(y,"__esModule",{value:!0}),v.initializeVoxtersPet();var m=new Entity;engine.addEntity(m),function(){function UpdateSystem(l){this.callback=l,engine.addSystem(this)}UpdateSystem.prototype.update=function(l){this.callback(l)},UpdateSystem.prototype.dispose=function(){this.callback=null,engine.removeSystem(this)}}()}));